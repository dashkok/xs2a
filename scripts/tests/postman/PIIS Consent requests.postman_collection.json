{
	"info": {
		"_postman_id": "4ffcfa50-fe08-4eca-8159-7006d131cbde",
		"name": "PIIS Consent requests",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "v1",
			"item": [
				{
					"name": "Errorful requests",
					"item": [
						{
							"name": "wrong TPP in certificate",
							"item": [
								{
									"name": "1. Enable PIIS consent support in ASPSP profile",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "8b7ed760-426b-4793-a0f5-00dee8ac0a1f",
												"exec": [
													"pm.test(\"Status code is 200\", () => {",
													"    pm.response.to.have.status(200);",
													"});",
													""
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "PUT",
										"header": [
											{
												"key": "Content-Type",
												"name": "Content-Type",
												"value": "application/json",
												"type": "text"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"ais\": {\n        \"consentTypes\": {\n            \"bankOfferedConsentSupported\": false,\n            \"globalConsentSupported\": false,\n            \"availableAccountsConsentSupported\": true,\n            \"accountAccessFrequencyPerDay\": 4,\n            \"notConfirmedConsentExpirationTimeMs\": 86400000,\n            \"maxConsentValidityDays\": 0\n        },\n        \"redirectLinkToOnlineBanking\": {\n            \"aisRedirectUrlToAspsp\": \"http://localhost:4200/ais/{redirect-id}/{encrypted-consent-id}\"\n        },\n        \"transactionParameters\": {\n            \"availableBookingStatuses\": [\n                \"BOOKED\",\n                \"PENDING\"\n            ],\n            \"transactionsWithoutBalancesSupported\": false,\n            \"supportedTransactionApplicationTypes\": [\n            \t\"application/json\"\n            ]\n        },\n        \"deltaReportSettings\": {\n            \"entryReferenceFromSupported\": false,\n            \"deltaListSupported\": false\n        },\n        \"scaRequirementsForOneTimeConsents\": {\n            \"scaByOneTimeAvailableAccountsConsentRequired\": true,\n            \"scaByOneTimeGlobalConsentRequired\": true\n        }\n    },\n    \"pis\": {\n        \"supportedPaymentTypeAndProductMatrix\": {\n            \"payments\": [\n                \"sepa-credit-transfers\",\n                \"instant-sepa-credit-transfers\"\n            ]\n        },\n        \"maxTransactionValidityDays\": 0,\n        \"notConfirmedPaymentExpirationTimeMs\": 86400000,\n        \"paymentCancellationAuthorisationMandated\": false,\n        \"redirectLinkToOnlineBanking\": {\n            \"pisRedirectUrlToAspsp\": \"http://localhost:4200/pis/{redirect-id}/{encrypted-payment-id}\",\n            \"pisPaymentCancellationRedirectUrlToAspsp\": \"http://localhost:4200/pis/cancellation/{redirect-id}/{encrypted-payment-id}\",\n            \"paymentCancellationRedirectUrlExpirationTimeMs\": 600000\n        }\n    },\n    \"piis\": {\n        \"piisConsentSupported\": \"ASPSP_CONSENT_SUPPORTED\"\n    },\n    \"common\": {\n        \"scaRedirectFlow\": \"REDIRECT\",\n        \"startAuthorisationMode\": \"auto\",\n        \"tppSignatureRequired\": false,\n        \"psuInInitialRequestMandated\": false,\n        \"redirectUrlExpirationTimeMs\": 600000,\n        \"authorisationExpirationTimeMs\": 86400000,\n        \"forceXs2aBaseLinksUrl\": false,\n        \"xs2aBaseLinksUrl\": \"http://myhost.com/\",\n        \"supportedAccountReferenceFields\": [\n            \"IBAN\"\n        ],\n        \"multicurrencyAccountLevelSupported\": \"SUBACCOUNT\",\n        \"aisPisSessionsSupported\": false,\n        \"signingBasketSupported\": false,\n        \"aspspNotificationsSupported\": [\n        \t\"NONE\"\t\n        ]\n    }\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{protocol}}://{{url_aspsp_profile}}/api/v1/aspsp-profile/for-debug/aspsp-settings",
											"protocol": "{{protocol}}",
											"host": [
												"{{url_aspsp_profile}}"
											],
											"path": [
												"api",
												"v1",
												"aspsp-profile",
												"for-debug",
												"aspsp-settings"
											]
										}
									},
									"response": []
								},
								{
									"name": "2. Create PIIS consent request",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "8b509299-a38f-4897-b5d0-bf164d6e44d7",
												"exec": [
													"const jsonData = pm.response.json();",
													"",
													"pm.test(\"Status code is 201\", function () {",
													"    pm.response.to.have.status(201);",
													"});",
													"",
													"pm.test(\"consentId is exist\", () => {",
													"    ",
													"    pm.expect(jsonData).to.have.property('consentId');",
													"    ",
													"});"
												],
												"type": "text/javascript"
											}
										},
										{
											"listen": "prerequest",
											"script": {
												"id": "7a4328df-6245-4fd1-8a35-312cfaf549ff",
												"exec": [
													"pm.globals.unset(\"payment_id\");"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "Accept",
												"type": "text",
												"value": "application/json"
											},
											{
												"key": "Content-Type",
												"type": "text",
												"value": "application/json"
											},
											{
												"key": "PSU-ID",
												"type": "text",
												"value": "{{psu_id_multiple}}"
											},
											{
												"key": "PSU-IP-Address",
												"type": "text",
												"value": "{{ip_address}}"
											},
											{
												"key": "X-Request-ID",
												"type": "text",
												"value": "{{x_request_id}}"
											},
											{
												"key": "TPP-Explicit-Authorisation-Preferred",
												"type": "text",
												"value": "true"
											},
											{
												"key": "TPP-Redirect-URI",
												"type": "text",
												"value": "TPP-Redirect-URI"
											},
											{
												"key": "TPP-Nok-Redirect-URI",
												"type": "text",
												"value": "TPP-Nok-Redirect-URI"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"account\": {\n    \"aspspAccountId\": \"125-DEDE89370400440532013000-EUR\",\n    \"currency\": \"EUR\",\n    \"iban\": \"{{iban_multiple}}\"\n  },\n  \"cardExpiryDate\": \"2020-12-31\",\n  \"cardInformation\": \"MyMerchant Loyalty Card\",\n  \"cardNumber\": 1234567891234,\n  \"registrationInformation\": \"Your contract Number 1234 with MyMerchant is completed with the registration with your bank.\",\n  \"tppAuthorisationNumber\": \"PSDDE-FAKENCA-87B2AC\",\n  \"validUntil\": \"2020-10-10\"\n}"
										},
										"url": {
											"raw": "{{protocol}}://{{url_cms}}/aspsp-api/v1/piis/consents/",
											"protocol": "{{protocol}}",
											"host": [
												"{{url_cms}}"
											],
											"path": [
												"aspsp-api",
												"v1",
												"piis",
												"consents",
												""
											]
										},
										"description": "This method is used to initiate a payment at the ASPSP.  ## Variants of Payment Initiation Requests  This method to initiate a payment initiation at the ASPSP can be sent with either a JSON body or an pain.001 body depending on the payment product in the path.  There are the following **payment products**:    - Payment products with payment information in *JSON* format:     - ***sepa-credit-transfers***     - ***instant-sepa-credit-transfers***     - ***target-2-payments***     - ***cross-border-credit-transfers***   - Payment products with payment information in *pain.001* XML format:     - ***pain.001-sepa-credit-transfers***     - ***pain.001-instant-sepa-credit-transfers***     - ***pain.001-target-2-payments***     - ***pain.001-cross-border-credit-transfers***  Furthermore the request body depends on the **payment-service**   * ***payments***: A single payment initiation request.   * ***bulk-payments***: A collection of several payment iniatiation requests.        In case of a *pain.001* message there are more than one payments contained in the *pain.001 message.          In case of a *JSON* there are several JSON payment blocks contained in a joining list.   * ***periodic-payments***:      Create a standing order initiation resource for recurrent i.e. periodic payments addressable under {paymentId}       with all data relevant for the corresponding payment product and the execution of the standing order contained in a JSON body.   This is the first step in the API to initiate the related recurring/periodic payment.    ## Single and mulitilevel SCA Processes  The Payment Initiation Requests are independent from the need of one ore multilevel  SCA processing, i.e. independent from the number of authorisations needed for the execution of payments.   But the response messages are specific to either one SCA processing or multilevel SCA processing.   For payment initiation with multilevel SCA, this specification requires an explicit start of the authorisation,  i.e. links directly associated with SCA processing like 'scaRedirect' or 'scaOAuth' cannot be contained in the  response message of a Payment Initation Request for a payment, where multiple authorisations are needed.  Also if any data is needed for the next action, like selecting an SCA method is not supported in the response,  since all starts of the multiple authorisations are fully equal.  In these cases, first an authorisation sub-resource has to be generated following the 'startAuthorisation' link. "
									},
									"response": []
								},
								{
									"name": "3. Fund confirmation request WRONG certificate",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "1d10b8bc-6942-4c66-94e7-ccb895011ecc",
												"exec": [
													"pm.test('Status code is 400', () => {",
													"   pm.response.to.have.status(400);",
													"});",
													"",
													"const jsonData = pm.response.json();",
													"",
													"pm.test('TppMessages and error are exist', () => {",
													"    ",
													"    pm.expect(jsonData).to.have.property('tppMessages');",
													"    ",
													"    var error = jsonData.tppMessages[0];",
													"       ",
													"    pm.expect(error).to.have.property('category');",
													"    pm.expect(error).to.have.property('code');",
													"    pm.expect(error).to.have.property('text');",
													"       ",
													"    pm.expect(error.category).to.eql('ERROR');",
													"    pm.expect(error.code).to.eql('CONSENT_UNKNOWN');",
													"    pm.expect(error.text).to.eql('The Consent-ID cannot be matched by the ASPSP relative to the TPP');",
													"    ",
													"});",
													"",
													""
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "Accept",
												"value": "application/json",
												"type": "text"
											},
											{
												"key": "Content-Type",
												"value": "application/json",
												"type": "text"
											},
											{
												"key": "X-Request-ID",
												"value": "{{x_request_id}}",
												"type": "text"
											},
											{
												"key": "tpp-qwac-certificate",
												"value": "{{wrong-certificate}}",
												"type": "text"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"account\": {\n\t\t\"currency\": \"EUR\",\n\t    \"iban\": \"{{iban_multiple}}\"\n},\n  \"cardNumber\": \"12345\",\n  \"instructedAmount\": {\n    \"amount\": \"160.00\",\n    \"currency\": \"EUR\"\n  },\n  \"payee\": \"Check24\"\n}"
										},
										"url": {
											"raw": "{{protocol}}://{{url_xs2a}}/v1/funds-confirmations",
											"protocol": "{{protocol}}",
											"host": [
												"{{url_xs2a}}"
											],
											"path": [
												"v1",
												"funds-confirmations"
											]
										}
									},
									"response": []
								}
							],
							"protocolProfileBehavior": {},
							"_postman_isSubFolder": true
						}
					],
					"protocolProfileBehavior": {},
					"_postman_isSubFolder": true
				},
				{
					"name": "Several TPPs for one PSU account",
					"item": [
						{
							"name": "Preparations",
							"item": [
								{
									"name": "1. Enable PIIS consent support in ASPSP profile",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "80513890-dd12-420a-96ee-a1879aece9b0",
												"exec": [
													"pm.test(\"Status code is 200\", () => {",
													"    pm.response.to.have.status(200);",
													"});",
													""
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "PUT",
										"header": [
											{
												"key": "Content-Type",
												"name": "Content-Type",
												"value": "application/json",
												"type": "text"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"ais\": {\n        \"consentTypes\": {\n            \"bankOfferedConsentSupported\": false,\n            \"globalConsentSupported\": false,\n            \"availableAccountsConsentSupported\": true,\n            \"accountAccessFrequencyPerDay\": 4,\n            \"notConfirmedConsentExpirationTimeMs\": 86400000,\n            \"maxConsentValidityDays\": 0\n        },\n        \"redirectLinkToOnlineBanking\": {\n            \"aisRedirectUrlToAspsp\": \"http://localhost:4200/ais/{redirect-id}/{encrypted-consent-id}\"\n        },\n        \"transactionParameters\": {\n            \"availableBookingStatuses\": [\n                \"BOOKED\",\n                \"PENDING\"\n            ],\n            \"transactionsWithoutBalancesSupported\": false,\n            \"supportedTransactionApplicationTypes\": [\n            \t\"application/json\"\n            ]\n        },\n        \"deltaReportSettings\": {\n            \"entryReferenceFromSupported\": false,\n            \"deltaListSupported\": false\n        },\n        \"scaRequirementsForOneTimeConsents\": {\n            \"scaByOneTimeAvailableAccountsConsentRequired\": true,\n            \"scaByOneTimeGlobalConsentRequired\": true\n        }\n    },\n    \"pis\": {\n        \"supportedPaymentTypeAndProductMatrix\": {\n            \"payments\": [\n                \"sepa-credit-transfers\",\n                \"instant-sepa-credit-transfers\"\n            ]\n        },\n        \"maxTransactionValidityDays\": 0,\n        \"notConfirmedPaymentExpirationTimeMs\": 86400000,\n        \"paymentCancellationAuthorisationMandated\": false,\n        \"redirectLinkToOnlineBanking\": {\n            \"pisRedirectUrlToAspsp\": \"http://localhost:4200/pis/{redirect-id}/{encrypted-payment-id}\",\n            \"pisPaymentCancellationRedirectUrlToAspsp\": \"http://localhost:4200/pis/cancellation/{redirect-id}/{encrypted-payment-id}\",\n            \"paymentCancellationRedirectUrlExpirationTimeMs\": 600000\n        }\n    },\n    \"piis\": {\n        \"piisConsentSupported\": \"ASPSP_CONSENT_SUPPORTED\"\n    },\n    \"common\": {\n        \"scaRedirectFlow\": \"REDIRECT\",\n        \"startAuthorisationMode\": \"auto\",\n        \"tppSignatureRequired\": false,\n        \"psuInInitialRequestMandated\": false,\n        \"redirectUrlExpirationTimeMs\": 600000,\n        \"authorisationExpirationTimeMs\": 86400000,\n        \"forceXs2aBaseLinksUrl\": false,\n        \"xs2aBaseLinksUrl\": \"http://myhost.com/\",\n        \"supportedAccountReferenceFields\": [\n            \"IBAN\"\n        ],\n        \"multicurrencyAccountLevelSupported\": \"SUBACCOUNT\",\n        \"aisPisSessionsSupported\": false,\n        \"signingBasketSupported\": false,\n        \"aspspNotificationsSupported\": [\n        \t\"NONE\"\t\n        ]\n    }\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{protocol}}://{{url_aspsp_profile}}/api/v1/aspsp-profile/for-debug/aspsp-settings",
											"protocol": "{{protocol}}",
											"host": [
												"{{url_aspsp_profile}}"
											],
											"path": [
												"api",
												"v1",
												"aspsp-profile",
												"for-debug",
												"aspsp-settings"
											]
										}
									},
									"response": []
								},
								{
									"name": "2. Authorise in ledgers",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "8a467c70-3b03-41ab-94d9-038901bd30c5",
												"exec": [
													"pm.test(\"Status code is 200\", () => {",
													"    pm.response.to.have.status(200);",
													"});",
													"",
													"const jsonData = pm.response.json();",
													"",
													"pm.test(\"Bearer token exists\", () => {",
													"   pm.expect(jsonData).to.have.property('bearerToken');",
													"});",
													"",
													"var tokenWithoutQuotes = JSON.stringify(jsonData.bearerToken.access_token).replace(/\"/g,\"\")",
													"",
													"pm.globals.set(\"ledgersBearerToken\", tokenWithoutQuotes);"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "psu-id",
												"type": "text",
												"value": "{{psu_id_none}}",
												"disabled": true
											},
											{
												"key": "Content-Type",
												"name": "Content-Type",
												"type": "text",
												"value": "application/json"
											}
										],
										"url": {
											"raw": "{{protocol}}://{{url_ledgers}}/users/login?login={{psu_id_none}}&pin={{psu_id_password}}&role=CUSTOMER",
											"protocol": "{{protocol}}",
											"host": [
												"{{url_ledgers}}"
											],
											"path": [
												"users",
												"login"
											],
											"query": [
												{
													"key": "login",
													"value": "{{psu_id_none}}"
												},
												{
													"key": "pin",
													"value": "{{psu_id_password}}"
												},
												{
													"key": "role",
													"value": "CUSTOMER"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "3. Execute /me request",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "d060c306-f353-4b85-8f49-ac9fce988daa",
												"exec": [
													"pm.test(\"Status code is 200\", () => {",
													"    pm.response.to.have.status(200);",
													"});",
													"",
													"const jsonData = pm.response.json();",
													"",
													"pm.test(\"User ID exists\", () => {",
													"   pm.expect(jsonData).to.have.property('id');",
													"});",
													"",
													"pm.globals.set(\"userId\", jsonData.id);"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"auth": {
											"type": "bearer",
											"bearer": [
												{
													"key": "token",
													"value": "{{ledgersBearerToken}}",
													"type": "string"
												}
											]
										},
										"method": "GET",
										"header": [],
										"url": {
											"raw": "{{protocol}}://{{url_ledgers}}/users/me",
											"protocol": "{{protocol}}",
											"host": [
												"{{url_ledgers}}"
											],
											"path": [
												"users",
												"me"
											]
										}
									},
									"response": []
								}
							],
							"protocolProfileBehavior": {},
							"_postman_isSubFolder": true
						},
						{
							"name": "TPP_1",
							"item": [
								{
									"name": "4. Create PIIS consent in CMS-ASPSP-API",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "53a2c02a-1a40-42b6-8c7f-fc999b871b31",
												"exec": [
													"pm.test(\"Status code is 201\", () => {",
													"    pm.response.to.have.status(201);",
													"});",
													"",
													"const jsonData = pm.response.json();",
													"",
													"pm.test(\"PIIS consent ID exists\", () => {",
													"   pm.expect(jsonData).to.have.property('consentId');",
													"});",
													"",
													"pm.globals.set(\"piis_consent_id\", jsonData.consentId);",
													""
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "psu-id",
												"value": "{{psu_id_none}}",
												"type": "text"
											},
											{
												"key": "Content-Type",
												"name": "Content-Type",
												"value": "application/json",
												"type": "text"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"account\": {\n    \"iban\": \"{{iban_none}}\",\n    \"currency\": \"EUR\"\n  },\n  \"tppAuthorisationNumber\": \"PSDDE-FAKENCA-87B2AC\",\n  \"validUntil\": \"2020-10-10\"\n}"
										},
										"url": {
											"raw": "{{protocol}}://{{url_cms}}/aspsp-api/v1/piis/consents/",
											"protocol": "{{protocol}}",
											"host": [
												"{{url_cms}}"
											],
											"path": [
												"aspsp-api",
												"v1",
												"piis",
												"consents",
												""
											]
										}
									},
									"response": []
								},
								{
									"name": "5. Create PIIS consent in ledgers",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "6fa0ad60-a06f-406b-8390-7034dbbdd904",
												"exec": [
													"pm.test(\"Status code is 200\", () => {",
													"    pm.response.to.have.status(200);",
													"});",
													"",
													"const jsonData = pm.response.json();",
													"",
													"pm.test(\"SCA status exists\", () => {",
													"   pm.expect(jsonData).to.have.property('scaStatus');",
													"});",
													"",
													"pm.globals.set(\"ledgersResponse\", JSON.stringify(jsonData));"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"auth": {
											"type": "bearer",
											"bearer": [
												{
													"key": "token",
													"value": "{{ledgersBearerToken}}",
													"type": "string"
												}
											]
										},
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"name": "Content-Type",
												"type": "text",
												"value": "application/json"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"access\": {\n    \"accounts\": [\n         \"{{iban_none}}\"\n    ]\n  },\n  \"frequencyPerDay\": 4,\n  \"tppId\": \"PSDDE-FAKENCA-87B2AC\",\n  \"userId\": \"{{userId}}\",\n  \"validUntil\": \"2020-10-10\"\n}"
										},
										"url": {
											"raw": "{{protocol}}://{{url_ledgers}}/consents/piis",
											"protocol": "{{protocol}}",
											"host": [
												"{{url_ledgers}}"
											],
											"path": [
												"consents",
												"piis"
											]
										}
									},
									"response": []
								},
								{
									"name": "6. Update ASPSP consent data for the given PIIS consent in CMS-PSU-API",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "323916c1-9263-4e90-b304-9175d9cc3938",
												"exec": [
													"pm.test(\"Status code is 200\", () => {",
													"    pm.response.to.have.status(200);",
													"});",
													""
												],
												"type": "text/javascript"
											}
										},
										{
											"listen": "prerequest",
											"script": {
												"id": "39d8febe-1e3f-439b-aedc-24a8fececa16",
												"exec": [
													"var ledgersResponse = pm.globals.get(\"ledgersResponse\");",
													"var utf8string = CryptoJS.enc.Utf8.parse(ledgersResponse);",
													"",
													"pm.globals.set(\"encodedLedgersResponse\", CryptoJS.enc.Base64.stringify(utf8string));"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "PUT",
										"header": [
											{
												"key": "Content-Type",
												"name": "Content-Type",
												"value": "application/json",
												"type": "text"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"aspspConsentDataBase64\": \"{{encodedLedgersResponse}}\",\n  \"consentId\": \"{{piis_consent_id}}\"\n}"
										},
										"url": {
											"raw": "{{protocol}}://{{url_cms}}/psu-api/v1/aspsp-consent-data/consents/{{piis_consent_id}}",
											"protocol": "{{protocol}}",
											"host": [
												"{{url_cms}}"
											],
											"path": [
												"psu-api",
												"v1",
												"aspsp-consent-data",
												"consents",
												"{{piis_consent_id}}"
											]
										}
									},
									"response": []
								},
								{
									"name": "7. Fund confirmation request in xs2a",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "ce090a7b-74ad-4d4a-96a9-98d02684b42f",
												"exec": [
													"pm.test(\"Status code is 200\", function () {",
													"    pm.response.to.have.status(200);",
													"});",
													"",
													"const jsonData = pm.response.json();",
													"",
													"pm.test(\"fundsAvailable is present\", () => {",
													"    pm.expect(jsonData).to.have.property('fundsAvailable');",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "Accept",
												"value": "application/json"
											},
											{
												"key": "Content-Type",
												"value": "application/json"
											},
											{
												"key": "X-Request-ID",
												"value": "{{x_request_id}}"
											},
											{
												"key": "TPP-qwac-Certificate",
												"value": "-----BEGIN CERTIFICATE-----MIIFJzCCAw+gAwIBAgIETxsR7TANBgkqhkiG9w0BAQsFADB4MQswCQYDVQQGEwJERTEQMA4GA1UECAwHQkFWQVJJQTESMBAGA1UEBwwJTnVyZW1iZXJnMSIwIAYDVQQKDBlUcnVzdCBTZXJ2aWNlIFByb3ZpZGVyIEFHMR8wHQYDVQQLDBZJbmZvcm1hdGlvbiBUZWNobm9sb2d5MB4XDTIwMDExMTEwNDM1M1oXDTIxMDExMDAwMDAwMFowgdgxITAfBgNVBAoMGEZpY3Rpb25hbCBDb3Jwb3JhdGlvbiBBRzEVMBMGA1UEAwwMWFMyQSBTYW5kYm94MSUwIwYKCZImiZPyLGQBGRYVcHVibGljLmNvcnBvcmF0aW9uLmRlMR8wHQYDVQQLDBZJbmZvcm1hdGlvbiBUZWNobm9sb2d5MRAwDgYDVQQGEwdHZXJtYW55MQ8wDQYDVQQIDAZCYXllcm4xEjAQBgNVBAcMCU51cmVtYmVyZzEdMBsGA1UEYQwUUFNEREUtRkFLRU5DQS04N0IyQUMwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCRhx6LCOvlHYtld1Bifsqdku4d2SASNqj9ZptbgL6Lf+1WhDxgeUGbHyjN/AdsGkjzY0TUiYV77g/EgcIXuHPKKogN6Ad9Cz4MzIVsQCiZmdk04M78j5l+y7gtqrmV+4h+sGdKFLMEv/yCNb1ahci26CktnzyKQnjhkb7ijIEAWMI83sX1Yo8F5oRPj0XFMr2k4xa8tkqYzt7P3ChxS3kR57lvptAeNNxMpHWhRp0DSxKWhAbxHt7R0FG6Qs8pEuEcyxh/FBK9YPQtEgYbGD91UoB8k1UejKhWJs6+ZNz47gUPylGx2Bh0EczpMwty207KM9YBl1RvZu5ElZzX4V+rAgMBAAGjWDBWMFQGCCsGAQUFBwEDBEgwRgYGBACBmCcCMDwwEzARBgcEAIGYJwECDAZQU1BfUEkMGVRydXN0IFNlcnZpY2UgUHJvdmlkZXIgQUcMCkRFLUZBS0VOQ0EwDQYJKoZIhvcNAQELBQADggIBAIRLwIiRSOc7F4FBn07YVmFwTw/HnFWMkdoDieMHyyioKdJGaOHIRzodw1WMjDl6V6A4G/V3U+nsGG2ra0fFXujoc1YMGEI0Mzrt0VSYwWPS18svBhp31UmegeQIRukXugGKOeWgBnh3DYvNuCbJfKDAUFL3nej75JRZWAzAklb/RaK50iedOrkUEts2K6qaQvygEMW6ytn+RmeqTXwin1g7L2qhBpdCGv/S/PufOW9BZfW4KmmiA9SjQhLQclZWY8DqUoOZUwFEaTgjhd4KZxg7ZvnyPE7Jh0GJMGFsibMEovkltr3ZZyffCDHe9h81Ar611dXKuzgZDu8ejs3v/PIvBzL5GjAvF5N5mSy8YBB91DvGJeJsh9rXi9cwj9qpTA4Ufn6hJiv3a2AAw9xtsa7z/btuEuGPr6G+r385ckcqbOKFqEXwnEVNt65EWhqBPFqm4oU5qVfMLZJ5AJVDkbRGu7lq7HZ/N4MN3a6HQxBk1Mpa6Ap7Tz/7MWbNE+0cXlGOUVZ7+KjasbnqQGRmCvkJK4Bt+fnXBSeKQPDcfI9VLZ1frOM0GcR6NqD/zbrmm1n9JWUxIvOHtylEgNEp4C8lP3YA3YUjRX9WCT41IczMcNbmaj/i0jiiaSFRTXMtKB0iPbD60SJeHI1zeFMTA4EDItb0S70eR23Op5/smJPy-----END CERTIFICATE-----",
												"type": "text"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"account\": {\n    \"iban\": \"{{iban_none}}\",\n    \"currency\": \"EUR\"\n  },\n  \"instructedAmount\": {\n    \"amount\": \"100.00\",\n    \"currency\": \"EUR\"\n  },\n  \"payee\": \"Check24\"\n}"
										},
										"url": {
											"raw": "{{protocol}}://{{url_xs2a}}/v1/funds-confirmations",
											"protocol": "{{protocol}}",
											"host": [
												"{{url_xs2a}}"
											],
											"path": [
												"v1",
												"funds-confirmations"
											]
										}
									},
									"response": []
								}
							],
							"protocolProfileBehavior": {},
							"_postman_isSubFolder": true
						},
						{
							"name": "TPP_2",
							"item": [
								{
									"name": "8. Create PIIS consent in CMS-ASPSP-API",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "26ae7a7c-296f-42be-83bf-607da6f923e6",
												"exec": [
													"pm.test(\"Status code is 201\", () => {",
													"    pm.response.to.have.status(201);",
													"});",
													"",
													"const jsonData = pm.response.json();",
													"",
													"pm.test(\"PIIS consent ID exists\", () => {",
													"   pm.expect(jsonData).to.have.property('consentId');",
													"});",
													"",
													"pm.globals.set(\"piis_consent_id\", jsonData.consentId);",
													""
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "psu-id",
												"type": "text",
												"value": "{{psu_id_none}}"
											},
											{
												"key": "Content-Type",
												"name": "Content-Type",
												"type": "text",
												"value": "application/json"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"account\": {\n    \"iban\": \"{{iban_none}}\",\n    \"currency\": \"EUR\"\n  },\n  \"tppAuthorisationNumber\": \"PSDDE-FAKENCA-87B2AD\",\n  \"validUntil\": \"2020-10-10\"\n}"
										},
										"url": {
											"raw": "{{protocol}}://{{url_cms}}/aspsp-api/v1/piis/consents/",
											"protocol": "{{protocol}}",
											"host": [
												"{{url_cms}}"
											],
											"path": [
												"aspsp-api",
												"v1",
												"piis",
												"consents",
												""
											]
										}
									},
									"response": []
								},
								{
									"name": "9. Create PIIS consent in ledgers",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "d3ca03d2-cb3e-4c90-838b-0be79543982e",
												"exec": [
													"pm.test(\"Status code is 200\", () => {",
													"    pm.response.to.have.status(200);",
													"});",
													"",
													"const jsonData = pm.response.json();",
													"",
													"pm.test(\"SCA status exists\", () => {",
													"   pm.expect(jsonData).to.have.property('scaStatus');",
													"});",
													"",
													"pm.globals.set(\"ledgersResponse\", JSON.stringify(jsonData));"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"auth": {
											"type": "bearer",
											"bearer": [
												{
													"key": "token",
													"value": "{{ledgersBearerToken}}",
													"type": "string"
												}
											]
										},
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"name": "Content-Type",
												"type": "text",
												"value": "application/json"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"access\": {\n    \"accounts\": [\n         \"{{iban_none}}\"\n    ]\n  },\n  \"frequencyPerDay\": 4,\n  \"tppId\": \"PSDDE-FAKENCA-87B2AD\",\n  \"userId\": \"{{userId}}\",\n  \"validUntil\": \"2020-10-10\"\n}"
										},
										"url": {
											"raw": "{{protocol}}://{{url_ledgers}}/consents/piis",
											"protocol": "{{protocol}}",
											"host": [
												"{{url_ledgers}}"
											],
											"path": [
												"consents",
												"piis"
											]
										}
									},
									"response": []
								},
								{
									"name": "10. Update ASPSP consent data for the given PIIS consent in CMS-PSU-API",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "9b8cf312-334b-4cbf-8faa-87b7bcd0fbf4",
												"exec": [
													"pm.test(\"Status code is 200\", () => {",
													"    pm.response.to.have.status(200);",
													"});",
													""
												],
												"type": "text/javascript"
											}
										},
										{
											"listen": "prerequest",
											"script": {
												"id": "f7e50d5e-cea7-4415-a69f-d9a6ff0a6e85",
												"exec": [
													"var ledgersResponse = pm.globals.get(\"ledgersResponse\");",
													"var utf8string = CryptoJS.enc.Utf8.parse(ledgersResponse);",
													"",
													"pm.globals.set(\"encodedLedgersResponse\", CryptoJS.enc.Base64.stringify(utf8string));"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "PUT",
										"header": [
											{
												"key": "Content-Type",
												"name": "Content-Type",
												"value": "application/json",
												"type": "text"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"aspspConsentDataBase64\": \"{{encodedLedgersResponse}}\",\n  \"consentId\": \"{{piis_consent_id}}\"\n}"
										},
										"url": {
											"raw": "{{protocol}}://{{url_cms}}/psu-api/v1/aspsp-consent-data/consents/{{piis_consent_id}}",
											"protocol": "{{protocol}}",
											"host": [
												"{{url_cms}}"
											],
											"path": [
												"psu-api",
												"v1",
												"aspsp-consent-data",
												"consents",
												"{{piis_consent_id}}"
											]
										}
									},
									"response": []
								},
								{
									"name": "11. Fund confirmation request in xs2a",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "62d4ae3c-1666-4426-84a2-3ad243193912",
												"exec": [
													"pm.test(\"Status code is 200\", function () {",
													"    pm.response.to.have.status(200);",
													"});",
													"",
													"const jsonData = pm.response.json();",
													"",
													"pm.test(\"fundsAvailable is present\", () => {",
													"    pm.expect(jsonData).to.have.property('fundsAvailable');",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "Accept",
												"value": "application/json"
											},
											{
												"key": "Content-Type",
												"value": "application/json"
											},
											{
												"key": "X-Request-ID",
												"value": "{{x_request_id}}"
											},
											{
												"key": "TPP-QWAC-CERTIFICATE",
												"value": "-----BEGIN CERTIFICATE-----MIIFJzCCAw+gAwIBAgIEMiq6iTANBgkqhkiG9w0BAQsFADB4MQswCQYDVQQGEwJERTEQMA4GA1UECAwHQkFWQVJJQTESMBAGA1UEBwwJTnVyZW1iZXJnMSIwIAYDVQQKDBlUcnVzdCBTZXJ2aWNlIFByb3ZpZGVyIEFHMR8wHQYDVQQLDBZJbmZvcm1hdGlvbiBUZWNobm9sb2d5MB4XDTIwMDExMTEwNDQzN1oXDTIxMDExMDAwMDAwMFowgdgxITAfBgNVBAoMGEZpY3Rpb25hbCBDb3Jwb3JhdGlvbiBBRzEVMBMGA1UEAwwMWFMyQSBTYW5kYm94MSUwIwYKCZImiZPyLGQBGRYVcHVibGljLmNvcnBvcmF0aW9uLmRlMR8wHQYDVQQLDBZJbmZvcm1hdGlvbiBUZWNobm9sb2d5MRAwDgYDVQQGEwdHZXJtYW55MQ8wDQYDVQQIDAZCYXllcm4xEjAQBgNVBAcMCU51cmVtYmVyZzEdMBsGA1UEYQwUUFNEREUtRkFLRU5DQS04N0IyQUQwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCyvyHjlApfVSmSTPeCij9WwVWXPV/lvK7KqWB325zLokQWtcGEt+BKeN00G2i5b4jWyhJgMn40FqnfWGUkSl70q5cgjztm9uoNZ514rEzbM0hI6LyL3KiLJ0gOa1zhvTuh9DrcgSfaJ1/Damdl1CoHHuoqwC5OuIDU/ygR6SIfMabMbXMy7N8piBo3SH4UGEIvadmMH7FghMtbNbVqiVe3hzOj2v2P3emKRJcOhQhiXUGdMxWjBvdmlegBxuhymRRVW2SxjerGoLbwLC6WhKIYaEXeUTqdyazPTVbkdQryEiVdEdXak//rJC6NAgBnBw9N6bF+PtrZnOSuZ1bp19XjAgMBAAGjWDBWMFQGCCsGAQUFBwEDBEgwRgYGBACBmCcCMDwwEzARBgcEAIGYJwECDAZQU1BfUEkMGVRydXN0IFNlcnZpY2UgUHJvdmlkZXIgQUcMCkRFLUZBS0VOQ0EwDQYJKoZIhvcNAQELBQADggIBABXq8wHPveWnieMFjchftwizQmSoRA5ph+sV9alLVgP5LjkF9hpTWzDdZyW+n3fOmK187ngYgokel6YsxPrq+tO/1TANv9nzzLfcfIepcFgoivdYoIKuK6gpexaLoSUJMffp6Xwksb8SmvZxsgzUUl9LqJ/HxTWvPRQ6RchRRQhUbj7CDB1Jay6hnv5AY4ns8bdkYsv7BLpNlLeUDJyMp5l0SnT5QiyrCcac2vtcFI70nGyd8RRskWt+nm7jB39e0jo5tCrpmtDmfV+KWyhS8peYoPRlNZEY9NfD8ko7aemCwl0SuGVtWBKVGXDJ1/GaavzZZc1dzAQWILb+8wVvM7L5cFGgqgHpSHdja9TsNAIGnLlMU736rbvFbYzPsCHdyrXPMPBPVRvgVvQBpBUjPzTE2GJ8YzLLGrkZMeDDx+/nJ1Ifl56/NMlHrefmZutYozyoFlkO63NMK5eSic525+1baHwNQ/6HSTYyRnW2EExYyI7BuJze4lf/GxijzKyIa9IbYpU6y6epvRJU3COTMiFoW5mzpxkqLE1wQ7wAl6UxIqUV/JB8xpKKGYABeld4/Gbu8G5T1Pe1uNw18ZRXu8CsWO9MZp5BT9f/inadx2Sz4n7oH1Jyf/D21wDZKBXPlFhLDdqjRaz0kv+xs1wbfEqk84xrwiX3QhjZZym8Sk7T-----END CERTIFICATE-----",
												"type": "text"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"account\": {\n    \"iban\": \"{{iban_none}}\",\n    \"currency\": \"EUR\"\n  },\n  \"instructedAmount\": {\n    \"amount\": \"100.00\",\n    \"currency\": \"EUR\"\n  },\n  \"payee\": \"Check24\"\n}"
										},
										"url": {
											"raw": "{{protocol}}://{{url_xs2a}}/v1/funds-confirmations",
											"protocol": "{{protocol}}",
											"host": [
												"{{url_xs2a}}"
											],
											"path": [
												"v1",
												"funds-confirmations"
											]
										}
									},
									"response": []
								}
							],
							"protocolProfileBehavior": {},
							"_postman_isSubFolder": true
						}
					],
					"protocolProfileBehavior": {},
					"_postman_isSubFolder": true
				},
				{
					"name": "PIIS Consent - Multitenancy support",
					"item": [
						{
							"name": "1. Enable PIIS consent support in ASPSP profile",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "2ab16e8d-4c5d-4802-9060-df3062e30074",
										"exec": [
											"pm.test(\"Status code is 200\", () => {",
											"    pm.response.to.have.status(200);",
											"});",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "PUT",
								"header": [
									{
										"key": "Content-Type",
										"name": "Content-Type",
										"value": "application/json",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"ais\": {\n        \"consentTypes\": {\n            \"bankOfferedConsentSupported\": false,\n            \"globalConsentSupported\": false,\n            \"availableAccountsConsentSupported\": true,\n            \"accountAccessFrequencyPerDay\": 4,\n            \"notConfirmedConsentExpirationTimeMs\": 86400000,\n            \"maxConsentValidityDays\": 0\n        },\n        \"redirectLinkToOnlineBanking\": {\n            \"aisRedirectUrlToAspsp\": \"http://localhost:4200/ais/{redirect-id}/{encrypted-consent-id}\"\n        },\n        \"transactionParameters\": {\n            \"availableBookingStatuses\": [\n                \"BOOKED\",\n                \"PENDING\"\n            ],\n            \"transactionsWithoutBalancesSupported\": false,\n            \"supportedTransactionApplicationTypes\": [\n            \t\"application/json\"\n            ]\n        },\n        \"deltaReportSettings\": {\n            \"entryReferenceFromSupported\": false,\n            \"deltaListSupported\": false\n        },\n        \"scaRequirementsForOneTimeConsents\": {\n            \"scaByOneTimeAvailableAccountsConsentRequired\": true,\n            \"scaByOneTimeGlobalConsentRequired\": true\n        }\n    },\n    \"pis\": {\n        \"supportedPaymentTypeAndProductMatrix\": {\n            \"payments\": [\n                \"sepa-credit-transfers\",\n                \"instant-sepa-credit-transfers\"\n            ]\n        },\n        \"maxTransactionValidityDays\": 0,\n        \"notConfirmedPaymentExpirationTimeMs\": 86400000,\n        \"paymentCancellationAuthorisationMandated\": false,\n        \"redirectLinkToOnlineBanking\": {\n            \"pisRedirectUrlToAspsp\": \"http://localhost:4200/pis/{redirect-id}/{encrypted-payment-id}\",\n            \"pisPaymentCancellationRedirectUrlToAspsp\": \"http://localhost:4200/pis/cancellation/{redirect-id}/{encrypted-payment-id}\",\n            \"paymentCancellationRedirectUrlExpirationTimeMs\": 600000\n        }\n    },\n    \"piis\": {\n        \"piisConsentSupported\": \"ASPSP_CONSENT_SUPPORTED\"\n    },\n    \"common\": {\n        \"scaRedirectFlow\": \"REDIRECT\",\n        \"startAuthorisationMode\": \"auto\",\n        \"tppSignatureRequired\": false,\n        \"psuInInitialRequestMandated\": false,\n        \"redirectUrlExpirationTimeMs\": 600000,\n        \"authorisationExpirationTimeMs\": 86400000,\n        \"forceXs2aBaseLinksUrl\": false,\n        \"xs2aBaseLinksUrl\": \"http://myhost.com/\",\n        \"supportedAccountReferenceFields\": [\n            \"IBAN\"\n        ],\n        \"multicurrencyAccountLevelSupported\": \"SUBACCOUNT\",\n        \"aisPisSessionsSupported\": false,\n        \"signingBasketSupported\": false,\n        \"aspspNotificationsSupported\": [\n        \t\"NONE\"\t\n        ]\n    }\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{protocol}}://{{url_aspsp_profile}}/api/v1/aspsp-profile/for-debug/aspsp-settings",
									"protocol": "{{protocol}}",
									"host": [
										"{{url_aspsp_profile}}"
									],
									"path": [
										"api",
										"v1",
										"aspsp-profile",
										"for-debug",
										"aspsp-settings"
									]
								}
							},
							"response": []
						},
						{
							"name": "2. Create PIIS consent in CMS-ASPSP-API",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "480a3824-65e3-4992-bd60-8955d1288d7e",
										"exec": [
											"pm.test(\"Status code is 201\", () => {",
											"    pm.response.to.have.status(201);",
											"});",
											"",
											"const jsonData = pm.response.json();",
											"",
											"pm.test(\"PIIS consent ID exists\", () => {",
											"   pm.expect(jsonData).to.have.property('consentId');",
											"});",
											"",
											"pm.globals.set(\"piis_consent_id\", jsonData.consentId);",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "psu-id",
										"type": "text",
										"value": "{{psu_id_none}}"
									},
									{
										"key": "Content-Type",
										"name": "Content-Type",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "Instance-ID",
										"value": "bank1",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"account\": {\n    \"iban\": \"{{iban_none}}\",\n    \"currency\": \"EUR\"\n  },\n  \"tppAuthorisationNumber\": \"PSDDE-FAKENCA-87B2AC\",\n  \"validUntil\": \"2020-10-10\"\n}"
								},
								"url": {
									"raw": "{{protocol}}://{{url_cms}}/aspsp-api/v1/piis/consents/",
									"protocol": "{{protocol}}",
									"host": [
										"{{url_cms}}"
									],
									"path": [
										"aspsp-api",
										"v1",
										"piis",
										"consents",
										""
									]
								}
							},
							"response": []
						},
						{
							"name": "3. Authorise in ledgers",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "1379eee3-37ba-47eb-8fa5-10688b27c81b",
										"exec": [
											"pm.test(\"Status code is 200\", () => {",
											"    pm.response.to.have.status(200);",
											"});",
											"",
											"const jsonData = pm.response.json();",
											"",
											"pm.test(\"Bearer token exists\", () => {",
											"   pm.expect(jsonData).to.have.property('bearerToken');",
											"});",
											"",
											"var tokenWithoutQuotes = JSON.stringify(jsonData.bearerToken.access_token).replace(/\"/g,\"\")",
											"",
											"pm.globals.set(\"ledgersBearerToken\", tokenWithoutQuotes);"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "psu-id",
										"type": "text",
										"value": "{{psu_id_none}}",
										"disabled": true
									},
									{
										"key": "Content-Type",
										"name": "Content-Type",
										"type": "text",
										"value": "application/json"
									}
								],
								"url": {
									"raw": "{{protocol}}://{{url_ledgers}}/users/login?login={{psu_id_none}}&pin={{psu_id_password}}&role=CUSTOMER",
									"protocol": "{{protocol}}",
									"host": [
										"{{url_ledgers}}"
									],
									"path": [
										"users",
										"login"
									],
									"query": [
										{
											"key": "login",
											"value": "{{psu_id_none}}"
										},
										{
											"key": "pin",
											"value": "{{psu_id_password}}"
										},
										{
											"key": "role",
											"value": "CUSTOMER"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "4. Execute /me request",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "fb5f6f04-033e-4ab9-ae25-b87cc953e26b",
										"exec": [
											"pm.test(\"Status code is 200\", () => {",
											"    pm.response.to.have.status(200);",
											"});",
											"",
											"const jsonData = pm.response.json();",
											"",
											"pm.test(\"User ID exists\", () => {",
											"   pm.expect(jsonData).to.have.property('id');",
											"});",
											"",
											"pm.globals.set(\"userId\", jsonData.id);"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{ledgersBearerToken}}",
											"type": "string"
										}
									]
								},
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{protocol}}://{{url_ledgers}}/users/me",
									"protocol": "{{protocol}}",
									"host": [
										"{{url_ledgers}}"
									],
									"path": [
										"users",
										"me"
									]
								}
							},
							"response": []
						},
						{
							"name": "5. Create PIIS consent in ledgers",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "8c619f52-631d-466d-9c0f-b08ac6f95298",
										"exec": [
											"pm.test(\"Status code is 200\", () => {",
											"    pm.response.to.have.status(200);",
											"});",
											"",
											"const jsonData = pm.response.json();",
											"",
											"pm.test(\"SCA status exists\", () => {",
											"   pm.expect(jsonData).to.have.property('scaStatus');",
											"});",
											"",
											"pm.globals.set(\"ledgersResponse\", JSON.stringify(jsonData));"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{ledgersBearerToken}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"name": "Content-Type",
										"value": "application/json",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"access\": {\n    \"accounts\": [\n         \"{{iban_none}}\"\n    ]\n  },\n  \"frequencyPerDay\": 4,\n  \"tppId\": \"PSDDE-FAKENCA-87B2AC\",\n  \"userId\": \"{{userId}}\",\n  \"validUntil\": \"2020-10-10\"\n}"
								},
								"url": {
									"raw": "{{protocol}}://{{url_ledgers}}/consents/piis",
									"protocol": "{{protocol}}",
									"host": [
										"{{url_ledgers}}"
									],
									"path": [
										"consents",
										"piis"
									]
								}
							},
							"response": []
						},
						{
							"name": "6. Update ASPSP consent data for the given PIIS consent in CMS-PSU-API",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "c3e24062-f1da-4f38-bc02-e2ba54e80d8d",
										"exec": [
											"pm.test(\"Status code is 200\", () => {",
											"    pm.response.to.have.status(200);",
											"});",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"id": "a6a8134f-24ac-499c-b9ef-669e18f72c77",
										"exec": [
											"var ledgersResponse = pm.globals.get(\"ledgersResponse\");",
											"var utf8string = CryptoJS.enc.Utf8.parse(ledgersResponse);",
											"",
											"pm.globals.set(\"encodedLedgersResponse\", CryptoJS.enc.Base64.stringify(utf8string));"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "PUT",
								"header": [
									{
										"key": "Content-Type",
										"name": "Content-Type",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "Instance-ID",
										"value": "bank1",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"aspspConsentDataBase64\": \"{{encodedLedgersResponse}}\",\n  \"consentId\": \"{{piis_consent_id}}\"\n}"
								},
								"url": {
									"raw": "{{protocol}}://{{url_cms}}/psu-api/v1/aspsp-consent-data/consents/{{piis_consent_id}}",
									"protocol": "{{protocol}}",
									"host": [
										"{{url_cms}}"
									],
									"path": [
										"psu-api",
										"v1",
										"aspsp-consent-data",
										"consents",
										"{{piis_consent_id}}"
									]
								}
							},
							"response": []
						},
						{
							"name": "7. Fund confirmation request in xs2a",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "1eedbb90-8baa-4f52-9419-b394919f6663",
										"exec": [
											"pm.test(\"Status code is 200\", function () {",
											"    pm.response.to.have.status(200);",
											"});",
											"",
											"const jsonData = pm.response.json();",
											"",
											"pm.test(\"fundsAvailable is present\", () => {",
											"    pm.expect(jsonData).to.have.property('fundsAvailable');",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Accept",
										"value": "application/json",
										"type": "text"
									},
									{
										"key": "Content-Type",
										"value": "application/json",
										"type": "text"
									},
									{
										"key": "X-Request-ID",
										"value": "{{x_request_id}}",
										"type": "text"
									},
									{
										"key": "Instance-ID",
										"value": "bank1",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"account\": {\n    \"iban\": \"{{iban_none}}\",\n    \"currency\": \"EUR\"\n  },\n  \"instructedAmount\": {\n    \"amount\": \"100.00\",\n    \"currency\": \"EUR\"\n  },\n  \"payee\": \"Check24\"\n}"
								},
								"url": {
									"raw": "{{protocol}}://{{url_xs2a}}/v1/funds-confirmations",
									"protocol": "{{protocol}}",
									"host": [
										"{{url_xs2a}}"
									],
									"path": [
										"v1",
										"funds-confirmations"
									]
								}
							},
							"response": []
						}
					],
					"protocolProfileBehavior": {},
					"_postman_isSubFolder": true
				},
				{
					"name": "1. Enable PIIS consent support in ASPSP profile",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "3fce7d4c-84a2-4e95-9d50-b9996e0c7ecb",
								"exec": [
									"pm.test(\"Status code is 200\", () => {",
									"    pm.response.to.have.status(200);",
									"});",
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"name": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"ais\": {\n        \"consentTypes\": {\n            \"bankOfferedConsentSupported\": false,\n            \"globalConsentSupported\": false,\n            \"availableAccountsConsentSupported\": true,\n            \"accountAccessFrequencyPerDay\": 4,\n            \"notConfirmedConsentExpirationTimeMs\": 86400000,\n            \"maxConsentValidityDays\": 0\n        },\n        \"redirectLinkToOnlineBanking\": {\n            \"aisRedirectUrlToAspsp\": \"http://localhost:4200/ais/{redirect-id}/{encrypted-consent-id}\"\n        },\n        \"transactionParameters\": {\n            \"availableBookingStatuses\": [\n                \"BOOKED\",\n                \"PENDING\"\n            ],\n            \"transactionsWithoutBalancesSupported\": false,\n            \"supportedTransactionApplicationTypes\": [\n            \t\"application/json\"\n            ]\n        },\n        \"deltaReportSettings\": {\n            \"entryReferenceFromSupported\": false,\n            \"deltaListSupported\": false\n        },\n        \"scaRequirementsForOneTimeConsents\": {\n            \"scaByOneTimeAvailableAccountsConsentRequired\": true,\n            \"scaByOneTimeGlobalConsentRequired\": true\n        }\n    },\n    \"pis\": {\n        \"supportedPaymentTypeAndProductMatrix\": {\n            \"payments\": [\n                \"sepa-credit-transfers\",\n                \"instant-sepa-credit-transfers\"\n            ]\n        },\n        \"maxTransactionValidityDays\": 0,\n        \"notConfirmedPaymentExpirationTimeMs\": 86400000,\n        \"paymentCancellationAuthorisationMandated\": false,\n        \"redirectLinkToOnlineBanking\": {\n            \"pisRedirectUrlToAspsp\": \"http://localhost:4200/pis/{redirect-id}/{encrypted-payment-id}\",\n            \"pisPaymentCancellationRedirectUrlToAspsp\": \"http://localhost:4200/pis/cancellation/{redirect-id}/{encrypted-payment-id}\",\n            \"paymentCancellationRedirectUrlExpirationTimeMs\": 600000\n        }\n    },\n    \"piis\": {\n        \"piisConsentSupported\": \"ASPSP_CONSENT_SUPPORTED\"\n    },\n    \"common\": {\n        \"scaRedirectFlow\": \"REDIRECT\",\n        \"startAuthorisationMode\": \"auto\",\n        \"tppSignatureRequired\": false,\n        \"psuInInitialRequestMandated\": false,\n        \"redirectUrlExpirationTimeMs\": 600000,\n        \"authorisationExpirationTimeMs\": 86400000,\n        \"forceXs2aBaseLinksUrl\": false,\n        \"xs2aBaseLinksUrl\": \"http://myhost.com/\",\n        \"supportedAccountReferenceFields\": [\n            \"IBAN\"\n        ],\n        \"multicurrencyAccountLevelSupported\": \"SUBACCOUNT\",\n        \"aisPisSessionsSupported\": false,\n        \"signingBasketSupported\": false,\n        \"aspspNotificationsSupported\": [\n        \t\"NONE\"\t\n        ]\n    }\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{protocol}}://{{url_aspsp_profile}}/api/v1/aspsp-profile/for-debug/aspsp-settings",
							"protocol": "{{protocol}}",
							"host": [
								"{{url_aspsp_profile}}"
							],
							"path": [
								"api",
								"v1",
								"aspsp-profile",
								"for-debug",
								"aspsp-settings"
							]
						}
					},
					"response": []
				},
				{
					"name": "2. Create PIIS consent in CMS-ASPSP-API",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "a62a5ae8-5fda-4138-9eff-5f479f2da9dd",
								"exec": [
									"pm.test(\"Status code is 201\", () => {",
									"    pm.response.to.have.status(201);",
									"});",
									"",
									"const jsonData = pm.response.json();",
									"",
									"pm.test(\"PIIS consent ID exists\", () => {",
									"   pm.expect(jsonData).to.have.property('consentId');",
									"});",
									"",
									"pm.globals.set(\"piis_consent_id\", jsonData.consentId);",
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "psu-id",
								"value": "{{psu_id_none}}",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"name": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"account\": {\n    \"iban\": \"{{iban_none}}\",\n    \"currency\": \"EUR\"\n  },\n  \"tppAuthorisationNumber\": \"PSDDE-FAKENCA-87B2AC\",\n  \"validUntil\": \"2020-10-10\"\n}"
						},
						"url": {
							"raw": "{{protocol}}://{{url_cms}}/aspsp-api/v1/piis/consents/",
							"protocol": "{{protocol}}",
							"host": [
								"{{url_cms}}"
							],
							"path": [
								"aspsp-api",
								"v1",
								"piis",
								"consents",
								""
							]
						}
					},
					"response": []
				},
				{
					"name": "3. Authorise in ledgers",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "f7b0b63b-160f-4d16-ae9c-3af5f8185793",
								"exec": [
									"pm.test(\"Status code is 200\", () => {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"const jsonData = pm.response.json();",
									"",
									"pm.test(\"Bearer token exists\", () => {",
									"   pm.expect(jsonData).to.have.property('bearerToken');",
									"});",
									"",
									"var tokenWithoutQuotes = JSON.stringify(jsonData.bearerToken.access_token).replace(/\"/g,\"\")",
									"",
									"pm.globals.set(\"ledgersBearerToken\", tokenWithoutQuotes);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "psu-id",
								"type": "text",
								"value": "{{psu_id_none}}",
								"disabled": true
							},
							{
								"key": "Content-Type",
								"name": "Content-Type",
								"type": "text",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{protocol}}://{{url_ledgers}}/users/login?login={{psu_id_none}}&pin={{psu_id_password}}&role=CUSTOMER",
							"protocol": "{{protocol}}",
							"host": [
								"{{url_ledgers}}"
							],
							"path": [
								"users",
								"login"
							],
							"query": [
								{
									"key": "login",
									"value": "{{psu_id_none}}"
								},
								{
									"key": "pin",
									"value": "{{psu_id_password}}"
								},
								{
									"key": "role",
									"value": "CUSTOMER"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "4. Execute /me request",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "8a9c5767-cad3-487c-a143-028229c4370f",
								"exec": [
									"pm.test(\"Status code is 200\", () => {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"const jsonData = pm.response.json();",
									"",
									"pm.test(\"User ID exists\", () => {",
									"   pm.expect(jsonData).to.have.property('id');",
									"});",
									"",
									"pm.globals.set(\"userId\", jsonData.id);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{ledgersBearerToken}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{protocol}}://{{url_ledgers}}/users/me",
							"protocol": "{{protocol}}",
							"host": [
								"{{url_ledgers}}"
							],
							"path": [
								"users",
								"me"
							]
						}
					},
					"response": []
				},
				{
					"name": "5. Create PIIS consent in ledgers",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "58efe086-1a38-4dce-9ae4-d7222133fddf",
								"exec": [
									"pm.test(\"Status code is 200\", () => {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"const jsonData = pm.response.json();",
									"",
									"pm.test(\"SCA status exists\", () => {",
									"   pm.expect(jsonData).to.have.property('scaStatus');",
									"});",
									"",
									"pm.globals.set(\"ledgersResponse\", JSON.stringify(jsonData));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{ledgersBearerToken}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"name": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"access\": {\n    \"accounts\": [\n         \"{{iban_none}}\"\n    ]\n  },\n  \"frequencyPerDay\": 4,\n  \"tppId\": \"PSDDE-FAKENCA-87B2AC\",\n  \"userId\": \"{{userId}}\",\n  \"validUntil\": \"2020-10-10\"\n}"
						},
						"url": {
							"raw": "{{protocol}}://{{url_ledgers}}/consents/piis",
							"protocol": "{{protocol}}",
							"host": [
								"{{url_ledgers}}"
							],
							"path": [
								"consents",
								"piis"
							]
						}
					},
					"response": []
				},
				{
					"name": "6. Update ASPSP consent data for the given PIIS consent in CMS-PSU-API Copy",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "924c9874-653f-460a-a057-a6e371ac5c78",
								"exec": [
									"pm.test(\"Status code is 200\", () => {",
									"    pm.response.to.have.status(200);",
									"});",
									""
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"id": "a4b30bd0-e1ed-4681-96e4-64ce193d8ef0",
								"exec": [
									"var ledgersResponse = pm.globals.get(\"ledgersResponse\");",
									"var utf8string = CryptoJS.enc.Utf8.parse(ledgersResponse);",
									"",
									"pm.globals.set(\"encodedLedgersResponse\", CryptoJS.enc.Base64.stringify(utf8string));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"name": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"aspspConsentDataBase64\": \"{{encodedLedgersResponse}}\",\n  \"consentId\": \"{{piis_consent_id}}\"\n}"
						},
						"url": {
							"raw": "{{protocol}}://{{url_cms}}/psu-api/v1/aspsp-consent-data/consents/{{piis_consent_id}}",
							"protocol": "{{protocol}}",
							"host": [
								"{{url_cms}}"
							],
							"path": [
								"psu-api",
								"v1",
								"aspsp-consent-data",
								"consents",
								"{{piis_consent_id}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "7. Fund confirmation request in xs2a",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "8abab697-751f-415a-b48d-efe41d455266",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"const jsonData = pm.response.json();",
									"",
									"pm.test(\"fundsAvailable is present\", () => {",
									"    pm.expect(jsonData).to.have.property('fundsAvailable');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "X-Request-ID",
								"value": "{{x_request_id}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"account\": {\n    \"iban\": \"{{iban_none}}\",\n    \"currency\": \"EUR\"\n  },\n  \"instructedAmount\": {\n    \"amount\": \"100.00\",\n    \"currency\": \"EUR\"\n  },\n  \"payee\": \"Check24\"\n}"
						},
						"url": {
							"raw": "{{protocol}}://{{url_xs2a}}/v1/funds-confirmations",
							"protocol": "{{protocol}}",
							"host": [
								"{{url_xs2a}}"
							],
							"path": [
								"v1",
								"funds-confirmations"
							]
						}
					},
					"response": []
				}
			],
			"protocolProfileBehavior": {}
		},
		{
			"name": "v2",
			"item": [
				{
					"name": "Errorful requests",
					"item": [
						{
							"name": "Validation failures",
							"item": [
								{
									"name": "1. Enable PIIS consent support in ASPSP profile",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "8597f17c-33a0-423b-ab38-eb917028cf0c",
												"exec": [
													"pm.test(\"Status code is 200\", () => {",
													"    pm.response.to.have.status(200);",
													"});",
													""
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "PUT",
										"header": [
											{
												"key": "Content-Type",
												"name": "Content-Type",
												"type": "text",
												"value": "application/json"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"ais\": {\n        \"consentTypes\": {\n            \"bankOfferedConsentSupported\": false,\n            \"globalConsentSupported\": false,\n            \"availableAccountsConsentSupported\": true,\n            \"accountAccessFrequencyPerDay\": 4,\n            \"notConfirmedConsentExpirationTimeMs\": 86400000,\n            \"maxConsentValidityDays\": 0\n        },\n        \"redirectLinkToOnlineBanking\": {\n            \"aisRedirectUrlToAspsp\": \"http://localhost:4200/ais/{redirect-id}/{encrypted-consent-id}\"\n        },\n        \"transactionParameters\": {\n            \"availableBookingStatuses\": [\n                \"BOOKED\",\n                \"PENDING\"\n            ],\n            \"transactionsWithoutBalancesSupported\": false,\n            \"supportedTransactionApplicationTypes\": [\n            \t\"application/json\"\n            ]\n        },\n        \"deltaReportSettings\": {\n            \"entryReferenceFromSupported\": false,\n            \"deltaListSupported\": false\n        },\n        \"scaRequirementsForOneTimeConsents\": {\n            \"scaByOneTimeAvailableAccountsConsentRequired\": true,\n            \"scaByOneTimeGlobalConsentRequired\": true\n        }\n    },\n    \"pis\": {\n        \"supportedPaymentTypeAndProductMatrix\": {\n            \"payments\": [\n                \"sepa-credit-transfers\",\n                \"instant-sepa-credit-transfers\"\n            ]\n        },\n        \"maxTransactionValidityDays\": 0,\n        \"notConfirmedPaymentExpirationTimeMs\": 86400000,\n        \"paymentCancellationAuthorisationMandated\": false,\n        \"redirectLinkToOnlineBanking\": {\n            \"pisRedirectUrlToAspsp\": \"http://localhost:4200/pis/{redirect-id}/{encrypted-payment-id}\",\n            \"pisPaymentCancellationRedirectUrlToAspsp\": \"http://localhost:4200/pis/cancellation/{redirect-id}/{encrypted-payment-id}\",\n            \"paymentCancellationRedirectUrlExpirationTimeMs\": 600000\n        }\n    },\n    \"piis\": {\n        \"piisConsentSupported\": \"TPP_CONSENT_SUPPORTED\"\n    },\n    \"common\": {\n        \"scaRedirectFlow\": \"REDIRECT\",\n        \"startAuthorisationMode\": \"implicit\",\n        \"tppSignatureRequired\": false,\n        \"psuInInitialRequestMandated\": false,\n        \"redirectUrlExpirationTimeMs\": 600000,\n        \"authorisationExpirationTimeMs\": 86400000,\n        \"forceXs2aBaseLinksUrl\": false,\n        \"xs2aBaseLinksUrl\": \"http://myhost.com/\",\n        \"supportedAccountReferenceFields\": [\n            \"IBAN\"\n        ],\n        \"multicurrencyAccountLevelSupported\": \"SUBACCOUNT\",\n        \"aisPisSessionsSupported\": false,\n        \"signingBasketSupported\": false,\n        \"aspspNotificationsSupported\": [\n        \t\"NONE\"\t\n        ]\n    }\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{protocol}}://{{url_aspsp_profile}}/api/v1/aspsp-profile/for-debug/aspsp-settings",
											"protocol": "{{protocol}}",
											"host": [
												"{{url_aspsp_profile}}"
											],
											"path": [
												"api",
												"v1",
												"aspsp-profile",
												"for-debug",
												"aspsp-settings"
											]
										}
									},
									"response": []
								},
								{
									"name": "2. Create PIIS consent in XS2A oversized cardNumber",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "6d4ce66e-20f1-48ce-ae15-d7fa78500cac",
												"exec": [
													"pm.test(\"Status code is 400\", () => {",
													"    pm.response.to.have.status(400);",
													"});",
													"",
													"const jsonData = pm.response.json();",
													"",
													"pm.test('TppMessages and error are exist', () => {",
													"    ",
													"    pm.expect(jsonData).to.have.property('tppMessages');",
													"    ",
													"    var error = jsonData.tppMessages[0];",
													"       ",
													"    pm.expect(error).to.have.property('category');",
													"    pm.expect(error).to.have.property('code');",
													"    pm.expect(error).to.have.property('text');",
													"       ",
													"    pm.expect(error.category).to.eql('ERROR');",
													"    pm.expect(error.code).to.eql('FORMAT_ERROR');",
													"    pm.expect(error.text).to.eql('Value \\'cardNumber\\' should not be more than 35 symbols');",
													"    ",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "psu-id",
												"type": "text",
												"value": "{{psu_id_none}}"
											},
											{
												"key": "Content-Type",
												"name": "Content-Type",
												"type": "text",
												"value": "application/json"
											},
											{
												"key": "X-Request-ID",
												"value": "{{x_request_id}}",
												"type": "text"
											},
											{
												"key": "TPP-Explicit-Authorisation-Preferred",
												"value": "true",
												"type": "text"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"account\": {\n    \"iban\": \"{{iban_none}}\",\n    \"currency\": \"EUR\"\n  },\n  \"cardNumber\": \"dqjqqqE62vfaoac2cSZSwQGs95dRnRgIK8sR\",\n  \"cardExpiryDate\": \"2030-10-10\",\n  \"cardInformation\": \"cardInformation\",\n  \"registrationInformation\": \"registrationInformation\"\n\n}",
											"options": {
												"raw": {}
											}
										},
										"url": {
											"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds",
											"protocol": "{{protocol}}",
											"host": [
												"{{url_xs2a}}"
											],
											"path": [
												"v2",
												"consents",
												"confirmation-of-funds"
											]
										}
									},
									"response": []
								},
								{
									"name": "3. Create PIIS consent in XS2A oversized cardInformation",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "bf998deb-aa1f-4347-9085-83bab144b94b",
												"exec": [
													"pm.test(\"Status code is 400\", () => {",
													"    pm.response.to.have.status(400);",
													"});",
													"",
													"const jsonData = pm.response.json();",
													"",
													"pm.test('TppMessages and error are exist', () => {",
													"    ",
													"    pm.expect(jsonData).to.have.property('tppMessages');",
													"    ",
													"    var error = jsonData.tppMessages[0];",
													"       ",
													"    pm.expect(error).to.have.property('category');",
													"    pm.expect(error).to.have.property('code');",
													"    pm.expect(error).to.have.property('text');",
													"       ",
													"    pm.expect(error.category).to.eql('ERROR');",
													"    pm.expect(error.code).to.eql('FORMAT_ERROR');",
													"    pm.expect(error.text).to.eql('Value \\'cardInformation\\' should not be more than 140 symbols');",
													"    ",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "psu-id",
												"type": "text",
												"value": "{{psu_id_none}}"
											},
											{
												"key": "Content-Type",
												"name": "Content-Type",
												"type": "text",
												"value": "application/json"
											},
											{
												"key": "X-Request-ID",
												"type": "text",
												"value": "{{x_request_id}}"
											},
											{
												"key": "TPP-Explicit-Authorisation-Preferred",
												"type": "text",
												"value": "true"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"account\": {\n    \"iban\": \"{{iban_none}}\",\n    \"currency\": \"EUR\"\n  },\n  \"cardNumber\": \"cardNumber\",\n  \"cardExpiryDate\": \"2030-10-10\",\n  \"cardInformation\": \"1J9m7Hcm0Lud9nqX8prXlQSsbQM3E30J7adDYMrIuINK9rb0ZeTnK1UFW1MxeYq9SHjtCvQau4dEtE5y7ER3AIhm5yv4gtxNiv3fx6iSGAdDKifaYzcDLmiZ0HwrS1Dy05FunvJMCOe2S\",\n  \"registrationInformation\": \"registrationInformation\"\n\n}",
											"options": {
												"raw": {}
											}
										},
										"url": {
											"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds",
											"protocol": "{{protocol}}",
											"host": [
												"{{url_xs2a}}"
											],
											"path": [
												"v2",
												"consents",
												"confirmation-of-funds"
											]
										}
									},
									"response": []
								},
								{
									"name": "4. Create PIIS consent in XS2A oversized registrationInformation",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "761cb090-8130-43bd-a49d-f27dffc29d45",
												"exec": [
													"pm.test(\"Status code is 400\", () => {",
													"    pm.response.to.have.status(400);",
													"});",
													"",
													"const jsonData = pm.response.json();",
													"",
													"pm.test('TppMessages and error are exist', () => {",
													"    ",
													"    pm.expect(jsonData).to.have.property('tppMessages');",
													"    ",
													"    var error = jsonData.tppMessages[0];",
													"       ",
													"    pm.expect(error).to.have.property('category');",
													"    pm.expect(error).to.have.property('code');",
													"    pm.expect(error).to.have.property('text');",
													"       ",
													"    pm.expect(error.category).to.eql('ERROR');",
													"    pm.expect(error.code).to.eql('FORMAT_ERROR');",
													"    pm.expect(error.text).to.eql('Value \\'registrationInformation\\' should not be more than 140 symbols');",
													"    ",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "psu-id",
												"type": "text",
												"value": "{{psu_id_none}}"
											},
											{
												"key": "Content-Type",
												"name": "Content-Type",
												"type": "text",
												"value": "application/json"
											},
											{
												"key": "X-Request-ID",
												"type": "text",
												"value": "{{x_request_id}}"
											},
											{
												"key": "TPP-Explicit-Authorisation-Preferred",
												"type": "text",
												"value": "true"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"account\": {\n    \"iban\": \"{{iban_none}}\",\n    \"currency\": \"EUR\"\n  },\n  \"cardNumber\": \"cardNumber\",\n  \"cardExpiryDate\": \"2030-10-10\",\n  \"cardInformation\": \"cardInformation\",\n  \"registrationInformation\": \"1J9m7Hcm0Lud9nqX8prXlQSsbQM3E30J7adDYMrIuINK9rb0ZeTnK1UFW1MxeYq9SHjtCvQau4dEtE5y7ER3AIhm5yv4gtxNiv3fx6iSGAdDKifaYzcDLmiZ0HwrS1Dy05FunvJMCOe2S\"\n\n}",
											"options": {
												"raw": {}
											}
										},
										"url": {
											"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds",
											"protocol": "{{protocol}}",
											"host": [
												"{{url_xs2a}}"
											],
											"path": [
												"v2",
												"consents",
												"confirmation-of-funds"
											]
										}
									},
									"response": []
								},
								{
									"name": "5. Create PIIS consent in XS2A invalid iban",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "0e077f19-063b-4e85-9ad3-13628e753a34",
												"exec": [
													"pm.test(\"Status code is 400\", () => {",
													"    pm.response.to.have.status(400);",
													"});",
													"",
													"const jsonData = pm.response.json();",
													"",
													"pm.test('TppMessages and error are exist', () => {",
													"    ",
													"    pm.expect(jsonData).to.have.property('tppMessages');",
													"    ",
													"    var error = jsonData.tppMessages[0];",
													"       ",
													"    pm.expect(error).to.have.property('category');",
													"    pm.expect(error).to.have.property('code');",
													"    pm.expect(error).to.have.property('text');",
													"       ",
													"    pm.expect(error.category).to.eql('ERROR');",
													"    pm.expect(error.code).to.eql('FORMAT_ERROR');",
													"    pm.expect(error.text).to.eql('Invalid IBAN format');",
													"    ",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "psu-id",
												"type": "text",
												"value": "{{psu_id_none}}"
											},
											{
												"key": "Content-Type",
												"name": "Content-Type",
												"type": "text",
												"value": "application/json"
											},
											{
												"key": "X-Request-ID",
												"value": "{{x_request_id}}",
												"type": "text"
											},
											{
												"key": "TPP-Explicit-Authorisation-Preferred",
												"value": "true",
												"type": "text"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"account\": {\n    \"iban\": \"invalid\",\n    \"currency\": \"EUR\"\n  },\n  \"cardNumber\": \"cardNumber\",\n  \"cardExpiryDate\": \"2030-10-10\",\n  \"cardInformation\": \"cardInformation\",\n  \"registrationInformation\": \"registrationInformation\"\n\n}",
											"options": {
												"raw": {}
											}
										},
										"url": {
											"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds",
											"protocol": "{{protocol}}",
											"host": [
												"{{url_xs2a}}"
											],
											"path": [
												"v2",
												"consents",
												"confirmation-of-funds"
											]
										}
									},
									"response": []
								},
								{
									"name": "6. Create PIIS consent in XS2A invalid currency",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "2625657a-bf1e-46e3-bac5-4b581e56fe05",
												"exec": [
													"pm.test(\"Status code is 400\", () => {",
													"    pm.response.to.have.status(400);",
													"});",
													"",
													"const jsonData = pm.response.json();",
													"",
													"pm.test('TppMessages and error are exist', () => {",
													"    ",
													"    pm.expect(jsonData).to.have.property('tppMessages');",
													"    ",
													"    var error = jsonData.tppMessages[0];",
													"       ",
													"    pm.expect(error).to.have.property('category');",
													"    pm.expect(error).to.have.property('code');",
													"    pm.expect(error).to.have.property('text');",
													"       ",
													"    pm.expect(error.category).to.eql('ERROR');",
													"    pm.expect(error.code).to.eql('FORMAT_ERROR');",
													"    pm.expect(error.text).to.eql('Value \\'currency\\' has wrong format');",
													"    ",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "psu-id",
												"type": "text",
												"value": "{{psu_id_none}}"
											},
											{
												"key": "Content-Type",
												"name": "Content-Type",
												"type": "text",
												"value": "application/json"
											},
											{
												"key": "X-Request-ID",
												"value": "{{x_request_id}}",
												"type": "text"
											},
											{
												"key": "TPP-Explicit-Authorisation-Preferred",
												"value": "true",
												"type": "text"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"account\": {\n    \"iban\": \"{{iban_none}}\",\n    \"currency\": \"currency\"\n  },\n  \"cardNumber\": \"cardNumber\",\n  \"cardExpiryDate\": \"2030-10-10\",\n  \"cardInformation\": \"cardInformation\",\n  \"registrationInformation\": \"registrationInformation\"\n\n}",
											"options": {
												"raw": {}
											}
										},
										"url": {
											"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds",
											"protocol": "{{protocol}}",
											"host": [
												"{{url_xs2a}}"
											],
											"path": [
												"v2",
												"consents",
												"confirmation-of-funds"
											]
										}
									},
									"response": []
								},
								{
									"name": "7. Create PIIS consent in XS2A null account",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "28c0fa03-1665-4052-bb9d-787eb2f7e045",
												"exec": [
													"pm.test(\"Status code is 400\", () => {",
													"    pm.response.to.have.status(400);",
													"});",
													"",
													"const jsonData = pm.response.json();",
													"",
													"pm.test('TppMessages and error are exist', () => {",
													"    ",
													"    pm.expect(jsonData).to.have.property('tppMessages');",
													"    ",
													"    var error = jsonData.tppMessages[0];",
													"       ",
													"    pm.expect(error).to.have.property('category');",
													"    pm.expect(error).to.have.property('code');",
													"    pm.expect(error).to.have.property('text');",
													"       ",
													"    pm.expect(error.category).to.eql('ERROR');",
													"    pm.expect(error.code).to.eql('FORMAT_ERROR');",
													"    pm.expect(error.text).to.eql('Value \\'account\\' should not be null');",
													"    ",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "psu-id",
												"type": "text",
												"value": "{{psu_id_none}}"
											},
											{
												"key": "Content-Type",
												"name": "Content-Type",
												"type": "text",
												"value": "application/json"
											},
											{
												"key": "X-Request-ID",
												"value": "{{x_request_id}}",
												"type": "text"
											},
											{
												"key": "TPP-Explicit-Authorisation-Preferred",
												"value": "true",
												"type": "text"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n \n  \"cardNumber\": \"cardNumber\",\n  \"cardExpiryDate\": \"2030-10-10\",\n  \"cardInformation\": \"cardInformation\",\n  \"registrationInformation\": \"registrationInformation\"\n\n}",
											"options": {
												"raw": {}
											}
										},
										"url": {
											"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds",
											"protocol": "{{protocol}}",
											"host": [
												"{{url_xs2a}}"
											],
											"path": [
												"v2",
												"consents",
												"confirmation-of-funds"
											]
										}
									},
									"response": []
								},
								{
									"name": "8. Create PIIS consent in XS2A invalid account attribute",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "ce130b59-a1f2-4e6f-9da5-fb8d97ed823d",
												"exec": [
													"pm.test(\"Status code is 400\", () => {",
													"    pm.response.to.have.status(400);",
													"});",
													"",
													"const jsonData = pm.response.json();",
													"",
													"pm.test('TppMessages and error are exist', () => {",
													"    ",
													"    pm.expect(jsonData).to.have.property('tppMessages');",
													"    ",
													"    var error = jsonData.tppMessages[0];",
													"       ",
													"    pm.expect(error).to.have.property('category');",
													"    pm.expect(error).to.have.property('code');",
													"    pm.expect(error).to.have.property('text');",
													"       ",
													"    pm.expect(error.category).to.eql('ERROR');",
													"    pm.expect(error.code).to.eql('FORMAT_ERROR');",
													"    pm.expect(error.text).to.eql('Attribute PAN is not supported by the ASPSP');",
													"    ",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "psu-id",
												"type": "text",
												"value": "{{psu_id_none}}"
											},
											{
												"key": "Content-Type",
												"name": "Content-Type",
												"type": "text",
												"value": "application/json"
											},
											{
												"key": "X-Request-ID",
												"value": "{{x_request_id}}",
												"type": "text"
											},
											{
												"key": "TPP-Explicit-Authorisation-Preferred",
												"value": "true",
												"type": "text"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"account\": {\n    \"pan\": \"{{iban_none}}\",\n    \"currency\": \"EUR\"\n  },\n  \"cardNumber\": \"cardNumber\",\n  \"cardExpiryDate\": \"2030-10-10\",\n  \"cardInformation\": \"cardInformation\",\n  \"registrationInformation\": \"registrationInformation\"\n\n}",
											"options": {
												"raw": {}
											}
										},
										"url": {
											"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds",
											"protocol": "{{protocol}}",
											"host": [
												"{{url_xs2a}}"
											],
											"path": [
												"v2",
												"consents",
												"confirmation-of-funds"
											]
										}
									},
									"response": []
								}
							],
							"protocolProfileBehavior": {},
							"_postman_isSubFolder": true
						},
						{
							"name": "Format error no psu on create",
							"item": [
								{
									"name": "1. Set embedded SCA approach",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "82fc2a72-8e61-4e94-9cad-18e6d4b3cc95",
												"exec": [
													"pm.test(\"Status code is 200\", () => {",
													"    pm.response.to.have.status(200);",
													"});",
													""
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "PUT",
										"header": [
											{
												"key": "Content-Type",
												"name": "Content-Type",
												"type": "text",
												"value": "application/json"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "[\n  \"EMBEDDED\",\n  \"REDIRECT\",\n  \"DECOUPLED\"\n]"
										},
										"url": {
											"raw": "{{protocol}}://{{url_aspsp_profile}}/api/v1/aspsp-profile/for-debug/sca-approaches",
											"protocol": "{{protocol}}",
											"host": [
												"{{url_aspsp_profile}}"
											],
											"path": [
												"api",
												"v1",
												"aspsp-profile",
												"for-debug",
												"sca-approaches"
											]
										}
									},
									"response": []
								},
								{
									"name": "2. Enable PIIS consent support in ASPSP profile",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "42f57d45-9755-45e6-a64f-489c0833f079",
												"exec": [
													"pm.test(\"Status code is 200\", () => {",
													"    pm.response.to.have.status(200);",
													"});",
													""
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "PUT",
										"header": [
											{
												"key": "Content-Type",
												"name": "Content-Type",
												"type": "text",
												"value": "application/json"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"ais\": {\n        \"consentTypes\": {\n            \"bankOfferedConsentSupported\": false,\n            \"globalConsentSupported\": false,\n            \"availableAccountsConsentSupported\": true,\n            \"accountAccessFrequencyPerDay\": 4,\n            \"notConfirmedConsentExpirationTimeMs\": 86400000,\n            \"maxConsentValidityDays\": 0\n        },\n        \"redirectLinkToOnlineBanking\": {\n            \"aisRedirectUrlToAspsp\": \"http://localhost:4200/ais/{redirect-id}/{encrypted-consent-id}\"\n        },\n        \"transactionParameters\": {\n            \"availableBookingStatuses\": [\n                \"BOOKED\",\n                \"PENDING\"\n            ],\n            \"transactionsWithoutBalancesSupported\": false,\n            \"supportedTransactionApplicationTypes\": [\n            \t\"application/json\"\n            ]\n        },\n        \"deltaReportSettings\": {\n            \"entryReferenceFromSupported\": false,\n            \"deltaListSupported\": false\n        },\n        \"scaRequirementsForOneTimeConsents\": {\n            \"scaByOneTimeAvailableAccountsConsentRequired\": true,\n            \"scaByOneTimeGlobalConsentRequired\": true\n        }\n    },\n    \"pis\": {\n        \"supportedPaymentTypeAndProductMatrix\": {\n            \"payments\": [\n                \"sepa-credit-transfers\",\n                \"instant-sepa-credit-transfers\"\n            ]\n        },\n        \"maxTransactionValidityDays\": 0,\n        \"notConfirmedPaymentExpirationTimeMs\": 86400000,\n        \"paymentCancellationAuthorisationMandated\": false,\n        \"redirectLinkToOnlineBanking\": {\n            \"pisRedirectUrlToAspsp\": \"http://localhost:4200/pis/{redirect-id}/{encrypted-payment-id}\",\n            \"pisPaymentCancellationRedirectUrlToAspsp\": \"http://localhost:4200/pis/cancellation/{redirect-id}/{encrypted-payment-id}\",\n            \"paymentCancellationRedirectUrlExpirationTimeMs\": 600000\n        }\n    },\n    \"piis\": {\n        \"piisConsentSupported\": \"TPP_CONSENT_SUPPORTED\",\n                \"redirectLinkToOnlineBanking\": {\n            \"piisRedirectUrlToAspsp\": \"http://localhost:4200/piis/{redirect-id}/{encrypted-consent-id}\"\n        }\n    },\n    \"common\": {\n        \"scaRedirectFlow\": \"REDIRECT\",\n        \"startAuthorisationMode\": \"implicit\",\n        \"tppSignatureRequired\": false,\n        \"psuInInitialRequestMandated\": true,\n        \"redirectUrlExpirationTimeMs\": 600000,\n        \"authorisationExpirationTimeMs\": 86400000,\n        \"forceXs2aBaseLinksUrl\": false,\n        \"xs2aBaseLinksUrl\": \"http://myhost.com/\",\n        \"supportedAccountReferenceFields\": [\n            \"IBAN\"\n        ],\n        \"multicurrencyAccountLevelSupported\": \"SUBACCOUNT\",\n        \"aisPisSessionsSupported\": false,\n        \"signingBasketSupported\": false,\n        \"aspspNotificationsSupported\": [\n        \t\"NONE\"\t\n        ]\n    }\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{protocol}}://{{url_aspsp_profile}}/api/v1/aspsp-profile/for-debug/aspsp-settings",
											"protocol": "{{protocol}}",
											"host": [
												"{{url_aspsp_profile}}"
											],
											"path": [
												"api",
												"v1",
												"aspsp-profile",
												"for-debug",
												"aspsp-settings"
											]
										}
									},
									"response": []
								},
								{
									"name": "3. Create PIIS consent in XS2A without psu id",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "566e4ed3-5e7f-45ec-8246-d4ca4ca96e84",
												"exec": [
													"pm.test(\"Status code is 400\", () => {",
													"    pm.response.to.have.status(400);",
													"});",
													"",
													"pm.test(\"Error code is FORMAT_ERROR\", () => {",
													"    const jsonData = pm.response.json();",
													"    const error = jsonData.tppMessages[0];",
													"    pm.expect(error.code).to.eql('FORMAT_ERROR');",
													"    pm.expect(error.text).to.eql('PSU-ID is missing in request');",
													"})"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "psu-id",
												"type": "text",
												"value": "{{psu_id_none}}",
												"disabled": true
											},
											{
												"key": "Content-Type",
												"name": "Content-Type",
												"type": "text",
												"value": "application/json"
											},
											{
												"key": "X-Request-ID",
												"type": "text",
												"value": "{{x_request_id}}"
											},
											{
												"key": "TPP-Explicit-Authorisation-Preferred",
												"type": "text",
												"value": "true"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"account\": {\n    \"iban\": \"{{iban_none}}\",\n    \"currency\": \"EUR\"\n  },\n  \"cardNumber\": \"cardNumber\",\n  \"cardExpiryDate\": \"2030-10-10\",\n  \"cardInformation\": \"cardInformation\",\n  \"registrationInformation\": \"registrationInformation\"\n\n}",
											"options": {
												"raw": {}
											}
										},
										"url": {
											"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds",
											"protocol": "{{protocol}}",
											"host": [
												"{{url_xs2a}}"
											],
											"path": [
												"v2",
												"consents",
												"confirmation-of-funds"
											]
										}
									},
									"response": []
								}
							],
							"protocolProfileBehavior": {},
							"_postman_isSubFolder": true
						},
						{
							"name": "Format error no psu on update",
							"item": [
								{
									"name": "1. Set embedded SCA approach",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "2bf096b0-a305-4b15-b7fd-d98d9dec01f0",
												"exec": [
													"pm.test(\"Status code is 200\", () => {",
													"    pm.response.to.have.status(200);",
													"});",
													""
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "PUT",
										"header": [
											{
												"key": "Content-Type",
												"name": "Content-Type",
												"type": "text",
												"value": "application/json"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "[\n  \"EMBEDDED\",\n  \"REDIRECT\",\n  \"DECOUPLED\"\n]"
										},
										"url": {
											"raw": "{{protocol}}://{{url_aspsp_profile}}/api/v1/aspsp-profile/for-debug/sca-approaches",
											"protocol": "{{protocol}}",
											"host": [
												"{{url_aspsp_profile}}"
											],
											"path": [
												"api",
												"v1",
												"aspsp-profile",
												"for-debug",
												"sca-approaches"
											]
										}
									},
									"response": []
								},
								{
									"name": "2. Enable PIIS consent support in ASPSP profile",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "c35c95ef-3fc0-48d7-9ca4-be35e52df90f",
												"exec": [
													"pm.test(\"Status code is 200\", () => {",
													"    pm.response.to.have.status(200);",
													"});",
													""
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "PUT",
										"header": [
											{
												"key": "Content-Type",
												"name": "Content-Type",
												"type": "text",
												"value": "application/json"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"ais\": {\n        \"consentTypes\": {\n            \"bankOfferedConsentSupported\": false,\n            \"globalConsentSupported\": false,\n            \"availableAccountsConsentSupported\": true,\n            \"accountAccessFrequencyPerDay\": 4,\n            \"notConfirmedConsentExpirationTimeMs\": 86400000,\n            \"maxConsentValidityDays\": 0\n        },\n        \"redirectLinkToOnlineBanking\": {\n            \"aisRedirectUrlToAspsp\": \"http://localhost:4200/ais/{redirect-id}/{encrypted-consent-id}\"\n        },\n        \"transactionParameters\": {\n            \"availableBookingStatuses\": [\n                \"BOOKED\",\n                \"PENDING\"\n            ],\n            \"transactionsWithoutBalancesSupported\": false,\n            \"supportedTransactionApplicationTypes\": [\n            \t\"application/json\"\n            ]\n        },\n        \"deltaReportSettings\": {\n            \"entryReferenceFromSupported\": false,\n            \"deltaListSupported\": false\n        },\n        \"scaRequirementsForOneTimeConsents\": {\n            \"scaByOneTimeAvailableAccountsConsentRequired\": true,\n            \"scaByOneTimeGlobalConsentRequired\": true\n        }\n    },\n    \"pis\": {\n        \"supportedPaymentTypeAndProductMatrix\": {\n            \"payments\": [\n                \"sepa-credit-transfers\",\n                \"instant-sepa-credit-transfers\"\n            ]\n        },\n        \"maxTransactionValidityDays\": 0,\n        \"notConfirmedPaymentExpirationTimeMs\": 86400000,\n        \"paymentCancellationAuthorisationMandated\": false,\n        \"redirectLinkToOnlineBanking\": {\n            \"pisRedirectUrlToAspsp\": \"http://localhost:4200/pis/{redirect-id}/{encrypted-payment-id}\",\n            \"pisPaymentCancellationRedirectUrlToAspsp\": \"http://localhost:4200/pis/cancellation/{redirect-id}/{encrypted-payment-id}\",\n            \"paymentCancellationRedirectUrlExpirationTimeMs\": 600000\n        }\n    },\n    \"piis\": {\n        \"piisConsentSupported\": \"TPP_CONSENT_SUPPORTED\",\n                \"redirectLinkToOnlineBanking\": {\n            \"piisRedirectUrlToAspsp\": \"http://localhost:4200/piis/{redirect-id}/{encrypted-consent-id}\"\n        }\n    },\n    \"common\": {\n        \"scaRedirectFlow\": \"REDIRECT\",\n        \"startAuthorisationMode\": \"implicit\",\n        \"tppSignatureRequired\": false,\n        \"psuInInitialRequestMandated\": false,\n        \"redirectUrlExpirationTimeMs\": 600000,\n        \"authorisationExpirationTimeMs\": 86400000,\n        \"forceXs2aBaseLinksUrl\": false,\n        \"xs2aBaseLinksUrl\": \"http://myhost.com/\",\n        \"supportedAccountReferenceFields\": [\n            \"IBAN\"\n        ],\n        \"multicurrencyAccountLevelSupported\": \"SUBACCOUNT\",\n        \"aisPisSessionsSupported\": false,\n        \"signingBasketSupported\": false,\n        \"aspspNotificationsSupported\": [\n        \t\"NONE\"\t\n        ]\n    }\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{protocol}}://{{url_aspsp_profile}}/api/v1/aspsp-profile/for-debug/aspsp-settings",
											"protocol": "{{protocol}}",
											"host": [
												"{{url_aspsp_profile}}"
											],
											"path": [
												"api",
												"v1",
												"aspsp-profile",
												"for-debug",
												"aspsp-settings"
											]
										}
									},
									"response": []
								},
								{
									"name": "3. Create PIIS consent in XS2A without psu id",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "77c483e2-9be6-459e-bae2-cce38b120f9d",
												"exec": [
													"pm.test(\"Status code is 201\", () => {",
													"    pm.response.to.have.status(201);",
													"});",
													"",
													"const jsonData = pm.response.json();",
													"",
													"pm.test(\"PIIS consent ID exists\", () => {",
													"   pm.expect(jsonData).to.have.property('consentId');",
													"});",
													"",
													"pm.test(\"PIIS consent links exists\", () => {",
													"   pm.expect(jsonData._links).to.have.property('updatePsuAuthentication');",
													"   pm.expect(jsonData._links).to.have.property('status');",
													"   pm.expect(jsonData._links).to.have.property('scaStatus');",
													"});",
													"",
													"pm.globals.set(\"piis_consent_id\", jsonData.consentId);",
													"",
													"pm.test(\"Update PSU authentication link exists\", () => {",
													"    pm.expect(jsonData).to.have.property('_links');",
													"    const _links = jsonData._links;",
													"    ",
													"    var updatePsuAuthentication = _links.updatePsuAuthentication.href;",
													"",
													"    if (updatePsuAuthentication === undefined) {",
													"       pm.expect().fail();",
													"    }",
													"});",
													"",
													"pm.globals.set(\"updatePsuAuthentication\", jsonData._links.updatePsuAuthentication);"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"name": "Content-Type",
												"type": "text",
												"value": "application/json"
											},
											{
												"key": "X-Request-ID",
												"value": "{{x_request_id}}",
												"type": "text"
											},
											{
												"key": "TPP-Explicit-Authorisation-Preferred",
												"value": "true",
												"type": "text"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"account\": {\n    \"iban\": \"{{iban_none}}\",\n    \"currency\": \"EUR\"\n  },\n  \"cardNumber\": \"cardNumber\",\n  \"cardExpiryDate\": \"2030-10-10\",\n  \"cardInformation\": \"cardInformation\",\n  \"registrationInformation\": \"registrationInformation\"\n\n}",
											"options": {
												"raw": {}
											}
										},
										"url": {
											"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds",
											"protocol": "{{protocol}}",
											"host": [
												"{{url_xs2a}}"
											],
											"path": [
												"v2",
												"consents",
												"confirmation-of-funds"
											]
										}
									},
									"response": []
								},
								{
									"name": "4. Start the authorisation process for a consent",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "b13b33ef-c96f-4713-9a5f-0be777abecea",
												"exec": [
													"pm.test(\"Status code is 201\", () => {",
													"    pm.response.to.have.status(201);",
													"});",
													"",
													"const jsonData = pm.response.json();",
													"",
													"pm.test(\"Sca status is received\", () => {",
													"    pm.expect(jsonData.scaStatus).to.eql('received');",
													"});",
													"",
													"pm.test(\"updatePsuAuthentication link exists\", () => {",
													"    pm.expect(jsonData).to.have.property('_links');",
													"    const _links = jsonData._links;",
													"    ",
													"    pm.expect(_links).to.have.property('updatePsuAuthentication');",
													"});",
													"",
													"pm.globals.set(\"piis_authorisation_id\", jsonData.authorisationId);",
													""
												],
												"type": "text/javascript"
											}
										},
										{
											"listen": "prerequest",
											"script": {
												"id": "ce756217-0487-43a5-81ce-564ff7af90d3",
												"exec": [
													""
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "Accept",
												"value": "application/json"
											},
											{
												"key": "Content-Type",
												"value": "application/json"
											},
											{
												"key": "X-Request-ID",
												"value": "{{x_request_id}}"
											}
										],
										"body": {
											"mode": "raw",
											"raw": ""
										},
										"url": {
											"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds/{{piis_consent_id}}/authorisations",
											"protocol": "{{protocol}}",
											"host": [
												"{{url_xs2a}}"
											],
											"path": [
												"v2",
												"consents",
												"confirmation-of-funds",
												"{{piis_consent_id}}",
												"authorisations"
											]
										},
										"description": "Create an authorisation sub-resource and start the authorisation process of a consent.  The message might in addition transmit authentication and authorisation related data.  his method is iterated n times for a n times SCA authorisation in a  corporate context, each creating an own authorisation sub-endpoint for  the corresponding PSU authorising the consent.  The ASPSP might make the usage of this access method unnecessary,  since the related authorisation resource will be automatically created by  the ASPSP after the submission of the consent data with the first POST consents call.  The start authorisation process is a process which is needed for creating a new authorisation  or cancellation sub-resource.   This applies in the following scenarios:    * The ASPSP has indicated with an 'startAuthorisation' hyperlink in the preceding Payment      Initiation Response that an explicit start of the authorisation process is needed by the TPP.      The 'startAuthorisation' hyperlink can transport more information about data which needs to be      uploaded by using the extended forms.     * 'startAuthorisationWithPsuIdentfication',      * 'startAuthorisationWithPsuAuthentication'     * 'startAuthorisationWithAuthentciationMethodSelection'    * The related payment initiation cannot yet be executed since a multilevel SCA is mandated.   * The ASPSP has indicated with an 'startAuthorisation' hyperlink in the preceding      Payment Cancellation Response that an explicit start of the authorisation process is needed by the TPP.      The 'startAuthorisation' hyperlink can transport more information about data which needs to be uploaded      by using the extended forms as indicated above.   * The related payment cancellation request cannot be applied yet since a multilevel SCA is mandate for      executing the cancellation.   * The signing basket needs to be authorised yet. "
									},
									"response": []
								},
								{
									"name": "4. Update PSU Data for consents without psu id format error",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "3fc3c29b-b380-40b9-bf84-3271d884628a",
												"exec": [
													"pm.test(\"Status code is 400\", () => {",
													"    pm.response.to.have.status(400);",
													"});",
													"",
													"pm.test(\"Error code is FORMAT_ERROR\", () => {",
													"    const jsonData = pm.response.json();",
													"    const error = jsonData.tppMessages[0];",
													"    pm.expect(error.code).to.eql('FORMAT_ERROR');",
													"    pm.expect(error.text).to.eql('Please provide the PSU identification data');",
													"})"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "PUT",
										"header": [
											{
												"key": "Accept",
												"value": "application/json"
											},
											{
												"key": "Content-Type",
												"value": "application/json"
											},
											{
												"key": "X-Request-ID",
												"value": "{{x_request_id}}"
											}
										],
										"body": {
											"mode": "raw",
											"raw": ""
										},
										"url": {
											"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds/{{piis_consent_id}}/authorisations/{{piis_authorisation_id}}",
											"protocol": "{{protocol}}",
											"host": [
												"{{url_xs2a}}"
											],
											"path": [
												"v2",
												"consents",
												"confirmation-of-funds",
												"{{piis_consent_id}}",
												"authorisations",
												"{{piis_authorisation_id}}"
											]
										},
										"description": "This method update PSU data on the consents  resource if needed.  It may authorise a consent within the Embedded SCA Approach where needed.  Independently from the SCA Approach it supports e.g. the selection of  the authentication method and a non-SCA PSU authentication.  This methods updates PSU data on the cancellation authorisation resource if needed.   There are several possible Update PSU Data requests in the context of a consent request if needed,  which depends on the SCA approach:  * Redirect SCA Approach:   A specific Update PSU Data Request is applicable for      * the selection of authentication methods, before choosing the actual SCA approach. * Decoupled SCA Approach:   A specific Update PSU Data Request is only applicable for   * adding the PSU Identification, if not provided yet in the Payment Initiation Request or the Account Information Consent Request, or if no OAuth2 access token is used, or   * the selection of authentication methods. * Embedded SCA Approach:    The Update PSU Data Request might be used    * to add credentials as a first factor authentication data of the PSU and   * to select the authentication method and   * transaction authorisation.  The SCA Approach might depend on the chosen SCA method.  For that reason, the following possible Update PSU Data request can apply to all SCA approaches:  * Select an SCA method in case of several SCA methods are available for the customer.  There are the following request types on this access path:   * Update PSU Identification   * Update PSU Authentication   * Select PSU Autorization Method      WARNING: This method need a reduced header,      therefore many optional elements are not present.      Maybe in a later version the access path will change.   * Transaction Authorisation     WARNING: This method need a reduced header,      therefore many optional elements are not present.      Maybe in a later version the access path will change. "
									},
									"response": []
								}
							],
							"protocolProfileBehavior": {},
							"_postman_isSubFolder": true
						},
						{
							"name": "1. Enable PIIS consent support in ASPSP profile",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "b7491fa4-f6b6-4dd9-90bd-ce23f3c1dc60",
										"exec": [
											"pm.test(\"Status code is 200\", () => {",
											"    pm.response.to.have.status(200);",
											"});",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "PUT",
								"header": [
									{
										"key": "Content-Type",
										"name": "Content-Type",
										"value": "application/json",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"ais\": {\n        \"consentTypes\": {\n            \"bankOfferedConsentSupported\": false,\n            \"globalConsentSupported\": false,\n            \"availableAccountsConsentSupported\": true,\n            \"accountAccessFrequencyPerDay\": 4,\n            \"notConfirmedConsentExpirationTimeMs\": 86400000,\n            \"maxConsentValidityDays\": 0\n        },\n        \"redirectLinkToOnlineBanking\": {\n            \"aisRedirectUrlToAspsp\": \"http://localhost:4200/ais/{redirect-id}/{encrypted-consent-id}\"\n        },\n        \"transactionParameters\": {\n            \"availableBookingStatuses\": [\n                \"BOOKED\",\n                \"PENDING\"\n            ],\n            \"transactionsWithoutBalancesSupported\": false,\n            \"supportedTransactionApplicationTypes\": [\n            \t\"application/json\"\n            ]\n        },\n        \"deltaReportSettings\": {\n            \"entryReferenceFromSupported\": false,\n            \"deltaListSupported\": false\n        },\n        \"scaRequirementsForOneTimeConsents\": {\n            \"scaByOneTimeAvailableAccountsConsentRequired\": true,\n            \"scaByOneTimeGlobalConsentRequired\": true\n        }\n    },\n    \"pis\": {\n        \"supportedPaymentTypeAndProductMatrix\": {\n            \"payments\": [\n                \"sepa-credit-transfers\",\n                \"instant-sepa-credit-transfers\"\n            ]\n        },\n        \"maxTransactionValidityDays\": 0,\n        \"notConfirmedPaymentExpirationTimeMs\": 86400000,\n        \"paymentCancellationAuthorisationMandated\": false,\n        \"redirectLinkToOnlineBanking\": {\n            \"pisRedirectUrlToAspsp\": \"http://localhost:4200/pis/{redirect-id}/{encrypted-payment-id}\",\n            \"pisPaymentCancellationRedirectUrlToAspsp\": \"http://localhost:4200/pis/cancellation/{redirect-id}/{encrypted-payment-id}\",\n            \"paymentCancellationRedirectUrlExpirationTimeMs\": 600000\n        }\n    },\n    \"piis\": {\n        \"piisConsentSupported\": \"ASPSP_CONSENT_SUPPORTED\"\n    },\n    \"common\": {\n        \"scaRedirectFlow\": \"REDIRECT\",\n        \"startAuthorisationMode\": \"auto\",\n        \"tppSignatureRequired\": false,\n        \"psuInInitialRequestMandated\": false,\n        \"redirectUrlExpirationTimeMs\": 600000,\n        \"authorisationExpirationTimeMs\": 86400000,\n        \"forceXs2aBaseLinksUrl\": false,\n        \"xs2aBaseLinksUrl\": \"http://myhost.com/\",\n        \"supportedAccountReferenceFields\": [\n            \"IBAN\"\n        ],\n        \"multicurrencyAccountLevelSupported\": \"SUBACCOUNT\",\n        \"aisPisSessionsSupported\": false,\n        \"signingBasketSupported\": false,\n        \"aspspNotificationsSupported\": [\n        \t\"NONE\"\t\n        ]\n    }\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{protocol}}://{{url_aspsp_profile}}/api/v1/aspsp-profile/for-debug/aspsp-settings",
									"protocol": "{{protocol}}",
									"host": [
										"{{url_aspsp_profile}}"
									],
									"path": [
										"api",
										"v1",
										"aspsp-profile",
										"for-debug",
										"aspsp-settings"
									]
								}
							},
							"response": []
						},
						{
							"name": "2. Create PIIS consent in XS2A",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "a64ce890-c849-4768-a43e-046e9394cdf1",
										"exec": [
											"pm.test(\"Status code is 405\", () => {",
											"    pm.response.to.have.status(405);",
											"});",
											"",
											"const jsonData = pm.response.json();",
											"",
											"pm.test('TppMessages and error are exist', () => {",
											"    ",
											"    pm.expect(jsonData).to.have.property('tppMessages');",
											"    ",
											"    var error = jsonData.tppMessages[0];",
											"       ",
											"    pm.expect(error).to.have.property('category');",
											"    pm.expect(error).to.have.property('code');",
											"    pm.expect(error).to.have.property('text');",
											"       ",
											"    pm.expect(error.category).to.eql('ERROR');",
											"    pm.expect(error.code).to.eql('SERVICE_INVALID');",
											"    pm.expect(error.text).to.eql('The addressed service is not valid for the addressed resources or the submitted data');",
											"    ",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "psu-id",
										"type": "text",
										"value": "{{psu_id_none}}"
									},
									{
										"key": "Content-Type",
										"name": "Content-Type",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "X-Request-ID",
										"value": "{{x_request_id}}",
										"type": "text"
									},
									{
										"key": "TPP-Explicit-Authorisation-Preferred",
										"value": "true",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"account\": {\n    \"iban\": \"{{iban_none}}\",\n    \"currency\": \"EUR\"\n  },\n  \"cardNumber\": \"cardNumber\",\n  \"cardExpiryDate\": \"2030-10-10\",\n  \"cardInformation\": \"cardInformation\",\n  \"registrationInformation\": \"registrationInformation\"\n\n}",
									"options": {
										"raw": {}
									}
								},
								"url": {
									"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds",
									"protocol": "{{protocol}}",
									"host": [
										"{{url_xs2a}}"
									],
									"path": [
										"v2",
										"consents",
										"confirmation-of-funds"
									]
								}
							},
							"response": []
						}
					],
					"protocolProfileBehavior": {},
					"_postman_isSubFolder": true
				},
				{
					"name": "Successful requests",
					"item": [
						{
							"name": "Redirect",
							"item": [
								{
									"name": "Implicit",
									"item": [
										{
											"name": "1. Set redirect SCA approach",
											"event": [
												{
													"listen": "test",
													"script": {
														"id": "2acf3814-b361-40de-8070-6a1e545cf5ea",
														"exec": [
															"pm.test(\"Status code is 200\", () => {",
															"    pm.response.to.have.status(200);",
															"});",
															""
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"method": "PUT",
												"header": [
													{
														"key": "Content-Type",
														"name": "Content-Type",
														"type": "text",
														"value": "application/json"
													}
												],
												"body": {
													"mode": "raw",
													"raw": "[\n  \"REDIRECT\",\n  \"EMBEDDED\",\n  \"DECOUPLED\"\n]"
												},
												"url": {
													"raw": "{{protocol}}://{{url_aspsp_profile}}/api/v1/aspsp-profile/for-debug/sca-approaches",
													"protocol": "{{protocol}}",
													"host": [
														"{{url_aspsp_profile}}"
													],
													"path": [
														"api",
														"v1",
														"aspsp-profile",
														"for-debug",
														"sca-approaches"
													]
												}
											},
											"response": []
										},
										{
											"name": "2. Enable PIIS consent support in ASPSP profile",
											"event": [
												{
													"listen": "test",
													"script": {
														"id": "38cc3917-43e4-4765-a742-adedda1b93b7",
														"exec": [
															"pm.test(\"Status code is 200\", () => {",
															"    pm.response.to.have.status(200);",
															"});",
															""
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"method": "PUT",
												"header": [
													{
														"key": "Content-Type",
														"name": "Content-Type",
														"type": "text",
														"value": "application/json"
													}
												],
												"body": {
													"mode": "raw",
													"raw": "{\n    \"ais\": {\n        \"consentTypes\": {\n            \"bankOfferedConsentSupported\": false,\n            \"globalConsentSupported\": false,\n            \"availableAccountsConsentSupported\": true,\n            \"accountAccessFrequencyPerDay\": 4,\n            \"notConfirmedConsentExpirationTimeMs\": 86400000,\n            \"maxConsentValidityDays\": 0\n        },\n        \"redirectLinkToOnlineBanking\": {\n            \"aisRedirectUrlToAspsp\": \"http://localhost:4200/ais/{redirect-id}/{encrypted-consent-id}\"\n        },\n        \"transactionParameters\": {\n            \"availableBookingStatuses\": [\n                \"BOOKED\",\n                \"PENDING\"\n            ],\n            \"transactionsWithoutBalancesSupported\": false,\n            \"supportedTransactionApplicationTypes\": [\n                \"application/json\"\n            ]\n        },\n        \"deltaReportSettings\": {\n            \"entryReferenceFromSupported\": false,\n            \"deltaListSupported\": false\n        },\n        \"scaRequirementsForOneTimeConsents\": {\n            \"scaByOneTimeAvailableAccountsConsentRequired\": true,\n            \"scaByOneTimeGlobalConsentRequired\": true\n        }\n    },\n    \"pis\": {\n        \"supportedPaymentTypeAndProductMatrix\": {\n            \"payments\": [\n                \"sepa-credit-transfers\",\n                \"instant-sepa-credit-transfers\"\n            ]\n        },\n        \"maxTransactionValidityDays\": 0,\n        \"notConfirmedPaymentExpirationTimeMs\": 86400000,\n        \"paymentCancellationAuthorisationMandated\": false,\n        \"redirectLinkToOnlineBanking\": {\n            \"pisRedirectUrlToAspsp\": \"http://localhost:4200/pis/{redirect-id}/{encrypted-payment-id}\",\n            \"pisPaymentCancellationRedirectUrlToAspsp\": \"http://localhost:4200/pis/cancellation/{redirect-id}/{encrypted-payment-id}\",\n            \"paymentCancellationRedirectUrlExpirationTimeMs\": 600000\n        }\n    },\n    \"piis\": {\n        \"piisConsentSupported\": \"TPP_CONSENT_SUPPORTED\",\n        \"redirectLinkToOnlineBanking\": {\n            \"piisRedirectUrlToAspsp\": \"http://localhost:4200/piis/{redirect-id}/{encrypted-consent-id}\"\n        }\n    },\n    \"common\": {\n        \"scaRedirectFlow\": \"REDIRECT\",\n        \"startAuthorisationMode\": \"auto\",\n        \"tppSignatureRequired\": false,\n        \"psuInInitialRequestMandated\": false,\n        \"redirectUrlExpirationTimeMs\": 600000,\n        \"authorisationExpirationTimeMs\": 86400000,\n        \"forceXs2aBaseLinksUrl\": false,\n        \"xs2aBaseLinksUrl\": \"http://myhost.com/\",\n        \"supportedAccountReferenceFields\": [\n            \"IBAN\"\n        ],\n        \"multicurrencyAccountLevelSupported\": \"SUBACCOUNT\",\n        \"aisPisSessionsSupported\": false,\n        \"signingBasketSupported\": false,\n        \"aspspNotificationsSupported\": [\n            \"NONE\"\n        ]\n    }\n}",
													"options": {
														"raw": {
															"language": "json"
														}
													}
												},
												"url": {
													"raw": "{{protocol}}://{{url_aspsp_profile}}/api/v1/aspsp-profile/for-debug/aspsp-settings",
													"protocol": "{{protocol}}",
													"host": [
														"{{url_aspsp_profile}}"
													],
													"path": [
														"api",
														"v1",
														"aspsp-profile",
														"for-debug",
														"aspsp-settings"
													]
												}
											},
											"response": []
										},
										{
											"name": "3. Create PIIS consent in XS2A",
											"event": [
												{
													"listen": "test",
													"script": {
														"id": "1d66d963-d19c-4212-9538-b24d64a8bd4f",
														"exec": [
															"pm.test(\"Status code is 201\", () => {",
															"    pm.response.to.have.status(201);",
															"});",
															"",
															"const jsonData = pm.response.json();",
															"",
															"pm.test(\"PIIS consent ID exists\", () => {",
															"   pm.expect(jsonData).to.have.property('consentId');",
															"});",
															"",
															"pm.globals.set(\"piis_consent_id\", jsonData.consentId);",
															"",
															"const scaRedirectLink = jsonData._links.scaRedirect.href;",
															"",
															"if (scaRedirectLink !== undefined) {",
															"    var a = scaRedirectLink.split('/');",
															"    a.pop();",
															"    const authorisationId = a.pop();",
															"    pm.globals.set(\"authorisation_id\", authorisationId);",
															"}",
															"",
															"const scaStatusParts = jsonData._links.scaStatus.href.split('/');",
															"const redirectId = scaStatusParts.pop() || scaStatusParts.pop();",
															"pm.globals.set(\"redirect_id\", redirectId);"
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"method": "POST",
												"header": [
													{
														"key": "psu-id",
														"value": "{{psu_id_none}}",
														"type": "text"
													},
													{
														"key": "Content-Type",
														"value": "application/json",
														"type": "text"
													},
													{
														"key": "X-Request-ID",
														"value": "{{x_request_id}}",
														"type": "text"
													},
													{
														"key": "TPP-Explicit-Authorisation-Preferred",
														"value": "true",
														"type": "text"
													},
													{
														"key": "TPP-Redirect-URI",
														"value": "TPP-Redirect-URI",
														"type": "text"
													},
													{
														"key": "TPP-Nok-Redirect-URI",
														"value": "TPP-Nok-Redirect-URI",
														"type": "text"
													}
												],
												"body": {
													"mode": "raw",
													"raw": "{\n  \"account\": {\n    \"iban\": \"{{iban_none}}\",\n    \"currency\": \"EUR\"\n  },\n  \"cardNumber\": \"cardNumber\",\n  \"cardExpiryDate\": \"2030-10-10\",\n  \"cardInformation\": \"cardInformation\",\n  \"registrationInformation\": \"registrationInformation\"\n\n}",
													"options": {
														"raw": {}
													}
												},
												"url": {
													"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds",
													"protocol": "{{protocol}}",
													"host": [
														"{{url_xs2a}}"
													],
													"path": [
														"v2",
														"consents",
														"confirmation-of-funds"
													]
												}
											},
											"response": []
										},
										{
											"name": "4. Get PIIS consent in XS2A",
											"event": [
												{
													"listen": "test",
													"script": {
														"id": "6f352709-44ae-4d08-b3c4-2004cade15d6",
														"exec": [
															"pm.test(\"Status code is 200\", () => {",
															"    pm.response.to.have.status(200);",
															"});",
															"",
															"const jsonData = pm.response.json();",
															"",
															"pm.test(\"Account is present\", () => {",
															"   pm.expect(jsonData).to.have.property('account');",
															"});"
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"auth": {
													"type": "bearer",
													"bearer": [
														{
															"key": "token",
															"value": "{{ledgersBearerToken}}",
															"type": "string"
														}
													]
												},
												"method": "GET",
												"header": [
													{
														"key": "X-Request-ID",
														"value": "{{x_request_id}}",
														"type": "text"
													}
												],
												"url": {
													"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds/{{piis_consent_id}}",
													"protocol": "{{protocol}}",
													"host": [
														"{{url_xs2a}}"
													],
													"path": [
														"v2",
														"consents",
														"confirmation-of-funds",
														"{{piis_consent_id}}"
													]
												}
											},
											"response": []
										},
										{
											"name": "5. Get PIIS consent status in XS2A",
											"event": [
												{
													"listen": "test",
													"script": {
														"id": "41185aa5-27bd-4281-a518-eaa61e429da1",
														"exec": [
															"pm.test(\"Status code is 200\", () => {",
															"    pm.response.to.have.status(200);",
															"});",
															"",
															"const jsonData = pm.response.json();",
															"",
															"pm.test(\"ConsentStatus is present\", () => {",
															"   pm.expect(jsonData).to.have.property('consentStatus');",
															"});",
															""
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"auth": {
													"type": "bearer",
													"bearer": [
														{
															"key": "token",
															"value": "{{ledgersBearerToken}}",
															"type": "string"
														}
													]
												},
												"method": "GET",
												"header": [
													{
														"key": "X-Request-ID",
														"type": "text",
														"value": "{{x_request_id}}"
													}
												],
												"url": {
													"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds/{{piis_consent_id}}/status",
													"protocol": "{{protocol}}",
													"host": [
														"{{url_xs2a}}"
													],
													"path": [
														"v2",
														"consents",
														"confirmation-of-funds",
														"{{piis_consent_id}}",
														"status"
													]
												}
											},
											"response": []
										},
										{
											"name": "7. Read the SCA status of the consent authorisation",
											"event": [
												{
													"listen": "test",
													"script": {
														"id": "654013c6-a463-43a2-a542-f50b55e1aef3",
														"exec": [
															"pm.test(\"Status code is 200\", () => {",
															"    pm.response.to.have.status(200);",
															"});"
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"method": "GET",
												"header": [
													{
														"key": "Accept",
														"value": "application/json"
													},
													{
														"key": "X-Request-ID",
														"value": "{{x_request_id}}"
													}
												],
												"url": {
													"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds/{{consent_id}}/authorisations/{{authorisation_id}}",
													"protocol": "{{protocol}}",
													"host": [
														"{{url_xs2a}}"
													],
													"path": [
														"v2",
														"consents",
														"confirmation-of-funds",
														"{{consent_id}}",
														"authorisations",
														"{{authorisation_id}}"
													]
												},
												"description": "This method returns the SCA status of a consent initiation's authorisation sub-resource. "
											},
											"response": []
										},
										{
											"name": "8.  Get consent authorisation sub-resources request",
											"event": [
												{
													"listen": "test",
													"script": {
														"id": "1d5202ea-8eba-4ead-a161-6f5575b3f0a4",
														"exec": [
															"pm.test(\"Status code is 200\", () => {",
															"    pm.response.to.have.status(200);",
															"});"
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"method": "GET",
												"header": [
													{
														"key": "Accept",
														"value": "application/json"
													},
													{
														"key": "X-Request-ID",
														"value": "{{x_request_id}}"
													}
												],
												"url": {
													"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds/{{consent_id}}/authorisations/",
													"protocol": "{{protocol}}",
													"host": [
														"{{url_xs2a}}"
													],
													"path": [
														"v2",
														"consents",
														"confirmation-of-funds",
														"{{consent_id}}",
														"authorisations",
														""
													]
												},
												"description": "This method returns the SCA status of a consent initiation's authorisation sub-resource. "
											},
											"response": []
										},
										{
											"name": "9. Get consent response object by redirect id",
											"event": [
												{
													"listen": "test",
													"script": {
														"id": "47011aca-f47c-4d57-a78d-5822a5792d14",
														"exec": [
															"pm.test(\"Status code is 200\", () => {",
															"    pm.response.to.have.status(200);",
															"});",
															"",
															"const jsonData = pm.response.json();",
															"",
															"pm.test(\"Authorisation id is present\", () => {",
															"    pm.expect(jsonData).to.have.property(\"authorisationId\");",
															"});",
															"",
															"pm.test(\"Redirect URLs are present\", () => {",
															"    pm.expect(jsonData).to.have.property(\"tppOkRedirectUri\");",
															"    pm.expect(jsonData).to.have.property(\"tppNokRedirectUri\");",
															"});",
															"",
															"const authorisationId = jsonData.authorisationId;",
															"pm.test(\"Authorisation id is correct\", () => {",
															"    pm.expect(authorisationId).to.eql(pm.globals.get(\"redirect_id\"));",
															"});",
															"",
															"pm.test(\"Consent id is present\", () => {",
															"    pm.expect(jsonData.consent).to.have.property(\"id\");",
															"});",
															"",
															"pm.globals.set(\"internal_consent_id\", jsonData.consent.id);",
															"pm.globals.set(\"authorisation_id\", authorisationId);"
														],
														"type": "text/javascript"
													}
												},
												{
													"listen": "prerequest",
													"script": {
														"id": "70572017-5596-4bbe-b20d-61d123ee97dc",
														"exec": [
															"pm.globals.unset(\"internal_consent_id\");",
															"pm.globals.unset(\"authorisation_id\");"
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"method": "GET",
												"header": [],
												"url": {
													"raw": "{{protocol}}://{{url_cms}}/psu-api/v2/piis/consent/redirect/{{redirect_id}}",
													"protocol": "{{protocol}}",
													"host": [
														"{{url_cms}}"
													],
													"path": [
														"psu-api",
														"v2",
														"piis",
														"consent",
														"redirect",
														"{{redirect_id}}"
													]
												}
											},
											"response": []
										}
									],
									"protocolProfileBehavior": {},
									"_postman_isSubFolder": true
								},
								{
									"name": "Explicit Multilevel",
									"item": [
										{
											"name": "Create Consent",
											"item": [
												{
													"name": "1. Set redirect SCA approach",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "0ab8c34c-36a8-4ba9-ab5d-4b55f0548eb1",
																"exec": [
																	"pm.test(\"Status code is 200\", () => {",
																	"    pm.response.to.have.status(200);",
																	"});",
																	""
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "PUT",
														"header": [
															{
																"key": "Content-Type",
																"name": "Content-Type",
																"type": "text",
																"value": "application/json"
															}
														],
														"body": {
															"mode": "raw",
															"raw": "[\n  \"REDIRECT\",\n  \"EMBEDDED\",\n  \"DECOUPLED\"\n]"
														},
														"url": {
															"raw": "{{protocol}}://{{url_aspsp_profile}}/api/v1/aspsp-profile/for-debug/sca-approaches",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_aspsp_profile}}"
															],
															"path": [
																"api",
																"v1",
																"aspsp-profile",
																"for-debug",
																"sca-approaches"
															]
														}
													},
													"response": []
												},
												{
													"name": "2. Enable PIIS consent support in ASPSP profile",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "a9577765-a200-46ce-bda2-03f7dada5193",
																"exec": [
																	"pm.test(\"Status code is 200\", () => {",
																	"    pm.response.to.have.status(200);",
																	"});",
																	""
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "PUT",
														"header": [
															{
																"key": "Content-Type",
																"name": "Content-Type",
																"type": "text",
																"value": "application/json"
															}
														],
														"body": {
															"mode": "raw",
															"raw": "{\n    \"ais\": {\n        \"consentTypes\": {\n            \"bankOfferedConsentSupported\": false,\n            \"globalConsentSupported\": false,\n            \"availableAccountsConsentSupported\": true,\n            \"accountAccessFrequencyPerDay\": 4,\n            \"notConfirmedConsentExpirationTimeMs\": 86400000,\n            \"maxConsentValidityDays\": 0\n        },\n        \"redirectLinkToOnlineBanking\": {\n            \"aisRedirectUrlToAspsp\": \"http://localhost:4200/ais/{redirect-id}/{encrypted-consent-id}\"\n        },\n        \"transactionParameters\": {\n            \"availableBookingStatuses\": [\n                \"BOOKED\",\n                \"PENDING\"\n            ],\n            \"transactionsWithoutBalancesSupported\": false,\n            \"supportedTransactionApplicationTypes\": [\n                \"application/json\"\n            ]\n        },\n        \"deltaReportSettings\": {\n            \"entryReferenceFromSupported\": false,\n            \"deltaListSupported\": false\n        },\n        \"scaRequirementsForOneTimeConsents\": {\n            \"scaByOneTimeAvailableAccountsConsentRequired\": true,\n            \"scaByOneTimeGlobalConsentRequired\": true\n        }\n    },\n    \"pis\": {\n        \"supportedPaymentTypeAndProductMatrix\": {\n            \"payments\": [\n                \"sepa-credit-transfers\",\n                \"instant-sepa-credit-transfers\"\n            ]\n        },\n        \"maxTransactionValidityDays\": 0,\n        \"notConfirmedPaymentExpirationTimeMs\": 86400000,\n        \"paymentCancellationAuthorisationMandated\": false,\n        \"redirectLinkToOnlineBanking\": {\n            \"pisRedirectUrlToAspsp\": \"http://localhost:4200/pis/{redirect-id}/{encrypted-payment-id}\",\n            \"pisPaymentCancellationRedirectUrlToAspsp\": \"http://localhost:4200/pis/cancellation/{redirect-id}/{encrypted-payment-id}\",\n            \"paymentCancellationRedirectUrlExpirationTimeMs\": 600000\n        }\n    },\n    \"piis\": {\n        \"piisConsentSupported\": \"TPP_CONSENT_SUPPORTED\",\n        \"redirectLinkToOnlineBanking\": {\n            \"piisRedirectUrlToAspsp\": \"http://localhost:4200/piis/{redirect-id}/{encrypted-consent-id}\"\n        }\n    },\n    \"common\": {\n        \"scaRedirectFlow\": \"REDIRECT\",\n        \"startAuthorisationMode\": \"auto\",\n        \"tppSignatureRequired\": false,\n        \"psuInInitialRequestMandated\": false,\n        \"redirectUrlExpirationTimeMs\": 600000,\n        \"authorisationExpirationTimeMs\": 86400000,\n        \"forceXs2aBaseLinksUrl\": false,\n        \"xs2aBaseLinksUrl\": \"http://myhost.com/\",\n        \"supportedAccountReferenceFields\": [\n            \"IBAN\"\n        ],\n        \"multicurrencyAccountLevelSupported\": \"SUBACCOUNT\",\n        \"aisPisSessionsSupported\": false,\n        \"signingBasketSupported\": true,\n        \"aspspNotificationsSupported\": [\n            \"NONE\"\n        ]\n    }\n}",
															"options": {
																"raw": {
																	"language": "json"
																}
															}
														},
														"url": {
															"raw": "{{protocol}}://{{url_aspsp_profile}}/api/v1/aspsp-profile/for-debug/aspsp-settings",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_aspsp_profile}}"
															],
															"path": [
																"api",
																"v1",
																"aspsp-profile",
																"for-debug",
																"aspsp-settings"
															]
														}
													},
													"response": []
												},
												{
													"name": "3. Create PIIS consent in XS2A",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "18345e1d-db21-4a77-bd02-62e733f82b7b",
																"exec": [
																	"pm.test(\"Status code is 201\", () => {",
																	"    pm.response.to.have.status(201);",
																	"});",
																	"",
																	"const jsonData = pm.response.json();",
																	"",
																	"pm.test(\"PIIS consent ID exists\", () => {",
																	"   pm.expect(jsonData).to.have.property('consentId');",
																	"});",
																	"",
																	"pm.globals.set(\"piis_consent_id\", jsonData.consentId);",
																	"",
																	"pm.test(\"startAuthorisation link exists\", () => {",
																	"    pm.expect(jsonData).to.have.property('_links');",
																	"    const _links = jsonData._links;",
																	"    ",
																	"    var startAuthorisation = _links.startAuthorisation.href;",
																	"",
																	"    if (startAuthorisation === undefined) {",
																	"       pm.expect().fail();",
																	"    }",
																	"});",
																	"",
																	"pm.test(\"Consent status is received\", () => {",
																	"    pm.expect(jsonData.consentStatus).to.eql('received');",
																	"});"
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "POST",
														"header": [
															{
																"key": "psu-id",
																"type": "text",
																"value": "{{psu_id_multilevel_1}}"
															},
															{
																"key": "Content-Type",
																"type": "text",
																"value": "application/json"
															},
															{
																"key": "X-Request-ID",
																"type": "text",
																"value": "{{x_request_id}}"
															},
															{
																"key": "TPP-Explicit-Authorisation-Preferred",
																"type": "text",
																"value": "true",
																"disabled": true
															},
															{
																"key": "TPP-Redirect-URI",
																"type": "text",
																"value": "TPP-Redirect-URI"
															},
															{
																"key": "TPP-Nok-Redirect-URI",
																"type": "text",
																"value": "TPP-Nok-Redirect-URI"
															}
														],
														"body": {
															"mode": "raw",
															"raw": "{\n  \"account\": {\n    \"iban\": \"{{iban_multilevel}}\",\n    \"currency\": \"EUR\"\n  },\n  \"cardNumber\": \"cardNumber\",\n  \"cardExpiryDate\": \"2030-10-10\",\n  \"cardInformation\": \"cardInformation\",\n  \"registrationInformation\": \"registrationInformation\"\n\n}",
															"options": {
																"raw": {}
															}
														},
														"url": {
															"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_xs2a}}"
															],
															"path": [
																"v2",
																"consents",
																"confirmation-of-funds"
															]
														}
													},
													"response": []
												}
											],
											"protocolProfileBehavior": {},
											"_postman_isSubFolder": true
										},
										{
											"name": "Start and finilised authorisation (USER 1)",
											"item": [
												{
													"name": "4. Start the authorisation process for a consent",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "b3f2e350-82ff-4cdc-9a60-c860c2e1a01b",
																"exec": [
																	"pm.test(\"Status code is 201\", () => {",
																	"    pm.response.to.have.status(201);",
																	"});",
																	"",
																	"const jsonData = pm.response.json();",
																	"",
																	"pm.test(\"Sca status is psuIdentified\", () => {",
																	"    pm.expect(jsonData.scaStatus).to.eql('psuIdentified');",
																	"});",
																	"",
																	"pm.test(\"scaRedirect link exists\", () => {",
																	"    pm.expect(jsonData).to.have.property('_links');",
																	"    const _links = jsonData._links;",
																	"    ",
																	"    pm.expect(_links).to.have.property('scaRedirect');",
																	"});",
																	"",
																	"// splits string link by '/' to array and gets the last element - authorisationId",
																	"// e.g. \"http://localhost:8080/v1/consents/d917f39f-6308-4f81-9b51-bfbd8bc934c6/authorisations/554fda7d-bc70-44da-8670-15e299f817a6\"",
																	"      // needs to get 554fda7d-bc70-44da-8670-15e299f817a6 value",
																	"",
																	"    var a = jsonData._links.scaRedirect.href.split('/');",
																	"    a.pop();",
																	"    const authorisationId = a.pop();",
																	"",
																	"pm.globals.set(\"authorisation_id\", authorisationId);",
																	"pm.globals.set(\"redirect_id\", authorisationId);",
																	""
																],
																"type": "text/javascript"
															}
														},
														{
															"listen": "prerequest",
															"script": {
																"id": "62f188f9-7209-450e-9a47-c560ad2b2fe3",
																"exec": [
																	""
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "POST",
														"header": [
															{
																"key": "Accept",
																"value": "application/json"
															},
															{
																"key": "Content-Type",
																"value": "application/json"
															},
															{
																"key": "PSU-ID",
																"value": "{{psu_id_multilevel_1}}"
															},
															{
																"key": "X-Request-ID",
																"value": "{{x_request_id}}"
															}
														],
														"body": {
															"mode": "raw",
															"raw": ""
														},
														"url": {
															"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds/{{piis_consent_id}}/authorisations",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_xs2a}}"
															],
															"path": [
																"v2",
																"consents",
																"confirmation-of-funds",
																"{{piis_consent_id}}",
																"authorisations"
															]
														},
														"description": "Create an authorisation sub-resource and start the authorisation process of a consent.  The message might in addition transmit authentication and authorisation related data.  his method is iterated n times for a n times SCA authorisation in a  corporate context, each creating an own authorisation sub-endpoint for  the corresponding PSU authorising the consent.  The ASPSP might make the usage of this access method unnecessary,  since the related authorisation resource will be automatically created by  the ASPSP after the submission of the consent data with the first POST consents call.  The start authorisation process is a process which is needed for creating a new authorisation  or cancellation sub-resource.   This applies in the following scenarios:    * The ASPSP has indicated with an 'startAuthorisation' hyperlink in the preceding Payment      Initiation Response that an explicit start of the authorisation process is needed by the TPP.      The 'startAuthorisation' hyperlink can transport more information about data which needs to be      uploaded by using the extended forms.     * 'startAuthorisationWithPsuIdentfication',      * 'startAuthorisationWithPsuAuthentication'     * 'startAuthorisationWithAuthentciationMethodSelection'    * The related payment initiation cannot yet be executed since a multilevel SCA is mandated.   * The ASPSP has indicated with an 'startAuthorisation' hyperlink in the preceding      Payment Cancellation Response that an explicit start of the authorisation process is needed by the TPP.      The 'startAuthorisation' hyperlink can transport more information about data which needs to be uploaded      by using the extended forms as indicated above.   * The related payment cancellation request cannot be applied yet since a multilevel SCA is mandate for      executing the cancellation.   * The signing basket needs to be authorised yet. "
													},
													"response": []
												},
												{
													"name": "5. Get consent response object by redirect id",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "e2efa644-f31f-4ecf-9c55-1f17aa003e21",
																"exec": [
																	"pm.test(\"Status code is 200\", () => {",
																	"    pm.response.to.have.status(200);",
																	"});",
																	"",
																	"const jsonData = pm.response.json();",
																	"",
																	"pm.test(\"Authorisation id is present\", () => {",
																	"    pm.expect(jsonData).to.have.property(\"authorisationId\");",
																	"});",
																	"",
																	"pm.test(\"Redirect URLs are present\", () => {",
																	"    pm.expect(jsonData).to.have.property(\"tppOkRedirectUri\");",
																	"    pm.expect(jsonData).to.have.property(\"tppNokRedirectUri\");",
																	"});",
																	"",
																	"const authorisationId = jsonData.authorisationId;",
																	"pm.test(\"Authorisation id is correct\", () => {",
																	"    pm.expect(authorisationId).to.eql(pm.globals.get(\"redirect_id\"));",
																	"});",
																	"",
																	"pm.test(\"Consent id is present\", () => {",
																	"    pm.expect(jsonData.consent).to.have.property(\"id\");",
																	"});",
																	"",
																	"pm.globals.set(\"internal_consent_id\", jsonData.consent.id);",
																	"pm.globals.set(\"authorisation_id\", authorisationId);"
																],
																"type": "text/javascript"
															}
														},
														{
															"listen": "prerequest",
															"script": {
																"id": "a9db51e7-fd6b-48c0-ba56-3fa4d7a2f58a",
																"exec": [
																	"pm.globals.unset(\"internal_consent_id\");",
																	"pm.globals.unset(\"authorisation_id\");"
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "GET",
														"header": [],
														"url": {
															"raw": "{{protocol}}://{{url_cms}}/psu-api/v2/piis/consent/redirect/{{redirect_id}}",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_cms}}"
															],
															"path": [
																"psu-api",
																"v2",
																"piis",
																"consent",
																"redirect",
																"{{redirect_id}}"
															]
														}
													},
													"response": []
												},
												{
													"name": "6. Update PSU Data in PIIS consent",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "9a59d094-9c41-4235-b490-8c5333622bf5",
																"exec": [
																	"pm.test(\"Status code is 200\", () => {",
																	"    pm.response.to.have.status(200);",
																	"});"
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "PUT",
														"header": [
															{
																"key": "Content-Type",
																"name": "Content-Type",
																"type": "text",
																"value": "application/json"
															}
														],
														"body": {
															"mode": "raw",
															"raw": "{\n  \"psuId\": \"{{psu_id_multilevel_1}}\",\n  \"psuIdType\": \"psuIdType\",\n  \"psuCorporateId\": \"psuCorporateId\",\n  \"psuCorporateIdType\": \"psuCorporateIdType\",\n  \"psuIpAddress\": \"1.1.1.1\"\n}"
														},
														"url": {
															"raw": "{{protocol}}://{{url_cms}}/psu-api/v2/piis/consent/{{internal_consent_id}}/authorisation/{{authorisation_id}}/psu-data",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_cms}}"
															],
															"path": [
																"psu-api",
																"v2",
																"piis",
																"consent",
																"{{internal_consent_id}}",
																"authorisation",
																"{{authorisation_id}}",
																"psu-data"
															]
														}
													},
													"response": []
												},
												{
													"name": "7. Update a status of PIIS consent authorisation",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "e03aefed-bacf-4153-899b-4b269ef578d3",
																"exec": [
																	"pm.test(\"Status code is 200\", () => {",
																	"    pm.response.to.have.status(200);",
																	"});"
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "PUT",
														"header": [
															{
																"key": "PSU-ID",
																"value": "{{psu_id_multilevel_1}}",
																"type": "text"
															}
														],
														"body": {
															"mode": "raw",
															"raw": ""
														},
														"url": {
															"raw": "{{protocol}}://{{url_cms}}/psu-api/v2/piis/consent/{{internal_consent_id}}/authorisation/{{authorisation_id}}/status/FINALISED",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_cms}}"
															],
															"path": [
																"psu-api",
																"v2",
																"piis",
																"consent",
																"{{internal_consent_id}}",
																"authorisation",
																"{{authorisation_id}}",
																"status",
																"FINALISED"
															]
														}
													},
													"response": []
												},
												{
													"name": "8.  Get Confirmation of Funds Consent Authorisation by its ID",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "54262ffe-8eae-434d-92c2-2fafe1b04437",
																"exec": [
																	"pm.test(\"Status code is 200\", () => {",
																	"    pm.response.to.have.status(200);",
																	"});",
																	"",
																	"const jsonData = pm.response.json();",
																	"",
																	"pm.test(\"Authorisation id is present\", () => {",
																	"    pm.expect(jsonData).to.have.property(\"authorisationId\");",
																	"});",
																	"",
																	"pm.test(\"Redirect URLs are present\", () => {",
																	"    pm.expect(jsonData).to.have.property(\"tppOkRedirectUri\");",
																	"    pm.expect(jsonData).to.have.property(\"tppNokRedirectUri\");",
																	"});",
																	"",
																	"const authorisationId = jsonData.authorisationId;",
																	"pm.test(\"Authorisation id is correct\", () => {",
																	"    pm.expect(authorisationId).to.eql(pm.globals.get(\"redirect_id\"));",
																	"});",
																	"",
																	"const scaStatus = jsonData.scaStatus;",
																	"pm.test(\"Authorisation is finalised\", () => {",
																	"    pm.expect(scaStatus).to.eql(\"finalised\");",
																	"});",
																	""
																],
																"type": "text/javascript"
															}
														},
														{
															"listen": "prerequest",
															"script": {
																"id": "afb9e3fa-5ba0-4e33-81d9-7f1df746c716",
																"exec": [
																	""
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "GET",
														"header": [],
														"url": {
															"raw": "{{protocol}}://{{url_cms}}/psu-api/v2/piis/consent/authorisation/{{authorisation_id}}",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_cms}}"
															],
															"path": [
																"psu-api",
																"v2",
																"piis",
																"consent",
																"authorisation",
																"{{authorisation_id}}"
															]
														}
													},
													"response": []
												},
												{
													"name": "9. Update a status of PIIS consent PATC",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "580a5c21-cb78-424b-b9aa-1ce7c448b789",
																"exec": [
																	"pm.test(\"Status code is 200\", () => {",
																	"    pm.response.to.have.status(200);",
																	"});"
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "PUT",
														"header": [
															{
																"key": "PSU-ID",
																"value": "{{psu_id_multilevel_1}}",
																"type": "text"
															}
														],
														"body": {
															"mode": "raw",
															"raw": ""
														},
														"url": {
															"raw": "{{protocol}}://{{url_cms}}/psu-api/v2/piis/consent/{{internal_consent_id}}/status/PARTIALLY_AUTHORISED",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_cms}}"
															],
															"path": [
																"psu-api",
																"v2",
																"piis",
																"consent",
																"{{internal_consent_id}}",
																"status",
																"PARTIALLY_AUTHORISED"
															]
														}
													},
													"response": []
												}
											],
											"protocolProfileBehavior": {},
											"_postman_isSubFolder": true
										},
										{
											"name": "Start and finilised authorisation (USER 2)",
											"item": [
												{
													"name": "10. Start the authorisation process for a consent",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "c02a0000-6dfc-4f40-af3d-13eca050d95c",
																"exec": [
																	"pm.test(\"Status code is 201\", () => {",
																	"    pm.response.to.have.status(201);",
																	"});",
																	"",
																	"const jsonData = pm.response.json();",
																	"",
																	"pm.test(\"Sca status is psuIdentified\", () => {",
																	"    pm.expect(jsonData.scaStatus).to.eql('psuIdentified');",
																	"});",
																	"",
																	"pm.test(\"scaRedirect link exists\", () => {",
																	"    pm.expect(jsonData).to.have.property('_links');",
																	"    const _links = jsonData._links;",
																	"    ",
																	"    pm.expect(_links).to.have.property('scaRedirect');",
																	"});",
																	"",
																	"// splits string link by '/' to array and gets the last element - authorisationId",
																	"// e.g. \"http://localhost:8080/v1/consents/d917f39f-6308-4f81-9b51-bfbd8bc934c6/authorisations/554fda7d-bc70-44da-8670-15e299f817a6\"",
																	"      // needs to get 554fda7d-bc70-44da-8670-15e299f817a6 value",
																	"",
																	"    var a = jsonData._links.scaRedirect.href.split('/');",
																	"    a.pop();",
																	"    const authorisationId = a.pop();",
																	"",
																	"pm.globals.set(\"authorisation_id\", authorisationId);",
																	"pm.globals.set(\"redirect_id\", authorisationId);",
																	""
																],
																"type": "text/javascript"
															}
														},
														{
															"listen": "prerequest",
															"script": {
																"id": "26fa0d28-50ab-43d9-84b3-9018362346b4",
																"exec": [
																	""
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "POST",
														"header": [
															{
																"key": "Accept",
																"value": "application/json"
															},
															{
																"key": "Content-Type",
																"value": "application/json"
															},
															{
																"key": "PSU-ID",
																"value": "{{psu_id_multilevel_2}}"
															},
															{
																"key": "X-Request-ID",
																"value": "{{x_request_id}}"
															}
														],
														"body": {
															"mode": "raw",
															"raw": ""
														},
														"url": {
															"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds/{{piis_consent_id}}/authorisations",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_xs2a}}"
															],
															"path": [
																"v2",
																"consents",
																"confirmation-of-funds",
																"{{piis_consent_id}}",
																"authorisations"
															]
														},
														"description": "Create an authorisation sub-resource and start the authorisation process of a consent.  The message might in addition transmit authentication and authorisation related data.  his method is iterated n times for a n times SCA authorisation in a  corporate context, each creating an own authorisation sub-endpoint for  the corresponding PSU authorising the consent.  The ASPSP might make the usage of this access method unnecessary,  since the related authorisation resource will be automatically created by  the ASPSP after the submission of the consent data with the first POST consents call.  The start authorisation process is a process which is needed for creating a new authorisation  or cancellation sub-resource.   This applies in the following scenarios:    * The ASPSP has indicated with an 'startAuthorisation' hyperlink in the preceding Payment      Initiation Response that an explicit start of the authorisation process is needed by the TPP.      The 'startAuthorisation' hyperlink can transport more information about data which needs to be      uploaded by using the extended forms.     * 'startAuthorisationWithPsuIdentfication',      * 'startAuthorisationWithPsuAuthentication'     * 'startAuthorisationWithAuthentciationMethodSelection'    * The related payment initiation cannot yet be executed since a multilevel SCA is mandated.   * The ASPSP has indicated with an 'startAuthorisation' hyperlink in the preceding      Payment Cancellation Response that an explicit start of the authorisation process is needed by the TPP.      The 'startAuthorisation' hyperlink can transport more information about data which needs to be uploaded      by using the extended forms as indicated above.   * The related payment cancellation request cannot be applied yet since a multilevel SCA is mandate for      executing the cancellation.   * The signing basket needs to be authorised yet. "
													},
													"response": []
												},
												{
													"name": "11. Get consent response object by redirect id",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "b1efe16f-fc04-48a5-92c3-dbe39e5a21d6",
																"exec": [
																	"pm.test(\"Status code is 200\", () => {",
																	"    pm.response.to.have.status(200);",
																	"});",
																	"",
																	"const jsonData = pm.response.json();",
																	"",
																	"pm.test(\"Authorisation id is present\", () => {",
																	"    pm.expect(jsonData).to.have.property(\"authorisationId\");",
																	"});",
																	"",
																	"pm.test(\"Redirect URLs are present\", () => {",
																	"    pm.expect(jsonData).to.have.property(\"tppOkRedirectUri\");",
																	"    pm.expect(jsonData).to.have.property(\"tppNokRedirectUri\");",
																	"});",
																	"",
																	"const authorisationId = jsonData.authorisationId;",
																	"pm.test(\"Authorisation id is correct\", () => {",
																	"    pm.expect(authorisationId).to.eql(pm.globals.get(\"redirect_id\"));",
																	"});",
																	"",
																	"pm.test(\"Consent id is present\", () => {",
																	"    pm.expect(jsonData.consent).to.have.property(\"id\");",
																	"});",
																	"",
																	"pm.globals.set(\"internal_consent_id\", jsonData.consent.id);",
																	"pm.globals.set(\"authorisation_id\", authorisationId);"
																],
																"type": "text/javascript"
															}
														},
														{
															"listen": "prerequest",
															"script": {
																"id": "f5340ad3-2a5c-4d91-a29c-ed998e338bfd",
																"exec": [
																	"pm.globals.unset(\"internal_consent_id\");",
																	"pm.globals.unset(\"authorisation_id\");"
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "GET",
														"header": [],
														"url": {
															"raw": "{{protocol}}://{{url_cms}}/psu-api/v2/piis/consent/redirect/{{redirect_id}}",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_cms}}"
															],
															"path": [
																"psu-api",
																"v2",
																"piis",
																"consent",
																"redirect",
																"{{redirect_id}}"
															]
														}
													},
													"response": []
												},
												{
													"name": "12. Update PSU Data in PIIS consent",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "4d8c30cf-621d-4489-8329-b8b0ea358928",
																"exec": [
																	"pm.test(\"Status code is 200\", () => {",
																	"    pm.response.to.have.status(200);",
																	"});"
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "PUT",
														"header": [
															{
																"key": "Content-Type",
																"name": "Content-Type",
																"type": "text",
																"value": "application/json"
															}
														],
														"body": {
															"mode": "raw",
															"raw": "{\n  \"psuId\": \"{{psu_id_multilevel_2}}\",\n  \"psuIdType\": \"psuIdType\",\n  \"psuCorporateId\": \"psuCorporateId\",\n  \"psuCorporateIdType\": \"psuCorporateIdType\",\n  \"psuIpAddress\": \"1.1.1.1\"\n}"
														},
														"url": {
															"raw": "{{protocol}}://{{url_cms}}/psu-api/v2/piis/consent/{{internal_consent_id}}/authorisation/{{authorisation_id}}/psu-data",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_cms}}"
															],
															"path": [
																"psu-api",
																"v2",
																"piis",
																"consent",
																"{{internal_consent_id}}",
																"authorisation",
																"{{authorisation_id}}",
																"psu-data"
															]
														}
													},
													"response": []
												},
												{
													"name": "13. Update a status of PIIS consent authorisation",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "b227b110-5538-4037-9031-3360e73f81b3",
																"exec": [
																	"pm.test(\"Status code is 200\", () => {",
																	"    pm.response.to.have.status(200);",
																	"});"
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "PUT",
														"header": [
															{
																"key": "PSU-ID",
																"value": "{{psu_id_none}}",
																"type": "text"
															}
														],
														"body": {
															"mode": "raw",
															"raw": ""
														},
														"url": {
															"raw": "{{protocol}}://{{url_cms}}/psu-api/v2/piis/consent/{{internal_consent_id}}/authorisation/{{authorisation_id}}/status/FINALISED",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_cms}}"
															],
															"path": [
																"psu-api",
																"v2",
																"piis",
																"consent",
																"{{internal_consent_id}}",
																"authorisation",
																"{{authorisation_id}}",
																"status",
																"FINALISED"
															]
														}
													},
													"response": []
												},
												{
													"name": "14.  Get Confirmation of Funds Consent Authorisation by its ID",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "a478d5d6-ca81-4139-835e-52e9336fa5c7",
																"exec": [
																	"pm.test(\"Status code is 200\", () => {",
																	"    pm.response.to.have.status(200);",
																	"});",
																	"",
																	"const jsonData = pm.response.json();",
																	"",
																	"pm.test(\"Authorisation id is present\", () => {",
																	"    pm.expect(jsonData).to.have.property(\"authorisationId\");",
																	"});",
																	"",
																	"pm.test(\"Redirect URLs are present\", () => {",
																	"    pm.expect(jsonData).to.have.property(\"tppOkRedirectUri\");",
																	"    pm.expect(jsonData).to.have.property(\"tppNokRedirectUri\");",
																	"});",
																	"",
																	"const authorisationId = jsonData.authorisationId;",
																	"pm.test(\"Authorisation id is correct\", () => {",
																	"    pm.expect(authorisationId).to.eql(pm.globals.get(\"redirect_id\"));",
																	"});",
																	"",
																	"const scaStatus = jsonData.scaStatus;",
																	"pm.test(\"Authorisation is finalised\", () => {",
																	"    pm.expect(scaStatus).to.eql(\"finalised\");",
																	"});",
																	""
																],
																"type": "text/javascript"
															}
														},
														{
															"listen": "prerequest",
															"script": {
																"id": "b8388a97-132f-4576-b9e7-55b74df3b9e4",
																"exec": [
																	""
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "GET",
														"header": [],
														"url": {
															"raw": "{{protocol}}://{{url_cms}}/psu-api/v2/piis/consent/authorisation/{{authorisation_id}}",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_cms}}"
															],
															"path": [
																"psu-api",
																"v2",
																"piis",
																"consent",
																"authorisation",
																"{{authorisation_id}}"
															]
														}
													},
													"response": []
												},
												{
													"name": "15. Update a status of PIIS consent VALID",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "f600dd65-0680-4dec-b66b-e08afc518664",
																"exec": [
																	"pm.test(\"Status code is 200\", () => {",
																	"    pm.response.to.have.status(200);",
																	"});"
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "PUT",
														"header": [
															{
																"key": "PSU-ID",
																"value": "{{psu_id_multilevel_1}}",
																"type": "text"
															}
														],
														"body": {
															"mode": "raw",
															"raw": ""
														},
														"url": {
															"raw": "{{protocol}}://{{url_cms}}/psu-api/v2/piis/consent/{{internal_consent_id}}/status/VALID",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_cms}}"
															],
															"path": [
																"psu-api",
																"v2",
																"piis",
																"consent",
																"{{internal_consent_id}}",
																"status",
																"VALID"
															]
														}
													},
													"response": []
												}
											],
											"protocolProfileBehavior": {},
											"_postman_isSubFolder": true
										},
										{
											"name": "Confirm Consent and read information",
											"item": [
												{
													"name": "16.  Get Confirmation of Funds Consent by its ID",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "f1cc96cc-8cb8-4e4b-83d9-988420f94581",
																"exec": [
																	"pm.test(\"Status code is 200\", () => {",
																	"    pm.response.to.have.status(200);",
																	"});",
																	"",
																	"const jsonData = pm.response.json();",
																	"",
																	"const consentStatus = jsonData.consentStatus;",
																	"pm.test(\"ConsentStatus is VALID\", () => {",
																	"    pm.expect(consentStatus).to.eql(\"VALID\");",
																	"});",
																	"",
																	"const authorisations = jsonData.authorisations;",
																	"pm.test(\"Check if all authorisation is finilised\", () => {",
																	"    //pm.expect(consentStatus).to.eql(\"VALID\");",
																	"",
																	"    authorisations.forEach((auth) => {",
																	"        pm.expect(auth.scaStatus).to.eql(\"finalised\");",
																	"    });",
																	"",
																	"});",
																	"",
																	""
																],
																"type": "text/javascript"
															}
														},
														{
															"listen": "prerequest",
															"script": {
																"id": "5a8ecae7-81e8-43b5-8b81-f777a960abb9",
																"exec": [
																	""
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "GET",
														"header": [],
														"url": {
															"raw": "{{protocol}}://{{url_cms}}/psu-api/v2/piis/consent/{{internal_consent_id}}",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_cms}}"
															],
															"path": [
																"psu-api",
																"v2",
																"piis",
																"consent",
																"{{internal_consent_id}}"
															]
														}
													},
													"response": []
												},
												{
													"name": "17. Confirm PIIS consent",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "63049095-0e8d-48ba-8e21-766cc2599c04",
																"exec": [
																	"pm.test(\"Status code is 200\", () => {",
																	"    pm.response.to.have.status(200);",
																	"});"
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "PUT",
														"header": [
															{
																"key": "PSU-ID",
																"value": "{{psu_id_none}}",
																"type": "text"
															}
														],
														"body": {
															"mode": "raw",
															"raw": ""
														},
														"url": {
															"raw": "{{protocol}}://{{url_cms}}/psu-api/v2/piis/consent/{{internal_consent_id}}/status/VALID",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_cms}}"
															],
															"path": [
																"psu-api",
																"v2",
																"piis",
																"consent",
																"{{internal_consent_id}}",
																"status",
																"VALID"
															]
														}
													},
													"response": []
												},
												{
													"name": "18.  Get Confirmation of Funds Consent by its ID",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "f9544bd4-7612-41ff-b5a9-2bcbf31d8943",
																"exec": [
																	"pm.test(\"Status code is 200\", () => {",
																	"    pm.response.to.have.status(200);",
																	"});",
																	"",
																	"const jsonData = pm.response.json();",
																	"",
																	"const consentStatus = jsonData.consentStatus;",
																	"pm.test(\"ConsentStatus is VALID\", () => {",
																	"    pm.expect(consentStatus).to.eql(\"VALID\");",
																	"});",
																	"",
																	"const authorisations = jsonData.authorisations;",
																	"pm.test(\"Check if all authorisation is finilised\", () => {",
																	"    //pm.expect(consentStatus).to.eql(\"RECEIVED\");",
																	"",
																	"    authorisations.forEach((auth) => {",
																	"        pm.expect(auth.scaStatus).to.eql(\"finalised\");",
																	"    });",
																	"",
																	"});",
																	"",
																	""
																],
																"type": "text/javascript"
															}
														},
														{
															"listen": "prerequest",
															"script": {
																"id": "724933cc-f78a-4f69-9211-31de68bcaa08",
																"exec": [
																	""
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "GET",
														"header": [],
														"url": {
															"raw": "{{protocol}}://{{url_cms}}/psu-api/v2/piis/consent/{{internal_consent_id}}",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_cms}}"
															],
															"path": [
																"psu-api",
																"v2",
																"piis",
																"consent",
																"{{internal_consent_id}}"
															]
														}
													},
													"response": []
												},
												{
													"name": "19. Get PIIS consent in XS2A",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "41cfa6a9-b10e-437e-ab60-6388b9e07bde",
																"exec": [
																	"pm.test(\"Status code is 200\", () => {",
																	"    pm.response.to.have.status(200);",
																	"});",
																	"",
																	"const jsonData = pm.response.json();",
																	"",
																	"pm.test(\"Account is present\", () => {",
																	"   pm.expect(jsonData).to.have.property('account');",
																	"});",
																	"",
																	"const consentStatus = jsonData.consentStatus;",
																	"pm.test(\"ConsentStatus is valid\", () => {",
																	"    pm.expect(consentStatus).to.eql(\"valid\");",
																	"});",
																	""
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"auth": {
															"type": "bearer",
															"bearer": [
																{
																	"key": "token",
																	"value": "{{ledgersBearerToken}}",
																	"type": "string"
																}
															]
														},
														"method": "GET",
														"header": [
															{
																"key": "X-Request-ID",
																"type": "text",
																"value": "{{x_request_id}}"
															}
														],
														"url": {
															"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds/{{piis_consent_id}}",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_xs2a}}"
															],
															"path": [
																"v2",
																"consents",
																"confirmation-of-funds",
																"{{piis_consent_id}}"
															]
														}
													},
													"response": []
												}
											],
											"protocolProfileBehavior": {},
											"_postman_isSubFolder": true
										}
									],
									"protocolProfileBehavior": {},
									"_postman_isSubFolder": true
								},
								{
									"name": "Explicit signing basket",
									"item": [
										{
											"name": "1. Set redirect SCA approach",
											"event": [
												{
													"listen": "test",
													"script": {
														"id": "43ae24fd-5d80-4872-9044-4d5ee285844d",
														"exec": [
															"pm.test(\"Status code is 200\", () => {",
															"    pm.response.to.have.status(200);",
															"});",
															""
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"method": "PUT",
												"header": [
													{
														"key": "Content-Type",
														"name": "Content-Type",
														"type": "text",
														"value": "application/json"
													}
												],
												"body": {
													"mode": "raw",
													"raw": "[\n  \"REDIRECT\",\n  \"EMBEDDED\",\n  \"DECOUPLED\"\n]"
												},
												"url": {
													"raw": "{{protocol}}://{{url_aspsp_profile}}/api/v1/aspsp-profile/for-debug/sca-approaches",
													"protocol": "{{protocol}}",
													"host": [
														"{{url_aspsp_profile}}"
													],
													"path": [
														"api",
														"v1",
														"aspsp-profile",
														"for-debug",
														"sca-approaches"
													]
												}
											},
											"response": []
										},
										{
											"name": "2. Enable PIIS consent support in ASPSP profile",
											"event": [
												{
													"listen": "test",
													"script": {
														"id": "4026eeed-4eb5-4996-9e12-6570f8fd5e13",
														"exec": [
															"pm.test(\"Status code is 200\", () => {",
															"    pm.response.to.have.status(200);",
															"});",
															""
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"method": "PUT",
												"header": [
													{
														"key": "Content-Type",
														"name": "Content-Type",
														"type": "text",
														"value": "application/json"
													}
												],
												"body": {
													"mode": "raw",
													"raw": "{\n    \"ais\": {\n        \"consentTypes\": {\n            \"bankOfferedConsentSupported\": false,\n            \"globalConsentSupported\": false,\n            \"availableAccountsConsentSupported\": true,\n            \"accountAccessFrequencyPerDay\": 4,\n            \"notConfirmedConsentExpirationTimeMs\": 86400000,\n            \"maxConsentValidityDays\": 0\n        },\n        \"redirectLinkToOnlineBanking\": {\n            \"aisRedirectUrlToAspsp\": \"http://localhost:4200/ais/{redirect-id}/{encrypted-consent-id}\"\n        },\n        \"transactionParameters\": {\n            \"availableBookingStatuses\": [\n                \"BOOKED\",\n                \"PENDING\"\n            ],\n            \"transactionsWithoutBalancesSupported\": false,\n            \"supportedTransactionApplicationTypes\": [\n                \"application/json\"\n            ]\n        },\n        \"deltaReportSettings\": {\n            \"entryReferenceFromSupported\": false,\n            \"deltaListSupported\": false\n        },\n        \"scaRequirementsForOneTimeConsents\": {\n            \"scaByOneTimeAvailableAccountsConsentRequired\": true,\n            \"scaByOneTimeGlobalConsentRequired\": true\n        }\n    },\n    \"pis\": {\n        \"supportedPaymentTypeAndProductMatrix\": {\n            \"payments\": [\n                \"sepa-credit-transfers\",\n                \"instant-sepa-credit-transfers\"\n            ]\n        },\n        \"maxTransactionValidityDays\": 0,\n        \"notConfirmedPaymentExpirationTimeMs\": 86400000,\n        \"paymentCancellationAuthorisationMandated\": false,\n        \"redirectLinkToOnlineBanking\": {\n            \"pisRedirectUrlToAspsp\": \"http://localhost:4200/pis/{redirect-id}/{encrypted-payment-id}\",\n            \"pisPaymentCancellationRedirectUrlToAspsp\": \"http://localhost:4200/pis/cancellation/{redirect-id}/{encrypted-payment-id}\",\n            \"paymentCancellationRedirectUrlExpirationTimeMs\": 600000\n        }\n    },\n    \"piis\": {\n        \"piisConsentSupported\": \"TPP_CONSENT_SUPPORTED\",\n        \"redirectLinkToOnlineBanking\": {\n            \"piisRedirectUrlToAspsp\": \"http://localhost:4200/piis/{redirect-id}/{encrypted-consent-id}\"\n        }\n    },\n    \"common\": {\n        \"scaRedirectFlow\": \"REDIRECT\",\n        \"startAuthorisationMode\": \"auto\",\n        \"tppSignatureRequired\": false,\n        \"psuInInitialRequestMandated\": false,\n        \"redirectUrlExpirationTimeMs\": 600000,\n        \"authorisationExpirationTimeMs\": 86400000,\n        \"forceXs2aBaseLinksUrl\": false,\n        \"xs2aBaseLinksUrl\": \"http://myhost.com/\",\n        \"supportedAccountReferenceFields\": [\n            \"IBAN\"\n        ],\n        \"multicurrencyAccountLevelSupported\": \"SUBACCOUNT\",\n        \"aisPisSessionsSupported\": false,\n        \"signingBasketSupported\": true,\n        \"aspspNotificationsSupported\": [\n        ]\n    }\n}",
													"options": {
														"raw": {
															"language": "json"
														}
													}
												},
												"url": {
													"raw": "{{protocol}}://{{url_aspsp_profile}}/api/v1/aspsp-profile/for-debug/aspsp-settings",
													"protocol": "{{protocol}}",
													"host": [
														"{{url_aspsp_profile}}"
													],
													"path": [
														"api",
														"v1",
														"aspsp-profile",
														"for-debug",
														"aspsp-settings"
													]
												}
											},
											"response": []
										},
										{
											"name": "3. Create PIIS consent in XS2A",
											"event": [
												{
													"listen": "test",
													"script": {
														"id": "3e897df4-aa74-42ba-b4c5-1201e9a1a5cd",
														"exec": [
															"pm.test(\"Status code is 201\", () => {",
															"    pm.response.to.have.status(201);",
															"});",
															"",
															"const jsonData = pm.response.json();",
															"",
															"pm.test(\"PIIS consent ID exists\", () => {",
															"   pm.expect(jsonData).to.have.property('consentId');",
															"});",
															"",
															"pm.globals.set(\"piis_consent_id\", jsonData.consentId);",
															"",
															"pm.test(\"startAuthorisation link exists\", () => {",
															"    pm.expect(jsonData).to.have.property('_links');",
															"    const _links = jsonData._links;",
															"    ",
															"    var startAuthorisation = _links.startAuthorisation.href;",
															"",
															"    if (startAuthorisation === undefined) {",
															"       pm.expect().fail();",
															"    }",
															"});",
															"",
															"pm.test(\"Consent status is received\", () => {",
															"    pm.expect(jsonData.consentStatus).to.eql('received');",
															"});"
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"method": "POST",
												"header": [
													{
														"key": "psu-id",
														"value": "{{psu_id_none}}",
														"type": "text"
													},
													{
														"key": "Content-Type",
														"value": "application/json",
														"type": "text"
													},
													{
														"key": "X-Request-ID",
														"value": "{{x_request_id}}",
														"type": "text"
													},
													{
														"key": "TPP-Explicit-Authorisation-Preferred",
														"value": "true",
														"type": "text"
													},
													{
														"key": "TPP-Redirect-URI",
														"value": "TPP-Redirect-URI",
														"type": "text"
													},
													{
														"key": "TPP-Nok-Redirect-URI",
														"value": "TPP-Nok-Redirect-URI",
														"type": "text"
													}
												],
												"body": {
													"mode": "raw",
													"raw": "{\n  \"account\": {\n    \"iban\": \"{{iban_none}}\",\n    \"currency\": \"EUR\"\n  },\n  \"cardNumber\": \"cardNumber\",\n  \"cardExpiryDate\": \"2030-10-10\",\n  \"cardInformation\": \"cardInformation\",\n  \"registrationInformation\": \"registrationInformation\"\n\n}",
													"options": {
														"raw": {}
													}
												},
												"url": {
													"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds",
													"protocol": "{{protocol}}",
													"host": [
														"{{url_xs2a}}"
													],
													"path": [
														"v2",
														"consents",
														"confirmation-of-funds"
													]
												}
											},
											"response": []
										}
									],
									"protocolProfileBehavior": {},
									"_postman_isSubFolder": true
								},
								{
									"name": "Delete PIIS Consent",
									"item": [
										{
											"name": "Validation",
											"item": [
												{
													"name": "1. Set redirect SCA approach",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "aad40472-2aeb-4561-81d4-018ae7d3fb4a",
																"exec": [
																	"pm.test(\"Status code is 200\", () => {",
																	"    pm.response.to.have.status(200);",
																	"});",
																	""
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "PUT",
														"header": [
															{
																"key": "Content-Type",
																"name": "Content-Type",
																"type": "text",
																"value": "application/json"
															}
														],
														"body": {
															"mode": "raw",
															"raw": "[\n  \"REDIRECT\",\n  \"EMBEDDED\",\n  \"DECOUPLED\"\n]"
														},
														"url": {
															"raw": "{{protocol}}://{{url_aspsp_profile}}/api/v1/aspsp-profile/for-debug/sca-approaches",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_aspsp_profile}}"
															],
															"path": [
																"api",
																"v1",
																"aspsp-profile",
																"for-debug",
																"sca-approaches"
															]
														}
													},
													"response": []
												},
												{
													"name": "2. Enable PIIS consent support in ASPSP profile",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "1f0983a8-8df6-4f91-852e-637ee1db7243",
																"exec": [
																	"pm.test(\"Status code is 200\", () => {",
																	"    pm.response.to.have.status(200);",
																	"});",
																	""
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "PUT",
														"header": [
															{
																"key": "Content-Type",
																"name": "Content-Type",
																"type": "text",
																"value": "application/json"
															}
														],
														"body": {
															"mode": "raw",
															"raw": "{\n    \"ais\": {\n        \"consentTypes\": {\n            \"bankOfferedConsentSupported\": false,\n            \"globalConsentSupported\": false,\n            \"availableAccountsConsentSupported\": true,\n            \"accountAccessFrequencyPerDay\": 4,\n            \"notConfirmedConsentExpirationTimeMs\": 86400000,\n            \"maxConsentValidityDays\": 0\n        },\n        \"redirectLinkToOnlineBanking\": {\n            \"aisRedirectUrlToAspsp\": \"http://localhost:4200/ais/{redirect-id}/{encrypted-consent-id}\"\n        },\n        \"transactionParameters\": {\n            \"availableBookingStatuses\": [\n                \"BOOKED\",\n                \"PENDING\"\n            ],\n            \"transactionsWithoutBalancesSupported\": false,\n            \"supportedTransactionApplicationTypes\": [\n                \"application/json\"\n            ]\n        },\n        \"deltaReportSettings\": {\n            \"entryReferenceFromSupported\": false,\n            \"deltaListSupported\": false\n        },\n        \"scaRequirementsForOneTimeConsents\": {\n            \"scaByOneTimeAvailableAccountsConsentRequired\": true,\n            \"scaByOneTimeGlobalConsentRequired\": true\n        }\n    },\n    \"pis\": {\n        \"supportedPaymentTypeAndProductMatrix\": {\n            \"payments\": [\n                \"sepa-credit-transfers\",\n                \"instant-sepa-credit-transfers\"\n            ]\n        },\n        \"maxTransactionValidityDays\": 0,\n        \"notConfirmedPaymentExpirationTimeMs\": 86400000,\n        \"paymentCancellationAuthorisationMandated\": false,\n        \"redirectLinkToOnlineBanking\": {\n            \"pisRedirectUrlToAspsp\": \"http://localhost:4200/pis/{redirect-id}/{encrypted-payment-id}\",\n            \"pisPaymentCancellationRedirectUrlToAspsp\": \"http://localhost:4200/pis/cancellation/{redirect-id}/{encrypted-payment-id}\",\n            \"paymentCancellationRedirectUrlExpirationTimeMs\": 600000\n        }\n    },\n    \"piis\": {\n        \"piisConsentSupported\": \"TPP_CONSENT_SUPPORTED\",\n        \"redirectLinkToOnlineBanking\": {\n            \"piisRedirectUrlToAspsp\": \"http://localhost:4200/piis/{redirect-id}/{encrypted-consent-id}\"\n        }\n    },\n    \"common\": {\n        \"scaRedirectFlow\": \"REDIRECT\",\n        \"startAuthorisationMode\": \"implicit\",\n        \"tppSignatureRequired\": false,\n        \"psuInInitialRequestMandated\": false,\n        \"redirectUrlExpirationTimeMs\": 600000,\n        \"authorisationExpirationTimeMs\": 86400000,\n        \"forceXs2aBaseLinksUrl\": false,\n        \"xs2aBaseLinksUrl\": \"http://myhost.com/\",\n        \"supportedAccountReferenceFields\": [\n            \"IBAN\"\n        ],\n        \"multicurrencyAccountLevelSupported\": \"SUBACCOUNT\",\n        \"aisPisSessionsSupported\": false,\n        \"signingBasketSupported\": false,\n        \"aspspNotificationsSupported\": [\n            \"NONE\"\n        ]\n    }\n}",
															"options": {
																"raw": {
																	"language": "json"
																}
															}
														},
														"url": {
															"raw": "{{protocol}}://{{url_aspsp_profile}}/api/v1/aspsp-profile/for-debug/aspsp-settings",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_aspsp_profile}}"
															],
															"path": [
																"api",
																"v1",
																"aspsp-profile",
																"for-debug",
																"aspsp-settings"
															]
														}
													},
													"response": []
												},
												{
													"name": "3. Create PIIS consent in XS2A",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "0df7ad4d-debd-4af6-9a9f-3fc8463585f2",
																"exec": [
																	"pm.test(\"Status code is 201\", () => {",
																	"    pm.response.to.have.status(201);",
																	"});",
																	"",
																	"const jsonData = pm.response.json();",
																	"",
																	"pm.test(\"PIIS consent ID exists\", () => {",
																	"   pm.expect(jsonData).to.have.property('consentId');",
																	"});",
																	"",
																	"pm.globals.set(\"piis_consent_id\", jsonData.consentId);",
																	"",
																	"const scaRedirectLink = jsonData._links.scaRedirect.href;",
																	"",
																	"if (scaRedirectLink !== undefined) {",
																	"    var a = scaRedirectLink.split('/');",
																	"    a.pop();",
																	"    const authorisationId = a.pop();",
																	"    pm.globals.set(\"authorisation_id\", authorisationId);",
																	"}",
																	"",
																	"const scaStatusParts = jsonData._links.scaStatus.href.split('/');",
																	"const redirectId = scaStatusParts.pop() || scaStatusParts.pop();",
																	"pm.globals.set(\"redirect_id\", redirectId);"
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "POST",
														"header": [
															{
																"key": "psu-id",
																"value": "{{psu_id_none}}",
																"type": "text"
															},
															{
																"key": "Content-Type",
																"value": "application/json",
																"type": "text"
															},
															{
																"key": "X-Request-ID",
																"value": "{{x_request_id}}",
																"type": "text"
															},
															{
																"key": "TPP-Explicit-Authorisation-Preferred",
																"value": "true",
																"type": "text"
															},
															{
																"key": "TPP-Redirect-URI",
																"value": "TPP-Redirect-URI",
																"type": "text"
															},
															{
																"key": "TPP-Nok-Redirect-URI",
																"value": "TPP-Nok-Redirect-URI",
																"type": "text"
															},
															{
																"key": "tpp-qwac-certificate",
																"value": "{{wrong-certificate}}",
																"type": "text",
																"disabled": true
															}
														],
														"body": {
															"mode": "raw",
															"raw": "{\n  \"account\": {\n    \"iban\": \"{{iban_none}}\",\n    \"currency\": \"EUR\"\n  },\n  \"cardNumber\": \"cardNumber\",\n  \"cardExpiryDate\": \"2030-10-10\",\n  \"cardInformation\": \"cardInformation\",\n  \"registrationInformation\": \"registrationInformation\"\n\n}",
															"options": {
																"raw": {}
															}
														},
														"url": {
															"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_xs2a}}"
															],
															"path": [
																"v2",
																"consents",
																"confirmation-of-funds"
															]
														}
													},
													"response": []
												},
												{
													"name": "4. Delete PIIS Consent",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "4ad926e2-a511-49ff-9bc0-2cf61fa6dd2a",
																"exec": [
																	"pm.test(\"Status code is 403\", function () {",
																	"    pm.response.to.have.status(403);",
																	"});",
																	"",
																	"const jsonData = pm.response.json();",
																	"",
																	"pm.test('TppMessages and error are exist', () => {",
																	"    ",
																	"    pm.expect(jsonData).to.have.property('tppMessages');",
																	"    ",
																	"    var error = jsonData.tppMessages[0];",
																	"       ",
																	"    pm.expect(error).to.have.property('category');",
																	"    pm.expect(error).to.have.property('code');",
																	"    pm.expect(error).to.have.property('text');",
																	"       ",
																	"    pm.expect(error.category).to.eql('ERROR');",
																	"    pm.expect(error.code).to.eql('CONSENT_UNKNOWN');",
																	"    pm.expect(error.text).to.eql('TPP certificate doesn’t match the initial request');",
																	"    ",
																	"});"
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "DELETE",
														"header": [
															{
																"key": "Accept",
																"value": "application/json"
															},
															{
																"key": "X-Request-ID",
																"value": "{{x_request_id}}"
															},
															{
																"key": "tpp-qwac-certificate",
																"value": "{{wrong-certificate}}",
																"type": "text"
															}
														],
														"body": {
															"mode": "raw",
															"raw": ""
														},
														"url": {
															"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds/{{piis_consent_id}}",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_xs2a}}"
															],
															"path": [
																"v2",
																"consents",
																"confirmation-of-funds",
																"{{piis_consent_id}}"
															]
														},
														"description": "The TPP can delete an account information consent object if needed."
													},
													"response": []
												}
											],
											"protocolProfileBehavior": {},
											"_postman_isSubFolder": true
										},
										{
											"name": "Not authorized",
											"item": [
												{
													"name": "1. Set redirect SCA approach",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "71e0286c-bca1-4f8b-822c-3b93e3696314",
																"exec": [
																	"pm.test(\"Status code is 200\", () => {",
																	"    pm.response.to.have.status(200);",
																	"});",
																	""
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "PUT",
														"header": [
															{
																"key": "Content-Type",
																"name": "Content-Type",
																"type": "text",
																"value": "application/json"
															}
														],
														"body": {
															"mode": "raw",
															"raw": "[\n  \"REDIRECT\",\n  \"EMBEDDED\",\n  \"DECOUPLED\"\n]"
														},
														"url": {
															"raw": "{{protocol}}://{{url_aspsp_profile}}/api/v1/aspsp-profile/for-debug/sca-approaches",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_aspsp_profile}}"
															],
															"path": [
																"api",
																"v1",
																"aspsp-profile",
																"for-debug",
																"sca-approaches"
															]
														}
													},
													"response": []
												},
												{
													"name": "2. Enable PIIS consent support in ASPSP profile",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "39d9c636-074b-4ce5-9619-70af816a9fa1",
																"exec": [
																	"pm.test(\"Status code is 200\", () => {",
																	"    pm.response.to.have.status(200);",
																	"});",
																	""
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "PUT",
														"header": [
															{
																"key": "Content-Type",
																"name": "Content-Type",
																"type": "text",
																"value": "application/json"
															}
														],
														"body": {
															"mode": "raw",
															"raw": "{\n    \"ais\": {\n        \"consentTypes\": {\n            \"bankOfferedConsentSupported\": false,\n            \"globalConsentSupported\": false,\n            \"availableAccountsConsentSupported\": true,\n            \"accountAccessFrequencyPerDay\": 4,\n            \"notConfirmedConsentExpirationTimeMs\": 86400000,\n            \"maxConsentValidityDays\": 0\n        },\n        \"redirectLinkToOnlineBanking\": {\n            \"aisRedirectUrlToAspsp\": \"http://localhost:4200/ais/{redirect-id}/{encrypted-consent-id}\"\n        },\n        \"transactionParameters\": {\n            \"availableBookingStatuses\": [\n                \"BOOKED\",\n                \"PENDING\"\n            ],\n            \"transactionsWithoutBalancesSupported\": false,\n            \"supportedTransactionApplicationTypes\": [\n                \"application/json\"\n            ]\n        },\n        \"deltaReportSettings\": {\n            \"entryReferenceFromSupported\": false,\n            \"deltaListSupported\": false\n        },\n        \"scaRequirementsForOneTimeConsents\": {\n            \"scaByOneTimeAvailableAccountsConsentRequired\": true,\n            \"scaByOneTimeGlobalConsentRequired\": true\n        }\n    },\n    \"pis\": {\n        \"supportedPaymentTypeAndProductMatrix\": {\n            \"payments\": [\n                \"sepa-credit-transfers\",\n                \"instant-sepa-credit-transfers\"\n            ]\n        },\n        \"maxTransactionValidityDays\": 0,\n        \"notConfirmedPaymentExpirationTimeMs\": 86400000,\n        \"paymentCancellationAuthorisationMandated\": false,\n        \"redirectLinkToOnlineBanking\": {\n            \"pisRedirectUrlToAspsp\": \"http://localhost:4200/pis/{redirect-id}/{encrypted-payment-id}\",\n            \"pisPaymentCancellationRedirectUrlToAspsp\": \"http://localhost:4200/pis/cancellation/{redirect-id}/{encrypted-payment-id}\",\n            \"paymentCancellationRedirectUrlExpirationTimeMs\": 600000\n        }\n    },\n    \"piis\": {\n        \"piisConsentSupported\": \"TPP_CONSENT_SUPPORTED\",\n        \"redirectLinkToOnlineBanking\": {\n            \"piisRedirectUrlToAspsp\": \"http://localhost:4200/piis/{redirect-id}/{encrypted-consent-id}\"\n        }\n    },\n    \"common\": {\n        \"scaRedirectFlow\": \"REDIRECT\",\n        \"startAuthorisationMode\": \"implicit\",\n        \"tppSignatureRequired\": false,\n        \"psuInInitialRequestMandated\": false,\n        \"redirectUrlExpirationTimeMs\": 600000,\n        \"authorisationExpirationTimeMs\": 86400000,\n        \"forceXs2aBaseLinksUrl\": false,\n        \"xs2aBaseLinksUrl\": \"http://myhost.com/\",\n        \"supportedAccountReferenceFields\": [\n            \"IBAN\"\n        ],\n        \"multicurrencyAccountLevelSupported\": \"SUBACCOUNT\",\n        \"aisPisSessionsSupported\": false,\n        \"signingBasketSupported\": false,\n        \"aspspNotificationsSupported\": [\n            \"NONE\"\n        ]\n    }\n}",
															"options": {
																"raw": {
																	"language": "json"
																}
															}
														},
														"url": {
															"raw": "{{protocol}}://{{url_aspsp_profile}}/api/v1/aspsp-profile/for-debug/aspsp-settings",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_aspsp_profile}}"
															],
															"path": [
																"api",
																"v1",
																"aspsp-profile",
																"for-debug",
																"aspsp-settings"
															]
														}
													},
													"response": []
												},
												{
													"name": "3. Create PIIS consent in XS2A",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "837bdade-47f1-4aa1-8205-08909ff71597",
																"exec": [
																	"pm.test(\"Status code is 201\", () => {",
																	"    pm.response.to.have.status(201);",
																	"});",
																	"",
																	"const jsonData = pm.response.json();",
																	"",
																	"pm.test(\"PIIS consent ID exists\", () => {",
																	"   pm.expect(jsonData).to.have.property('consentId');",
																	"});",
																	"",
																	"pm.globals.set(\"piis_consent_id\", jsonData.consentId);",
																	"",
																	"const scaRedirectLink = jsonData._links.scaRedirect.href;",
																	"",
																	"if (scaRedirectLink !== undefined) {",
																	"    var a = scaRedirectLink.split('/');",
																	"    a.pop();",
																	"    const authorisationId = a.pop();",
																	"    pm.globals.set(\"authorisation_id\", authorisationId);",
																	"}",
																	"",
																	"const scaStatusParts = jsonData._links.scaStatus.href.split('/');",
																	"const redirectId = scaStatusParts.pop() || scaStatusParts.pop();",
																	"pm.globals.set(\"redirect_id\", redirectId);"
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "POST",
														"header": [
															{
																"key": "psu-id",
																"value": "{{psu_id_none}}",
																"type": "text"
															},
															{
																"key": "Content-Type",
																"value": "application/json",
																"type": "text"
															},
															{
																"key": "X-Request-ID",
																"value": "{{x_request_id}}",
																"type": "text"
															},
															{
																"key": "TPP-Explicit-Authorisation-Preferred",
																"value": "true",
																"type": "text"
															},
															{
																"key": "TPP-Redirect-URI",
																"value": "TPP-Redirect-URI",
																"type": "text"
															},
															{
																"key": "TPP-Nok-Redirect-URI",
																"value": "TPP-Nok-Redirect-URI",
																"type": "text"
															}
														],
														"body": {
															"mode": "raw",
															"raw": "{\n  \"account\": {\n    \"iban\": \"{{iban_none}}\",\n    \"currency\": \"EUR\"\n  },\n  \"cardNumber\": \"cardNumber\",\n  \"cardExpiryDate\": \"2030-10-10\",\n  \"cardInformation\": \"cardInformation\",\n  \"registrationInformation\": \"registrationInformation\"\n\n}",
															"options": {
																"raw": {}
															}
														},
														"url": {
															"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_xs2a}}"
															],
															"path": [
																"v2",
																"consents",
																"confirmation-of-funds"
															]
														}
													},
													"response": []
												},
												{
													"name": "4. Delete PIIS Consent",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "f50d4e9a-314c-4db3-9aad-8422c7b8bc5b",
																"exec": [
																	"pm.test(\"Status code is 204\", function () {",
																	"    pm.response.to.have.status(204);",
																	"});"
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "DELETE",
														"header": [
															{
																"key": "Accept",
																"value": "application/json"
															},
															{
																"key": "X-Request-ID",
																"value": "{{x_request_id}}"
															}
														],
														"body": {
															"mode": "raw",
															"raw": ""
														},
														"url": {
															"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds/{{piis_consent_id}}",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_xs2a}}"
															],
															"path": [
																"v2",
																"consents",
																"confirmation-of-funds",
																"{{piis_consent_id}}"
															]
														},
														"description": "The TPP can delete an account information consent object if needed."
													},
													"response": []
												},
												{
													"name": "5. Get PIIS consent status in XS2A",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "12be7bcb-07a6-4b22-ba81-be297ed4e8c0",
																"exec": [
																	"pm.test(\"Status code is 200\", () => {",
																	"    pm.response.to.have.status(200);",
																	"});",
																	"",
																	"const jsonData = pm.response.json();",
																	"",
																	"pm.test(\"ConsentStatus is rejected\", () => {",
																	"   pm.expect(jsonData).to.have.property('consentStatus');",
																	"   pm.expect(jsonData.consentStatus).to.eql(\"rejected\");",
																	"});",
																	""
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"auth": {
															"type": "bearer",
															"bearer": [
																{
																	"key": "token",
																	"value": "{{ledgersBearerToken}}",
																	"type": "string"
																}
															]
														},
														"method": "GET",
														"header": [
															{
																"key": "X-Request-ID",
																"type": "text",
																"value": "{{x_request_id}}"
															}
														],
														"url": {
															"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds/{{piis_consent_id}}/status",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_xs2a}}"
															],
															"path": [
																"v2",
																"consents",
																"confirmation-of-funds",
																"{{piis_consent_id}}",
																"status"
															]
														}
													},
													"response": []
												}
											],
											"protocolProfileBehavior": {},
											"_postman_isSubFolder": true
										},
										{
											"name": "Authorized",
											"item": [
												{
													"name": "1. Set redirect SCA approach",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "47de7479-4da6-48b6-9e05-edfb7cdfc5e6",
																"exec": [
																	"pm.test(\"Status code is 200\", () => {",
																	"    pm.response.to.have.status(200);",
																	"});",
																	""
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "PUT",
														"header": [
															{
																"key": "Content-Type",
																"name": "Content-Type",
																"type": "text",
																"value": "application/json"
															}
														],
														"body": {
															"mode": "raw",
															"raw": "[\n  \"REDIRECT\",\n  \"EMBEDDED\",\n  \"DECOUPLED\"\n]"
														},
														"url": {
															"raw": "{{protocol}}://{{url_aspsp_profile}}/api/v1/aspsp-profile/for-debug/sca-approaches",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_aspsp_profile}}"
															],
															"path": [
																"api",
																"v1",
																"aspsp-profile",
																"for-debug",
																"sca-approaches"
															]
														}
													},
													"response": []
												},
												{
													"name": "2. Enable PIIS consent support in ASPSP profile",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "850edb4c-4345-462c-ab19-f3e7d62e92d0",
																"exec": [
																	"pm.test(\"Status code is 200\", () => {",
																	"    pm.response.to.have.status(200);",
																	"});",
																	""
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "PUT",
														"header": [
															{
																"key": "Content-Type",
																"name": "Content-Type",
																"type": "text",
																"value": "application/json"
															}
														],
														"body": {
															"mode": "raw",
															"raw": "{\n    \"ais\": {\n        \"consentTypes\": {\n            \"bankOfferedConsentSupported\": false,\n            \"globalConsentSupported\": false,\n            \"availableAccountsConsentSupported\": true,\n            \"accountAccessFrequencyPerDay\": 4,\n            \"notConfirmedConsentExpirationTimeMs\": 86400000,\n            \"maxConsentValidityDays\": 0\n        },\n        \"redirectLinkToOnlineBanking\": {\n            \"aisRedirectUrlToAspsp\": \"http://localhost:4200/ais/{redirect-id}/{encrypted-consent-id}\"\n        },\n        \"transactionParameters\": {\n            \"availableBookingStatuses\": [\n                \"BOOKED\",\n                \"PENDING\"\n            ],\n            \"transactionsWithoutBalancesSupported\": false,\n            \"supportedTransactionApplicationTypes\": [\n                \"application/json\"\n            ]\n        },\n        \"deltaReportSettings\": {\n            \"entryReferenceFromSupported\": false,\n            \"deltaListSupported\": false\n        },\n        \"scaRequirementsForOneTimeConsents\": {\n            \"scaByOneTimeAvailableAccountsConsentRequired\": true,\n            \"scaByOneTimeGlobalConsentRequired\": true\n        }\n    },\n    \"pis\": {\n        \"supportedPaymentTypeAndProductMatrix\": {\n            \"payments\": [\n                \"sepa-credit-transfers\",\n                \"instant-sepa-credit-transfers\"\n            ]\n        },\n        \"maxTransactionValidityDays\": 0,\n        \"notConfirmedPaymentExpirationTimeMs\": 86400000,\n        \"paymentCancellationAuthorisationMandated\": false,\n        \"redirectLinkToOnlineBanking\": {\n            \"pisRedirectUrlToAspsp\": \"http://localhost:4200/pis/{redirect-id}/{encrypted-payment-id}\",\n            \"pisPaymentCancellationRedirectUrlToAspsp\": \"http://localhost:4200/pis/cancellation/{redirect-id}/{encrypted-payment-id}\",\n            \"paymentCancellationRedirectUrlExpirationTimeMs\": 600000\n        }\n    },\n    \"piis\": {\n        \"piisConsentSupported\": \"TPP_CONSENT_SUPPORTED\",\n        \"redirectLinkToOnlineBanking\": {\n            \"piisRedirectUrlToAspsp\": \"http://localhost:4200/piis/{redirect-id}/{encrypted-consent-id}\"\n        }\n    },\n    \"common\": {\n        \"scaRedirectFlow\": \"REDIRECT\",\n        \"startAuthorisationMode\": \"implicit\",\n        \"tppSignatureRequired\": false,\n        \"psuInInitialRequestMandated\": false,\n        \"redirectUrlExpirationTimeMs\": 600000,\n        \"authorisationExpirationTimeMs\": 86400000,\n        \"forceXs2aBaseLinksUrl\": false,\n        \"xs2aBaseLinksUrl\": \"http://myhost.com/\",\n        \"supportedAccountReferenceFields\": [\n            \"IBAN\"\n        ],\n        \"multicurrencyAccountLevelSupported\": \"SUBACCOUNT\",\n        \"aisPisSessionsSupported\": false,\n        \"signingBasketSupported\": false,\n        \"aspspNotificationsSupported\": [\n            \"NONE\"\n        ]\n    }\n}",
															"options": {
																"raw": {
																	"language": "json"
																}
															}
														},
														"url": {
															"raw": "{{protocol}}://{{url_aspsp_profile}}/api/v1/aspsp-profile/for-debug/aspsp-settings",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_aspsp_profile}}"
															],
															"path": [
																"api",
																"v1",
																"aspsp-profile",
																"for-debug",
																"aspsp-settings"
															]
														}
													},
													"response": []
												},
												{
													"name": "3. Create PIIS consent in XS2A",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "4a8c0f60-4fea-4455-b86f-b1ecb17d3149",
																"exec": [
																	"pm.test(\"Status code is 201\", () => {",
																	"    pm.response.to.have.status(201);",
																	"});",
																	"",
																	"const jsonData = pm.response.json();",
																	"",
																	"pm.test(\"PIIS consent ID exists\", () => {",
																	"   pm.expect(jsonData).to.have.property('consentId');",
																	"});",
																	"",
																	"pm.globals.set(\"piis_consent_id\", jsonData.consentId);",
																	"",
																	"const scaRedirectLink = jsonData._links.scaRedirect.href;",
																	"",
																	"if (scaRedirectLink !== undefined) {",
																	"    var a = scaRedirectLink.split('/');",
																	"    a.pop();",
																	"    const authorisationId = a.pop();",
																	"    pm.globals.set(\"authorisation_id\", authorisationId);",
																	"}",
																	"",
																	"const scaStatusParts = jsonData._links.scaStatus.href.split('/');",
																	"const redirectId = scaStatusParts.pop() || scaStatusParts.pop();",
																	"pm.globals.set(\"redirect_id\", redirectId);"
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "POST",
														"header": [
															{
																"key": "psu-id",
																"value": "{{psu_id_none}}",
																"type": "text"
															},
															{
																"key": "Content-Type",
																"value": "application/json",
																"type": "text"
															},
															{
																"key": "X-Request-ID",
																"value": "{{x_request_id}}",
																"type": "text"
															},
															{
																"key": "TPP-Explicit-Authorisation-Preferred",
																"value": "true",
																"type": "text"
															},
															{
																"key": "TPP-Redirect-URI",
																"value": "TPP-Redirect-URI",
																"type": "text"
															},
															{
																"key": "TPP-Nok-Redirect-URI",
																"value": "TPP-Nok-Redirect-URI",
																"type": "text"
															}
														],
														"body": {
															"mode": "raw",
															"raw": "{\n  \"account\": {\n    \"iban\": \"{{iban_none}}\",\n    \"currency\": \"EUR\"\n  },\n  \"cardNumber\": \"cardNumber\",\n  \"cardExpiryDate\": \"2030-10-10\",\n  \"cardInformation\": \"cardInformation\",\n  \"registrationInformation\": \"registrationInformation\"\n\n}",
															"options": {
																"raw": {}
															}
														},
														"url": {
															"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_xs2a}}"
															],
															"path": [
																"v2",
																"consents",
																"confirmation-of-funds"
															]
														}
													},
													"response": []
												},
												{
													"name": "4. Get consent response object by redirect id",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "703f0c98-05c5-4c41-b582-d006e8fb5a63",
																"exec": [
																	"pm.test(\"Status code is 200\", () => {",
																	"    pm.response.to.have.status(200);",
																	"});",
																	"",
																	"const jsonData = pm.response.json();",
																	"",
																	"pm.test(\"Authorisation id is present\", () => {",
																	"    pm.expect(jsonData).to.have.property(\"authorisationId\");",
																	"});",
																	"",
																	"pm.test(\"Redirect URLs are present\", () => {",
																	"    pm.expect(jsonData).to.have.property(\"tppOkRedirectUri\");",
																	"    pm.expect(jsonData).to.have.property(\"tppNokRedirectUri\");",
																	"});",
																	"",
																	"const authorisationId = jsonData.authorisationId;",
																	"pm.test(\"Authorisation id is correct\", () => {",
																	"    pm.expect(authorisationId).to.eql(pm.globals.get(\"redirect_id\"));",
																	"});",
																	"",
																	"pm.test(\"Consent id is present\", () => {",
																	"    pm.expect(jsonData.consent).to.have.property(\"id\");",
																	"});",
																	"",
																	"pm.globals.set(\"internal_consent_id\", jsonData.consent.id);",
																	"pm.globals.set(\"authorisation_id\", authorisationId);"
																],
																"type": "text/javascript"
															}
														},
														{
															"listen": "prerequest",
															"script": {
																"id": "f81c1c1e-3db6-466e-9060-6c21ee7ead20",
																"exec": [
																	"pm.globals.unset(\"internal_consent_id\");",
																	"pm.globals.unset(\"authorisation_id\");"
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "GET",
														"header": [],
														"url": {
															"raw": "{{protocol}}://{{url_cms}}/psu-api/v2/piis/consent/redirect/{{redirect_id}}",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_cms}}"
															],
															"path": [
																"psu-api",
																"v2",
																"piis",
																"consent",
																"redirect",
																"{{redirect_id}}"
															]
														}
													},
													"response": []
												},
												{
													"name": "5. Update PIIS Consent status",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "1787215a-2a9c-462b-b59a-a38177c7a9a5",
																"exec": [
																	"pm.test(\"Status code is 200\", () => {",
																	"    pm.response.to.have.status(200);",
																	"});"
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "PUT",
														"header": [
															{
																"key": "Accept",
																"value": "application/json"
															},
															{
																"key": "Content-Type",
																"value": "application/json"
															},
															{
																"key": "X-Request-ID",
																"value": "{{x_request_id}}"
															}
														],
														"body": {
															"mode": "raw",
															"raw": "{\n\t\"psuData\": {\n\t\t\"password\": \"{{psu_id_password}}\"\n\t}\n}"
														},
														"url": {
															"raw": "{{protocol}}://{{url_cms}}/psu-api/v2/piis/consent/{{internal_consent_id}}/status/VALID",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_cms}}"
															],
															"path": [
																"psu-api",
																"v2",
																"piis",
																"consent",
																"{{internal_consent_id}}",
																"status",
																"VALID"
															]
														},
														"description": "This method update PSU data on the consents  resource if needed.  It may authorise a consent within the Embedded SCA Approach where needed.  Independently from the SCA Approach it supports e.g. the selection of  the authentication method and a non-SCA PSU authentication.  This methods updates PSU data on the cancellation authorisation resource if needed.   There are several possible Update PSU Data requests in the context of a consent request if needed,  which depends on the SCA approach:  * Redirect SCA Approach:   A specific Update PSU Data Request is applicable for      * the selection of authentication methods, before choosing the actual SCA approach. * Decoupled SCA Approach:   A specific Update PSU Data Request is only applicable for   * adding the PSU Identification, if not provided yet in the Payment Initiation Request or the Account Information Consent Request, or if no OAuth2 access token is used, or   * the selection of authentication methods. * Embedded SCA Approach:    The Update PSU Data Request might be used    * to add credentials as a first factor authentication data of the PSU and   * to select the authentication method and   * transaction authorisation.  The SCA Approach might depend on the chosen SCA method.  For that reason, the following possible Update PSU Data request can apply to all SCA approaches:  * Select an SCA method in case of several SCA methods are available for the customer.  There are the following request types on this access path:   * Update PSU Identification   * Update PSU Authentication   * Select PSU Autorization Method      WARNING: This method need a reduced header,      therefore many optional elements are not present.      Maybe in a later version the access path will change.   * Transaction Authorisation     WARNING: This method need a reduced header,      therefore many optional elements are not present.      Maybe in a later version the access path will change. "
													},
													"response": []
												},
												{
													"name": "6. Get PIIS consent status in XS2A",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "c4e45de8-ec28-4a06-9993-2df7103d828d",
																"exec": [
																	"pm.test(\"Status code is 200\", () => {",
																	"    pm.response.to.have.status(200);",
																	"});",
																	"",
																	"const jsonData = pm.response.json();",
																	"",
																	"pm.test(\"ConsentStatus is valid\", () => {",
																	"   pm.expect(jsonData).to.have.property('consentStatus');",
																	"   pm.expect(jsonData.consentStatus).to.eql(\"valid\");",
																	"});",
																	""
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"auth": {
															"type": "bearer",
															"bearer": [
																{
																	"key": "token",
																	"value": "{{ledgersBearerToken}}",
																	"type": "string"
																}
															]
														},
														"method": "GET",
														"header": [
															{
																"key": "X-Request-ID",
																"type": "text",
																"value": "{{x_request_id}}"
															}
														],
														"url": {
															"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds/{{piis_consent_id}}/status",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_xs2a}}"
															],
															"path": [
																"v2",
																"consents",
																"confirmation-of-funds",
																"{{piis_consent_id}}",
																"status"
															]
														}
													},
													"response": []
												},
												{
													"name": "7. Delete PIIS Consent",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "12766815-3c4d-4b64-acd7-e252a0906649",
																"exec": [
																	"pm.test(\"Status code is 204\", function () {",
																	"    pm.response.to.have.status(204);",
																	"});"
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "DELETE",
														"header": [
															{
																"key": "Accept",
																"value": "application/json"
															},
															{
																"key": "X-Request-ID",
																"value": "{{x_request_id}}"
															}
														],
														"body": {
															"mode": "raw",
															"raw": ""
														},
														"url": {
															"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds/{{piis_consent_id}}",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_xs2a}}"
															],
															"path": [
																"v2",
																"consents",
																"confirmation-of-funds",
																"{{piis_consent_id}}"
															]
														},
														"description": "The TPP can delete an account information consent object if needed."
													},
													"response": []
												},
												{
													"name": "8. Get PIIS consent status in XS2A",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "dcd3ebae-3f55-4f52-86d6-2adb508b636e",
																"exec": [
																	"pm.test(\"Status code is 200\", () => {",
																	"    pm.response.to.have.status(200);",
																	"});",
																	"",
																	"const jsonData = pm.response.json();",
																	"",
																	"pm.test(\"ConsentStatus is terminatedByTpp\", () => {",
																	"   pm.expect(jsonData).to.have.property('consentStatus');",
																	"   pm.expect(jsonData.consentStatus).to.eql(\"terminatedByTpp\");",
																	"});",
																	""
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"auth": {
															"type": "bearer",
															"bearer": [
																{
																	"key": "token",
																	"value": "{{ledgersBearerToken}}",
																	"type": "string"
																}
															]
														},
														"method": "GET",
														"header": [
															{
																"key": "X-Request-ID",
																"type": "text",
																"value": "{{x_request_id}}"
															}
														],
														"url": {
															"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds/{{piis_consent_id}}/status",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_xs2a}}"
															],
															"path": [
																"v2",
																"consents",
																"confirmation-of-funds",
																"{{piis_consent_id}}",
																"status"
															]
														}
													},
													"response": []
												}
											],
											"protocolProfileBehavior": {},
											"_postman_isSubFolder": true
										}
									],
									"protocolProfileBehavior": {},
									"_postman_isSubFolder": true
								},
								{
									"name": "Reject PIIS Consent",
									"item": [
										{
											"name": "1. Set redirect SCA approach",
											"event": [
												{
													"listen": "test",
													"script": {
														"id": "54a9b57b-0cee-48c6-b53d-8c582604d7e7",
														"exec": [
															"pm.test(\"Status code is 200\", () => {",
															"    pm.response.to.have.status(200);",
															"});",
															""
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"method": "PUT",
												"header": [
													{
														"key": "Content-Type",
														"name": "Content-Type",
														"type": "text",
														"value": "application/json"
													}
												],
												"body": {
													"mode": "raw",
													"raw": "[\n  \"REDIRECT\",\n  \"EMBEDDED\",\n  \"DECOUPLED\"\n]"
												},
												"url": {
													"raw": "{{protocol}}://{{url_aspsp_profile}}/api/v1/aspsp-profile/for-debug/sca-approaches",
													"protocol": "{{protocol}}",
													"host": [
														"{{url_aspsp_profile}}"
													],
													"path": [
														"api",
														"v1",
														"aspsp-profile",
														"for-debug",
														"sca-approaches"
													]
												}
											},
											"response": []
										},
										{
											"name": "2. Enable PIIS consent support in ASPSP profile",
											"event": [
												{
													"listen": "test",
													"script": {
														"id": "7a912afb-681d-42ca-b05f-fb9e3d7da993",
														"exec": [
															"pm.test(\"Status code is 200\", () => {",
															"    pm.response.to.have.status(200);",
															"});",
															""
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"method": "PUT",
												"header": [
													{
														"key": "Content-Type",
														"name": "Content-Type",
														"type": "text",
														"value": "application/json"
													}
												],
												"body": {
													"mode": "raw",
													"raw": "{\n    \"ais\": {\n        \"consentTypes\": {\n            \"bankOfferedConsentSupported\": false,\n            \"globalConsentSupported\": false,\n            \"availableAccountsConsentSupported\": true,\n            \"accountAccessFrequencyPerDay\": 4,\n            \"notConfirmedConsentExpirationTimeMs\": 86400000,\n            \"maxConsentValidityDays\": 0\n        },\n        \"redirectLinkToOnlineBanking\": {\n            \"aisRedirectUrlToAspsp\": \"http://localhost:4200/ais/{redirect-id}/{encrypted-consent-id}\"\n        },\n        \"transactionParameters\": {\n            \"availableBookingStatuses\": [\n                \"BOOKED\",\n                \"PENDING\"\n            ],\n            \"transactionsWithoutBalancesSupported\": false,\n            \"supportedTransactionApplicationTypes\": [\n                \"application/json\"\n            ]\n        },\n        \"deltaReportSettings\": {\n            \"entryReferenceFromSupported\": false,\n            \"deltaListSupported\": false\n        },\n        \"scaRequirementsForOneTimeConsents\": {\n            \"scaByOneTimeAvailableAccountsConsentRequired\": true,\n            \"scaByOneTimeGlobalConsentRequired\": true\n        }\n    },\n    \"pis\": {\n        \"supportedPaymentTypeAndProductMatrix\": {\n            \"payments\": [\n                \"sepa-credit-transfers\",\n                \"instant-sepa-credit-transfers\"\n            ]\n        },\n        \"maxTransactionValidityDays\": 0,\n        \"notConfirmedPaymentExpirationTimeMs\": 86400000,\n        \"paymentCancellationAuthorisationMandated\": false,\n        \"redirectLinkToOnlineBanking\": {\n            \"pisRedirectUrlToAspsp\": \"http://localhost:4200/pis/{redirect-id}/{encrypted-payment-id}\",\n            \"pisPaymentCancellationRedirectUrlToAspsp\": \"http://localhost:4200/pis/cancellation/{redirect-id}/{encrypted-payment-id}\",\n            \"paymentCancellationRedirectUrlExpirationTimeMs\": 600000\n        }\n    },\n    \"piis\": {\n        \"piisConsentSupported\": \"TPP_CONSENT_SUPPORTED\",\n        \"redirectLinkToOnlineBanking\": {\n            \"piisRedirectUrlToAspsp\": \"http://localhost:4200/piis/{redirect-id}/{encrypted-consent-id}\"\n        }\n    },\n    \"common\": {\n        \"scaRedirectFlow\": \"REDIRECT\",\n        \"startAuthorisationMode\": \"auto\",\n        \"tppSignatureRequired\": false,\n        \"psuInInitialRequestMandated\": false,\n        \"redirectUrlExpirationTimeMs\": 600000,\n        \"authorisationExpirationTimeMs\": 86400000,\n        \"forceXs2aBaseLinksUrl\": false,\n        \"xs2aBaseLinksUrl\": \"http://myhost.com/\",\n        \"supportedAccountReferenceFields\": [\n            \"IBAN\"\n        ],\n        \"multicurrencyAccountLevelSupported\": \"SUBACCOUNT\",\n        \"aisPisSessionsSupported\": false,\n        \"signingBasketSupported\": true,\n        \"aspspNotificationsSupported\": [\n        ]\n    }\n}",
													"options": {
														"raw": {
															"language": "json"
														}
													}
												},
												"url": {
													"raw": "{{protocol}}://{{url_aspsp_profile}}/api/v1/aspsp-profile/for-debug/aspsp-settings",
													"protocol": "{{protocol}}",
													"host": [
														"{{url_aspsp_profile}}"
													],
													"path": [
														"api",
														"v1",
														"aspsp-profile",
														"for-debug",
														"aspsp-settings"
													]
												}
											},
											"response": []
										},
										{
											"name": "3. Create PIIS consent in XS2A",
											"event": [
												{
													"listen": "test",
													"script": {
														"id": "985048ee-ad98-41f3-9a99-30113e41957e",
														"exec": [
															"pm.test(\"Status code is 201\", () => {",
															"    pm.response.to.have.status(201);",
															"});",
															"",
															"const jsonData = pm.response.json();",
															"",
															"pm.test(\"PIIS consent ID exists\", () => {",
															"   pm.expect(jsonData).to.have.property('consentId');",
															"});",
															"",
															"pm.globals.set(\"piis_consent_id\", jsonData.consentId);",
															"",
															"pm.test(\"startAuthorisation link exists\", () => {",
															"    pm.expect(jsonData).to.have.property('_links');",
															"    const _links = jsonData._links;",
															"    ",
															"    var startAuthorisation = _links.startAuthorisation.href;",
															"",
															"    if (startAuthorisation === undefined) {",
															"       pm.expect().fail();",
															"    }",
															"});",
															"",
															"pm.test(\"Consent status is received\", () => {",
															"    pm.expect(jsonData.consentStatus).to.eql('received');",
															"});"
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"method": "POST",
												"header": [
													{
														"key": "psu-id",
														"value": "{{psu_id_none}}",
														"type": "text"
													},
													{
														"key": "Content-Type",
														"value": "application/json",
														"type": "text"
													},
													{
														"key": "X-Request-ID",
														"value": "{{x_request_id}}",
														"type": "text"
													},
													{
														"key": "TPP-Explicit-Authorisation-Preferred",
														"value": "true",
														"type": "text"
													},
													{
														"key": "TPP-Redirect-URI",
														"value": "TPP-Redirect-URI",
														"type": "text"
													},
													{
														"key": "TPP-Nok-Redirect-URI",
														"value": "TPP-Nok-Redirect-URI",
														"type": "text"
													}
												],
												"body": {
													"mode": "raw",
													"raw": "{\n  \"account\": {\n    \"iban\": \"{{iban_none}}\",\n    \"currency\": \"EUR\"\n  },\n  \"cardNumber\": \"cardNumber\",\n  \"cardExpiryDate\": \"2030-10-10\",\n  \"cardInformation\": \"cardInformation\",\n  \"registrationInformation\": \"registrationInformation\"\n\n}",
													"options": {
														"raw": {}
													}
												},
												"url": {
													"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds",
													"protocol": "{{protocol}}",
													"host": [
														"{{url_xs2a}}"
													],
													"path": [
														"v2",
														"consents",
														"confirmation-of-funds"
													]
												}
											},
											"response": []
										},
										{
											"name": "4. Start the authorisation process for a consent",
											"event": [
												{
													"listen": "test",
													"script": {
														"id": "8b10fe8b-8c89-4840-aa60-1d8b143226af",
														"exec": [
															"pm.test(\"Status code is 201\", () => {",
															"    pm.response.to.have.status(201);",
															"});",
															"",
															"const jsonData = pm.response.json();",
															"",
															"pm.test(\"Sca status is psuIdentified\", () => {",
															"    pm.expect(jsonData.scaStatus).to.eql('psuIdentified');",
															"});",
															"",
															"pm.test(\"scaRedirect link exists\", () => {",
															"    pm.expect(jsonData).to.have.property('_links');",
															"    const _links = jsonData._links;",
															"    ",
															"    pm.expect(_links).to.have.property('scaRedirect');",
															"});",
															"",
															"// splits string link by '/' to array and gets the last element - authorisationId",
															"// e.g. \"http://localhost:8080/v1/consents/d917f39f-6308-4f81-9b51-bfbd8bc934c6/authorisations/554fda7d-bc70-44da-8670-15e299f817a6\"",
															"      // needs to get 554fda7d-bc70-44da-8670-15e299f817a6 value",
															"",
															"    var a = jsonData._links.scaRedirect.href.split('/');",
															"    a.pop();",
															"    const authorisationId = a.pop();",
															"",
															"pm.globals.set(\"authorisation_id\", authorisationId);",
															"pm.globals.set(\"redirect_id\", authorisationId);",
															""
														],
														"type": "text/javascript"
													}
												},
												{
													"listen": "prerequest",
													"script": {
														"id": "54e9e233-e1d5-4ad1-baa0-f7f6303b6d7e",
														"exec": [
															""
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"method": "POST",
												"header": [
													{
														"key": "Accept",
														"value": "application/json"
													},
													{
														"key": "Content-Type",
														"value": "application/json"
													},
													{
														"key": "PSU-ID",
														"value": "{{psu_id_none}}"
													},
													{
														"key": "X-Request-ID",
														"value": "{{x_request_id}}"
													}
												],
												"body": {
													"mode": "raw",
													"raw": ""
												},
												"url": {
													"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds/{{piis_consent_id}}/authorisations",
													"protocol": "{{protocol}}",
													"host": [
														"{{url_xs2a}}"
													],
													"path": [
														"v2",
														"consents",
														"confirmation-of-funds",
														"{{piis_consent_id}}",
														"authorisations"
													]
												},
												"description": "Create an authorisation sub-resource and start the authorisation process of a consent.  The message might in addition transmit authentication and authorisation related data.  his method is iterated n times for a n times SCA authorisation in a  corporate context, each creating an own authorisation sub-endpoint for  the corresponding PSU authorising the consent.  The ASPSP might make the usage of this access method unnecessary,  since the related authorisation resource will be automatically created by  the ASPSP after the submission of the consent data with the first POST consents call.  The start authorisation process is a process which is needed for creating a new authorisation  or cancellation sub-resource.   This applies in the following scenarios:    * The ASPSP has indicated with an 'startAuthorisation' hyperlink in the preceding Payment      Initiation Response that an explicit start of the authorisation process is needed by the TPP.      The 'startAuthorisation' hyperlink can transport more information about data which needs to be      uploaded by using the extended forms.     * 'startAuthorisationWithPsuIdentfication',      * 'startAuthorisationWithPsuAuthentication'     * 'startAuthorisationWithAuthentciationMethodSelection'    * The related payment initiation cannot yet be executed since a multilevel SCA is mandated.   * The ASPSP has indicated with an 'startAuthorisation' hyperlink in the preceding      Payment Cancellation Response that an explicit start of the authorisation process is needed by the TPP.      The 'startAuthorisation' hyperlink can transport more information about data which needs to be uploaded      by using the extended forms as indicated above.   * The related payment cancellation request cannot be applied yet since a multilevel SCA is mandate for      executing the cancellation.   * The signing basket needs to be authorised yet. "
											},
											"response": []
										},
										{
											"name": "5. Get consent response object by redirect id",
											"event": [
												{
													"listen": "test",
													"script": {
														"id": "c2ce8b7b-44e9-4317-8846-3c2e74ac27c2",
														"exec": [
															"pm.test(\"Status code is 200\", () => {",
															"    pm.response.to.have.status(200);",
															"});",
															"",
															"const jsonData = pm.response.json();",
															"",
															"pm.test(\"Authorisation id is present\", () => {",
															"    pm.expect(jsonData).to.have.property(\"authorisationId\");",
															"});",
															"",
															"pm.test(\"Redirect URLs are present\", () => {",
															"    pm.expect(jsonData).to.have.property(\"tppOkRedirectUri\");",
															"    pm.expect(jsonData).to.have.property(\"tppNokRedirectUri\");",
															"});",
															"",
															"const authorisationId = jsonData.authorisationId;",
															"pm.test(\"Authorisation id is correct\", () => {",
															"    pm.expect(authorisationId).to.eql(pm.globals.get(\"redirect_id\"));",
															"});",
															"",
															"pm.test(\"Consent id is present\", () => {",
															"    pm.expect(jsonData.consent).to.have.property(\"id\");",
															"});",
															"",
															"pm.globals.set(\"internal_consent_id\", jsonData.consent.id);",
															"pm.globals.set(\"authorisation_id\", authorisationId);"
														],
														"type": "text/javascript"
													}
												},
												{
													"listen": "prerequest",
													"script": {
														"id": "a527aaac-310a-42f6-9961-f01f48de84b7",
														"exec": [
															"pm.globals.unset(\"internal_consent_id\");",
															"pm.globals.unset(\"authorisation_id\");"
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"method": "GET",
												"header": [],
												"url": {
													"raw": "{{protocol}}://{{url_cms}}/psu-api/v2/piis/consent/redirect/{{redirect_id}}",
													"protocol": "{{protocol}}",
													"host": [
														"{{url_cms}}"
													],
													"path": [
														"psu-api",
														"v2",
														"piis",
														"consent",
														"redirect",
														"{{redirect_id}}"
													]
												}
											},
											"response": []
										},
										{
											"name": "7. Update a status of PIIS consent authorisation (FAILED)",
											"event": [
												{
													"listen": "test",
													"script": {
														"id": "2b0d6db7-4555-43a7-bef9-77da374d042f",
														"exec": [
															"pm.test(\"Status code is 200\", () => {",
															"    pm.response.to.have.status(200);",
															"});"
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"method": "PUT",
												"header": [
													{
														"key": "PSU-ID",
														"type": "text",
														"value": "{{psu_id_none}}"
													}
												],
												"body": {
													"mode": "raw",
													"raw": ""
												},
												"url": {
													"raw": "{{protocol}}://{{url_cms}}/psu-api/v2/piis/consent/{{internal_consent_id}}/authorisation/{{authorisation_id}}/status/FAILED",
													"protocol": "{{protocol}}",
													"host": [
														"{{url_cms}}"
													],
													"path": [
														"psu-api",
														"v2",
														"piis",
														"consent",
														"{{internal_consent_id}}",
														"authorisation",
														"{{authorisation_id}}",
														"status",
														"FAILED"
													]
												}
											},
											"response": []
										},
										{
											"name": "8.  Get Confirmation of Funds Consent Authorisation by its ID",
											"event": [
												{
													"listen": "test",
													"script": {
														"id": "dd14ca79-84ed-4330-990a-2540497d203c",
														"exec": [
															"pm.test(\"Status code is 200\", () => {",
															"    pm.response.to.have.status(200);",
															"});",
															"",
															"const jsonData = pm.response.json();",
															"",
															"pm.test(\"Authorisation id is present\", () => {",
															"    pm.expect(jsonData).to.have.property(\"authorisationId\");",
															"});",
															"",
															"pm.test(\"Redirect URLs are present\", () => {",
															"    pm.expect(jsonData).to.have.property(\"tppOkRedirectUri\");",
															"    pm.expect(jsonData).to.have.property(\"tppNokRedirectUri\");",
															"});",
															"",
															"const authorisationId = jsonData.authorisationId;",
															"pm.test(\"Authorisation id is correct\", () => {",
															"    pm.expect(authorisationId).to.eql(pm.globals.get(\"redirect_id\"));",
															"});",
															"",
															"const scaStatus = jsonData.scaStatus;",
															"pm.test(\"Authorisation is failed\", () => {",
															"    pm.expect(scaStatus).to.eql(\"failed\");",
															"});",
															""
														],
														"type": "text/javascript"
													}
												},
												{
													"listen": "prerequest",
													"script": {
														"id": "3a62e51d-f4df-4d09-bbf6-3dc1ef929f78",
														"exec": [
															""
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"method": "GET",
												"header": [],
												"url": {
													"raw": "{{protocol}}://{{url_cms}}/psu-api/v2/piis/consent/authorisation/{{authorisation_id}}",
													"protocol": "{{protocol}}",
													"host": [
														"{{url_cms}}"
													],
													"path": [
														"psu-api",
														"v2",
														"piis",
														"consent",
														"authorisation",
														"{{authorisation_id}}"
													]
												}
											},
											"response": []
										},
										{
											"name": "9. Reject PIIS consent",
											"event": [
												{
													"listen": "test",
													"script": {
														"id": "40534ce1-21da-4a37-8405-7478380fb628",
														"exec": [
															"pm.test(\"Status code is 200\", () => {",
															"    pm.response.to.have.status(200);",
															"});"
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"method": "PUT",
												"header": [
													{
														"key": "PSU-ID",
														"type": "text",
														"value": "{{psu_id_none}}"
													}
												],
												"body": {
													"mode": "raw",
													"raw": ""
												},
												"url": {
													"raw": "{{protocol}}://{{url_cms}}/psu-api/v2/piis/consent/{{internal_consent_id}}/status/REJECTED",
													"protocol": "{{protocol}}",
													"host": [
														"{{url_cms}}"
													],
													"path": [
														"psu-api",
														"v2",
														"piis",
														"consent",
														"{{internal_consent_id}}",
														"status",
														"REJECTED"
													]
												}
											},
											"response": []
										},
										{
											"name": "10.  Get Confirmation of Funds Consent by its ID",
											"event": [
												{
													"listen": "test",
													"script": {
														"id": "93a348f9-d361-41da-9b3d-ccd11aadad05",
														"exec": [
															"pm.test(\"Status code is 200\", () => {",
															"    pm.response.to.have.status(200);",
															"});",
															"",
															"const jsonData = pm.response.json();",
															"",
															"const consentStatus = jsonData.consentStatus;",
															"pm.test(\"ConsentStatus is REJECTED\", () => {",
															"    pm.expect(consentStatus).to.eql(\"REJECTED\");",
															"});",
															""
														],
														"type": "text/javascript"
													}
												},
												{
													"listen": "prerequest",
													"script": {
														"id": "70e7d8c3-1538-4921-9709-372f508ee01d",
														"exec": [
															""
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"method": "GET",
												"header": [],
												"url": {
													"raw": "{{protocol}}://{{url_cms}}/psu-api/v2/piis/consent/{{internal_consent_id}}",
													"protocol": "{{protocol}}",
													"host": [
														"{{url_cms}}"
													],
													"path": [
														"psu-api",
														"v2",
														"piis",
														"consent",
														"{{internal_consent_id}}"
													]
												}
											},
											"response": []
										},
										{
											"name": "11. Get PIIS consent in XS2A",
											"event": [
												{
													"listen": "test",
													"script": {
														"id": "5984f412-0c6a-4e8b-aeb1-026dbbde9d29",
														"exec": [
															"pm.test(\"Status code is 200\", () => {",
															"    pm.response.to.have.status(200);",
															"});",
															"",
															"const jsonData = pm.response.json();",
															"",
															"pm.test(\"Account is present\", () => {",
															"   pm.expect(jsonData).to.have.property('account');",
															"});",
															"",
															"const consentStatus = jsonData.consentStatus;",
															"pm.test(\"ConsentStatus is rejected\", () => {",
															"    pm.expect(consentStatus).to.eql(\"rejected\");",
															"});",
															""
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"auth": {
													"type": "bearer",
													"bearer": [
														{
															"key": "token",
															"value": "{{ledgersBearerToken}}",
															"type": "string"
														}
													]
												},
												"method": "GET",
												"header": [
													{
														"key": "X-Request-ID",
														"type": "text",
														"value": "{{x_request_id}}"
													}
												],
												"url": {
													"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds/{{piis_consent_id}}",
													"protocol": "{{protocol}}",
													"host": [
														"{{url_xs2a}}"
													],
													"path": [
														"v2",
														"consents",
														"confirmation-of-funds",
														"{{piis_consent_id}}"
													]
												}
											},
											"response": []
										}
									],
									"protocolProfileBehavior": {},
									"_postman_isSubFolder": true
								}
							],
							"protocolProfileBehavior": {},
							"_postman_isSubFolder": true
						},
						{
							"name": "Embedded",
							"item": [
								{
									"name": "Implicit single sca",
									"item": [
										{
											"name": "1. Set embedded SCA approach",
											"event": [
												{
													"listen": "test",
													"script": {
														"id": "6269b8b8-d605-4a46-94b6-db64e16b1f50",
														"exec": [
															"pm.test(\"Status code is 200\", () => {",
															"    pm.response.to.have.status(200);",
															"});",
															""
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"method": "PUT",
												"header": [
													{
														"key": "Content-Type",
														"name": "Content-Type",
														"type": "text",
														"value": "application/json"
													}
												],
												"body": {
													"mode": "raw",
													"raw": "[\n  \"EMBEDDED\",\n  \"REDIRECT\",\n  \"DECOUPLED\"\n]"
												},
												"url": {
													"raw": "{{protocol}}://{{url_aspsp_profile}}/api/v1/aspsp-profile/for-debug/sca-approaches",
													"protocol": "{{protocol}}",
													"host": [
														"{{url_aspsp_profile}}"
													],
													"path": [
														"api",
														"v1",
														"aspsp-profile",
														"for-debug",
														"sca-approaches"
													]
												}
											},
											"response": []
										},
										{
											"name": "2. Enable PIIS consent support in ASPSP profile",
											"event": [
												{
													"listen": "test",
													"script": {
														"id": "3b15d243-17ef-484f-9dd6-10bb20d58116",
														"exec": [
															"pm.test(\"Status code is 200\", () => {",
															"    pm.response.to.have.status(200);",
															"});",
															""
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"method": "PUT",
												"header": [
													{
														"key": "Content-Type",
														"name": "Content-Type",
														"type": "text",
														"value": "application/json"
													}
												],
												"body": {
													"mode": "raw",
													"raw": "{\n    \"ais\": {\n        \"consentTypes\": {\n            \"bankOfferedConsentSupported\": false,\n            \"globalConsentSupported\": false,\n            \"availableAccountsConsentSupported\": true,\n            \"accountAccessFrequencyPerDay\": 4,\n            \"notConfirmedConsentExpirationTimeMs\": 86400000,\n            \"maxConsentValidityDays\": 0\n        },\n        \"redirectLinkToOnlineBanking\": {\n            \"aisRedirectUrlToAspsp\": \"http://localhost:4200/ais/{redirect-id}/{encrypted-consent-id}\"\n        },\n        \"transactionParameters\": {\n            \"availableBookingStatuses\": [\n                \"BOOKED\",\n                \"PENDING\"\n            ],\n            \"transactionsWithoutBalancesSupported\": false,\n            \"supportedTransactionApplicationTypes\": [\n            \t\"application/json\"\n            ]\n        },\n        \"deltaReportSettings\": {\n            \"entryReferenceFromSupported\": false,\n            \"deltaListSupported\": false\n        },\n        \"scaRequirementsForOneTimeConsents\": {\n            \"scaByOneTimeAvailableAccountsConsentRequired\": true,\n            \"scaByOneTimeGlobalConsentRequired\": true\n        }\n    },\n    \"pis\": {\n        \"supportedPaymentTypeAndProductMatrix\": {\n            \"payments\": [\n                \"sepa-credit-transfers\",\n                \"instant-sepa-credit-transfers\"\n            ]\n        },\n        \"maxTransactionValidityDays\": 0,\n        \"notConfirmedPaymentExpirationTimeMs\": 86400000,\n        \"paymentCancellationAuthorisationMandated\": false,\n        \"redirectLinkToOnlineBanking\": {\n            \"pisRedirectUrlToAspsp\": \"http://localhost:4200/pis/{redirect-id}/{encrypted-payment-id}\",\n            \"pisPaymentCancellationRedirectUrlToAspsp\": \"http://localhost:4200/pis/cancellation/{redirect-id}/{encrypted-payment-id}\",\n            \"paymentCancellationRedirectUrlExpirationTimeMs\": 600000\n        }\n    },\n    \"piis\": {\n        \"piisConsentSupported\": \"TPP_CONSENT_SUPPORTED\",\n                \"redirectLinkToOnlineBanking\": {\n            \"piisRedirectUrlToAspsp\": \"http://localhost:4200/piis/{redirect-id}/{encrypted-consent-id}\"\n        }\n    },\n    \"common\": {\n        \"scaRedirectFlow\": \"REDIRECT\",\n        \"startAuthorisationMode\": \"implicit\",\n        \"tppSignatureRequired\": false,\n        \"psuInInitialRequestMandated\": false,\n        \"redirectUrlExpirationTimeMs\": 600000,\n        \"authorisationExpirationTimeMs\": 86400000,\n        \"forceXs2aBaseLinksUrl\": false,\n        \"xs2aBaseLinksUrl\": \"http://myhost.com/\",\n        \"supportedAccountReferenceFields\": [\n            \"IBAN\"\n        ],\n        \"multicurrencyAccountLevelSupported\": \"SUBACCOUNT\",\n        \"aisPisSessionsSupported\": false,\n        \"signingBasketSupported\": false,\n        \"aspspNotificationsSupported\": [\n        \t\"NONE\"\t\n        ]\n    }\n}",
													"options": {
														"raw": {
															"language": "json"
														}
													}
												},
												"url": {
													"raw": "{{protocol}}://{{url_aspsp_profile}}/api/v1/aspsp-profile/for-debug/aspsp-settings",
													"protocol": "{{protocol}}",
													"host": [
														"{{url_aspsp_profile}}"
													],
													"path": [
														"api",
														"v1",
														"aspsp-profile",
														"for-debug",
														"aspsp-settings"
													]
												}
											},
											"response": []
										},
										{
											"name": "3. Create PIIS consent in XS2A",
											"event": [
												{
													"listen": "test",
													"script": {
														"id": "b4e7f769-800a-43ab-b567-b0fd031feb18",
														"exec": [
															"pm.test(\"Status code is 201\", () => {",
															"    pm.response.to.have.status(201);",
															"});",
															"",
															"const jsonData = pm.response.json();",
															"",
															"pm.test(\"PIIS consent ID exists\", () => {",
															"   pm.expect(jsonData).to.have.property('consentId');",
															"});",
															"",
															"pm.globals.set(\"piis_consent_id\", jsonData.consentId);",
															"",
															"pm.test(\"Update PSU authentication link exists\", () => {",
															"    pm.expect(jsonData).to.have.property('_links');",
															"    const _links = jsonData._links;",
															"    ",
															"    var updatePsuAuthentication = _links.updatePsuAuthentication.href;",
															"",
															"    if (updatePsuAuthentication === undefined) {",
															"       pm.expect().fail();",
															"    }",
															"});",
															"",
															"pm.globals.set(\"updatePsuAuthentication\", jsonData._links.updatePsuAuthentication);",
															"",
															"const authorisationId = jsonData._links.updatePsuAuthentication.href.split('/').pop();",
															"pm.globals.set(\"piis_authorisation_id\", authorisationId);"
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"method": "POST",
												"header": [
													{
														"key": "psu-id",
														"type": "text",
														"value": "{{psu_id_single}}"
													},
													{
														"key": "Content-Type",
														"name": "Content-Type",
														"type": "text",
														"value": "application/json"
													},
													{
														"key": "X-Request-ID",
														"value": "{{x_request_id}}",
														"type": "text"
													},
													{
														"key": "TPP-Explicit-Authorisation-Preferred",
														"value": "true",
														"type": "text"
													}
												],
												"body": {
													"mode": "raw",
													"raw": "{\n  \"account\": {\n    \"iban\": \"{{iban_single}}\",\n    \"currency\": \"EUR\"\n  },\n  \"cardNumber\": \"cardNumber\",\n  \"cardExpiryDate\": \"2030-10-10\",\n  \"cardInformation\": \"cardInformation\",\n  \"registrationInformation\": \"registrationInformation\"\n\n}",
													"options": {
														"raw": {}
													}
												},
												"url": {
													"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds",
													"protocol": "{{protocol}}",
													"host": [
														"{{url_xs2a}}"
													],
													"path": [
														"v2",
														"consents",
														"confirmation-of-funds"
													]
												}
											},
											"response": []
										},
										{
											"name": "4. Update PSU Data for consents",
											"event": [
												{
													"listen": "test",
													"script": {
														"id": "e32f79db-6524-4ea0-bfbd-7d89bed4df0f",
														"exec": [
															"pm.test(\"Status code is 200\", () => {",
															"    pm.response.to.have.status(200);",
															"});"
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"method": "PUT",
												"header": [
													{
														"key": "Accept",
														"value": "application/json"
													},
													{
														"key": "Content-Type",
														"value": "application/json"
													},
													{
														"key": "PSU-ID",
														"value": "{{psu_id_single}}"
													},
													{
														"key": "X-Request-ID",
														"value": "{{x_request_id}}"
													}
												],
												"body": {
													"mode": "raw",
													"raw": "{\n\t\"psuData\": {\n\t\t\"password\": \"{{psu_id_password}}\"\n\t}\n}"
												},
												"url": {
													"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds/{{piis_consent_id}}/authorisations/{{piis_authorisation_id}}",
													"protocol": "{{protocol}}",
													"host": [
														"{{url_xs2a}}"
													],
													"path": [
														"v2",
														"consents",
														"confirmation-of-funds",
														"{{piis_consent_id}}",
														"authorisations",
														"{{piis_authorisation_id}}"
													]
												},
												"description": "This method update PSU data on the consents  resource if needed.  It may authorise a consent within the Embedded SCA Approach where needed.  Independently from the SCA Approach it supports e.g. the selection of  the authentication method and a non-SCA PSU authentication.  This methods updates PSU data on the cancellation authorisation resource if needed.   There are several possible Update PSU Data requests in the context of a consent request if needed,  which depends on the SCA approach:  * Redirect SCA Approach:   A specific Update PSU Data Request is applicable for      * the selection of authentication methods, before choosing the actual SCA approach. * Decoupled SCA Approach:   A specific Update PSU Data Request is only applicable for   * adding the PSU Identification, if not provided yet in the Payment Initiation Request or the Account Information Consent Request, or if no OAuth2 access token is used, or   * the selection of authentication methods. * Embedded SCA Approach:    The Update PSU Data Request might be used    * to add credentials as a first factor authentication data of the PSU and   * to select the authentication method and   * transaction authorisation.  The SCA Approach might depend on the chosen SCA method.  For that reason, the following possible Update PSU Data request can apply to all SCA approaches:  * Select an SCA method in case of several SCA methods are available for the customer.  There are the following request types on this access path:   * Update PSU Identification   * Update PSU Authentication   * Select PSU Autorization Method      WARNING: This method need a reduced header,      therefore many optional elements are not present.      Maybe in a later version the access path will change.   * Transaction Authorisation     WARNING: This method need a reduced header,      therefore many optional elements are not present.      Maybe in a later version the access path will change. "
											},
											"response": []
										},
										{
											"name": "5. Update PSU Data for consents finalization",
											"event": [
												{
													"listen": "test",
													"script": {
														"id": "6bf2ab81-8d14-452d-80e8-c2e569218a30",
														"exec": [
															"pm.test('Status code is 200', () => {",
															"   pm.response.to.have.status(200);",
															"});",
															"",
															"const jsonData = pm.response.json();",
															"",
															"pm.test('Sca status is finalised', () => {",
															"   pm.expect(jsonData.scaStatus).to.eql('finalised');",
															"});",
															"",
															"pm.test(\"Select scaStatus link exists\", () => {",
															"    pm.expect(jsonData).to.have.property('_links');",
															"    const _links = jsonData._links;",
															"    pm.expect(_links).to.have.property('scaStatus');",
															"});"
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"method": "PUT",
												"header": [
													{
														"key": "Accept",
														"value": "application/json"
													},
													{
														"key": "Content-Type",
														"value": "application/json"
													},
													{
														"key": "PSU-ID",
														"value": "{{psu_id_single}}"
													},
													{
														"key": "X-Request-ID",
														"value": "{{x_request_id}}"
													}
												],
												"body": {
													"mode": "raw",
													"raw": "{\n\t\"scaAuthenticationData\": \"{{tanNumber}}\"\n}"
												},
												"url": {
													"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds/{{piis_consent_id}}/authorisations/{{piis_authorisation_id}}",
													"protocol": "{{protocol}}",
													"host": [
														"{{url_xs2a}}"
													],
													"path": [
														"v2",
														"consents",
														"confirmation-of-funds",
														"{{piis_consent_id}}",
														"authorisations",
														"{{piis_authorisation_id}}"
													]
												},
												"description": "This method update PSU data on the consents  resource if needed.  It may authorise a consent within the Embedded SCA Approach where needed.  Independently from the SCA Approach it supports e.g. the selection of  the authentication method and a non-SCA PSU authentication.  This methods updates PSU data on the cancellation authorisation resource if needed.   There are several possible Update PSU Data requests in the context of a consent request if needed,  which depends on the SCA approach:  * Redirect SCA Approach:   A specific Update PSU Data Request is applicable for      * the selection of authentication methods, before choosing the actual SCA approach. * Decoupled SCA Approach:   A specific Update PSU Data Request is only applicable for   * adding the PSU Identification, if not provided yet in the Payment Initiation Request or the Account Information Consent Request, or if no OAuth2 access token is used, or   * the selection of authentication methods. * Embedded SCA Approach:    The Update PSU Data Request might be used    * to add credentials as a first factor authentication data of the PSU and   * to select the authentication method and   * transaction authorisation.  The SCA Approach might depend on the chosen SCA method.  For that reason, the following possible Update PSU Data request can apply to all SCA approaches:  * Select an SCA method in case of several SCA methods are available for the customer.  There are the following request types on this access path:   * Update PSU Identification   * Update PSU Authentication   * Select PSU Autorization Method      WARNING: This method need a reduced header,      therefore many optional elements are not present.      Maybe in a later version the access path will change.   * Transaction Authorisation     WARNING: This method need a reduced header,      therefore many optional elements are not present.      Maybe in a later version the access path will change. "
											},
											"response": []
										},
										{
											"name": "6. Get PIIS consent in XS2A",
											"event": [
												{
													"listen": "test",
													"script": {
														"id": "0083be13-e793-4a08-8e75-2e0e643b786b",
														"exec": [
															"pm.test(\"Status code is 200\", () => {",
															"    pm.response.to.have.status(200);",
															"});",
															"",
															"const jsonData = pm.response.json();",
															"",
															"pm.test(\"Account is present\", () => {",
															"   pm.expect(jsonData).to.have.property('account');",
															"});"
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"auth": {
													"type": "bearer",
													"bearer": [
														{
															"key": "token",
															"value": "{{ledgersBearerToken}}",
															"type": "string"
														}
													]
												},
												"method": "GET",
												"header": [
													{
														"key": "X-Request-ID",
														"value": "{{x_request_id}}",
														"type": "text"
													}
												],
												"url": {
													"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds/{{piis_consent_id}}",
													"protocol": "{{protocol}}",
													"host": [
														"{{url_xs2a}}"
													],
													"path": [
														"v2",
														"consents",
														"confirmation-of-funds",
														"{{piis_consent_id}}"
													]
												}
											},
											"response": []
										},
										{
											"name": "7. Get PIIS consent status in XS2A",
											"event": [
												{
													"listen": "test",
													"script": {
														"id": "1baad27c-7b1a-4ae5-9c00-6edc720979e1",
														"exec": [
															"pm.test(\"Status code is 200\", () => {",
															"    pm.response.to.have.status(200);",
															"});",
															"",
															"const jsonData = pm.response.json();",
															"",
															"pm.test(\"ConsentStatus is present\", () => {",
															"   pm.expect(jsonData).to.have.property('consentStatus');",
															"});",
															""
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"auth": {
													"type": "bearer",
													"bearer": [
														{
															"key": "token",
															"value": "{{ledgersBearerToken}}",
															"type": "string"
														}
													]
												},
												"method": "GET",
												"header": [
													{
														"key": "X-Request-ID",
														"type": "text",
														"value": "{{x_request_id}}"
													}
												],
												"url": {
													"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds/{{piis_consent_id}}/status",
													"protocol": "{{protocol}}",
													"host": [
														"{{url_xs2a}}"
													],
													"path": [
														"v2",
														"consents",
														"confirmation-of-funds",
														"{{piis_consent_id}}",
														"status"
													]
												}
											},
											"response": []
										},
										{
											"name": "8. Read the SCA status of the consent authorisation",
											"event": [
												{
													"listen": "test",
													"script": {
														"id": "a2d269f8-a8a7-4303-a64e-6ae6327b63b6",
														"exec": [
															"pm.test(\"Status code is 200\", () => {",
															"    pm.response.to.have.status(200);",
															"});"
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"method": "GET",
												"header": [
													{
														"key": "Accept",
														"value": "application/json"
													},
													{
														"key": "X-Request-ID",
														"value": "{{x_request_id}}"
													}
												],
												"url": {
													"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds/{{consent_id}}/authorisations/{{authorisation_id}}",
													"protocol": "{{protocol}}",
													"host": [
														"{{url_xs2a}}"
													],
													"path": [
														"v2",
														"consents",
														"confirmation-of-funds",
														"{{consent_id}}",
														"authorisations",
														"{{authorisation_id}}"
													]
												},
												"description": "This method returns the SCA status of a consent initiation's authorisation sub-resource. "
											},
											"response": []
										},
										{
											"name": "9.  Get consent authorisation sub-resources request",
											"event": [
												{
													"listen": "test",
													"script": {
														"id": "06465705-e51e-4731-81b0-fd2e54b8ecfe",
														"exec": [
															"pm.test(\"Status code is 200\", () => {",
															"    pm.response.to.have.status(200);",
															"});"
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"method": "GET",
												"header": [
													{
														"key": "Accept",
														"value": "application/json"
													},
													{
														"key": "X-Request-ID",
														"value": "{{x_request_id}}"
													}
												],
												"url": {
													"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds/{{consent_id}}/authorisations/",
													"protocol": "{{protocol}}",
													"host": [
														"{{url_xs2a}}"
													],
													"path": [
														"v2",
														"consents",
														"confirmation-of-funds",
														"{{consent_id}}",
														"authorisations",
														""
													]
												},
												"description": "This method returns the SCA status of a consent initiation's authorisation sub-resource. "
											},
											"response": []
										},
										{
											"name": "10. Get PIIS consent status in XS2A valid",
											"event": [
												{
													"listen": "test",
													"script": {
														"id": "84a65f1f-957e-40b2-92b3-f6be3c58c04d",
														"exec": [
															"pm.test(\"Status code is 200\", () => {",
															"    pm.response.to.have.status(200);",
															"});",
															"",
															"const jsonData = pm.response.json();",
															"",
															"pm.test(\"ConsentStatus is present\", () => {",
															"   pm.expect(jsonData).to.have.property('consentStatus');",
															"});",
															"",
															"pm.test(\"ConsentStatus is valid\", () => {",
															"   pm.expect(jsonData.consentStatus).to.be.equal('valid');",
															"});"
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"auth": {
													"type": "bearer",
													"bearer": [
														{
															"key": "token",
															"value": "{{ledgersBearerToken}}",
															"type": "string"
														}
													]
												},
												"method": "GET",
												"header": [
													{
														"key": "X-Request-ID",
														"type": "text",
														"value": "{{x_request_id}}"
													}
												],
												"url": {
													"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds/{{piis_consent_id}}/status",
													"protocol": "{{protocol}}",
													"host": [
														"{{url_xs2a}}"
													],
													"path": [
														"v2",
														"consents",
														"confirmation-of-funds",
														"{{piis_consent_id}}",
														"status"
													]
												}
											},
											"response": []
										}
									],
									"protocolProfileBehavior": {},
									"_postman_isSubFolder": true
								},
								{
									"name": "Explicit",
									"item": [
										{
											"name": "Explicit multiple sca psu id not mandated",
											"item": [
												{
													"name": "1. Set embedded SCA approach",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "20b6f340-8b04-48ef-822c-93886398e2bd",
																"exec": [
																	"pm.test(\"Status code is 200\", () => {",
																	"    pm.response.to.have.status(200);",
																	"});",
																	""
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "PUT",
														"header": [
															{
																"key": "Content-Type",
																"name": "Content-Type",
																"type": "text",
																"value": "application/json"
															}
														],
														"body": {
															"mode": "raw",
															"raw": "[\n  \"EMBEDDED\",\n  \"REDIRECT\",\n  \"DECOUPLED\"\n]"
														},
														"url": {
															"raw": "{{protocol}}://{{url_aspsp_profile}}/api/v1/aspsp-profile/for-debug/sca-approaches",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_aspsp_profile}}"
															],
															"path": [
																"api",
																"v1",
																"aspsp-profile",
																"for-debug",
																"sca-approaches"
															]
														}
													},
													"response": []
												},
												{
													"name": "2. Enable PIIS consent support in ASPSP profile",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "5acbb5df-3baa-4a3e-8edd-2d8910a50630",
																"exec": [
																	"pm.test(\"Status code is 200\", () => {",
																	"    pm.response.to.have.status(200);",
																	"});",
																	""
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "PUT",
														"header": [
															{
																"key": "Content-Type",
																"name": "Content-Type",
																"type": "text",
																"value": "application/json"
															}
														],
														"body": {
															"mode": "raw",
															"raw": "{\n    \"ais\": {\n        \"consentTypes\": {\n            \"bankOfferedConsentSupported\": false,\n            \"globalConsentSupported\": false,\n            \"availableAccountsConsentSupported\": true,\n            \"accountAccessFrequencyPerDay\": 4,\n            \"notConfirmedConsentExpirationTimeMs\": 86400000,\n            \"maxConsentValidityDays\": 0\n        },\n        \"redirectLinkToOnlineBanking\": {\n            \"aisRedirectUrlToAspsp\": \"http://localhost:4200/ais/{redirect-id}/{encrypted-consent-id}\"\n        },\n        \"transactionParameters\": {\n            \"availableBookingStatuses\": [\n                \"BOOKED\",\n                \"PENDING\"\n            ],\n            \"transactionsWithoutBalancesSupported\": false,\n            \"supportedTransactionApplicationTypes\": [\n            \t\"application/json\"\n            ]\n        },\n        \"deltaReportSettings\": {\n            \"entryReferenceFromSupported\": false,\n            \"deltaListSupported\": false\n        },\n        \"scaRequirementsForOneTimeConsents\": {\n            \"scaByOneTimeAvailableAccountsConsentRequired\": true,\n            \"scaByOneTimeGlobalConsentRequired\": true\n        }\n    },\n    \"pis\": {\n        \"supportedPaymentTypeAndProductMatrix\": {\n            \"payments\": [\n                \"sepa-credit-transfers\",\n                \"instant-sepa-credit-transfers\"\n            ]\n        },\n        \"maxTransactionValidityDays\": 0,\n        \"notConfirmedPaymentExpirationTimeMs\": 86400000,\n        \"paymentCancellationAuthorisationMandated\": false,\n        \"redirectLinkToOnlineBanking\": {\n            \"pisRedirectUrlToAspsp\": \"http://localhost:4200/pis/{redirect-id}/{encrypted-payment-id}\",\n            \"pisPaymentCancellationRedirectUrlToAspsp\": \"http://localhost:4200/pis/cancellation/{redirect-id}/{encrypted-payment-id}\",\n            \"paymentCancellationRedirectUrlExpirationTimeMs\": 600000\n        }\n    },\n    \"piis\": {\n        \"piisConsentSupported\": \"TPP_CONSENT_SUPPORTED\",\n                \"redirectLinkToOnlineBanking\": {\n            \"piisRedirectUrlToAspsp\": \"http://localhost:4200/piis/{redirect-id}/{encrypted-consent-id}\"\n        }\n    },\n    \"common\": {\n        \"scaRedirectFlow\": \"REDIRECT\",\n        \"startAuthorisationMode\": \"implicit\",\n        \"tppSignatureRequired\": false,\n        \"psuInInitialRequestMandated\": false,\n        \"redirectUrlExpirationTimeMs\": 600000,\n        \"authorisationExpirationTimeMs\": 86400000,\n        \"forceXs2aBaseLinksUrl\": false,\n        \"xs2aBaseLinksUrl\": \"http://myhost.com/\",\n        \"supportedAccountReferenceFields\": [\n            \"IBAN\"\n        ],\n        \"multicurrencyAccountLevelSupported\": \"SUBACCOUNT\",\n        \"aisPisSessionsSupported\": false,\n        \"signingBasketSupported\": true,\n        \"aspspNotificationsSupported\": [\n        \t\"NONE\"\t\n        ]\n    }\n}",
															"options": {
																"raw": {
																	"language": "json"
																}
															}
														},
														"url": {
															"raw": "{{protocol}}://{{url_aspsp_profile}}/api/v1/aspsp-profile/for-debug/aspsp-settings",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_aspsp_profile}}"
															],
															"path": [
																"api",
																"v1",
																"aspsp-profile",
																"for-debug",
																"aspsp-settings"
															]
														}
													},
													"response": []
												},
												{
													"name": "3. Create PIIS consent in XS2A with psu id",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "c5f6f3bb-19d3-4ff7-9b00-affc3576d1bb",
																"exec": [
																	"pm.test(\"Status code is 201\", () => {",
																	"    pm.response.to.have.status(201);",
																	"});",
																	"",
																	"const jsonData = pm.response.json();",
																	"",
																	"pm.test(\"PIIS consent ID exists\", () => {",
																	"   pm.expect(jsonData).to.have.property('consentId');",
																	"});",
																	"",
																	"pm.test(\"PIIS consent links exists\", () => {",
																	"   pm.expect(jsonData._links).to.have.property('updatePsuAuthentication');",
																	"   pm.expect(jsonData._links).to.have.property('status');",
																	"   pm.expect(jsonData._links).to.have.property('scaStatus');",
																	"});",
																	"",
																	"pm.globals.set(\"piis_consent_id\", jsonData.consentId);",
																	"",
																	"pm.test(\"Update PSU authentication link exists\", () => {",
																	"    pm.expect(jsonData).to.have.property('_links');",
																	"    const _links = jsonData._links;",
																	"    ",
																	"    var updatePsuAuthentication = _links.updatePsuAuthentication.href;",
																	"",
																	"    if (updatePsuAuthentication === undefined) {",
																	"       pm.expect().fail();",
																	"    }",
																	"});",
																	"",
																	"pm.globals.set(\"updatePsuAuthentication\", jsonData._links.updatePsuAuthentication);",
																	"",
																	"const authorisationId = jsonData._links.updatePsuAuthentication.href.split('/').pop();",
																	"pm.globals.set(\"piis_authorisation_id\", authorisationId);"
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "POST",
														"header": [
															{
																"key": "PSU-ID",
																"value": "{{psu_id_multiple}}"
															},
															{
																"key": "Content-Type",
																"name": "Content-Type",
																"type": "text",
																"value": "application/json"
															},
															{
																"key": "X-Request-ID",
																"value": "{{x_request_id}}",
																"type": "text"
															},
															{
																"key": "TPP-Explicit-Authorisation-Preferred",
																"value": "true",
																"type": "text"
															}
														],
														"body": {
															"mode": "raw",
															"raw": "{\n  \"account\": {\n    \"iban\": \"{{iban_multiple}}\",\n    \"currency\": \"EUR\"\n  },\n  \"cardNumber\": \"cardNumber\",\n  \"cardExpiryDate\": \"2030-10-10\",\n  \"cardInformation\": \"cardInformation\",\n  \"registrationInformation\": \"registrationInformation\"\n\n}",
															"options": {
																"raw": {}
															}
														},
														"url": {
															"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_xs2a}}"
															],
															"path": [
																"v2",
																"consents",
																"confirmation-of-funds"
															]
														}
													},
													"response": []
												},
												{
													"name": "4. Start the authorisation process for a consent",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "6b3d7630-556f-4006-85f3-0dcc3dedfeb3",
																"exec": [
																	"pm.test(\"Status code is 201\", () => {",
																	"    pm.response.to.have.status(201);",
																	"});",
																	"",
																	"const jsonData = pm.response.json();",
																	"",
																	"pm.test(\"Sca status is psuIdentified\", () => {",
																	"    pm.expect(jsonData.scaStatus).to.eql('psuIdentified');",
																	"});",
																	"",
																	"pm.test(\"updatePsuAuthentication link exists\", () => {",
																	"    pm.expect(jsonData).to.have.property('_links');",
																	"    const _links = jsonData._links;",
																	"    ",
																	"    pm.expect(_links).to.have.property('updatePsuAuthentication');",
																	"});",
																	"",
																	"pm.globals.set(\"piis_authorisation_id\", jsonData.authorisationId);",
																	""
																],
																"type": "text/javascript"
															}
														},
														{
															"listen": "prerequest",
															"script": {
																"id": "d40f0f4a-6481-4c08-8e67-e6b62d94c374",
																"exec": [
																	""
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "POST",
														"header": [
															{
																"key": "Accept",
																"value": "application/json"
															},
															{
																"key": "Content-Type",
																"value": "application/json"
															},
															{
																"key": "PSU-ID",
																"value": "{{psu_id_multiple}}"
															},
															{
																"key": "X-Request-ID",
																"value": "{{x_request_id}}"
															}
														],
														"body": {
															"mode": "raw",
															"raw": ""
														},
														"url": {
															"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds/{{piis_consent_id}}/authorisations",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_xs2a}}"
															],
															"path": [
																"v2",
																"consents",
																"confirmation-of-funds",
																"{{piis_consent_id}}",
																"authorisations"
															]
														},
														"description": "Create an authorisation sub-resource and start the authorisation process of a consent.  The message might in addition transmit authentication and authorisation related data.  his method is iterated n times for a n times SCA authorisation in a  corporate context, each creating an own authorisation sub-endpoint for  the corresponding PSU authorising the consent.  The ASPSP might make the usage of this access method unnecessary,  since the related authorisation resource will be automatically created by  the ASPSP after the submission of the consent data with the first POST consents call.  The start authorisation process is a process which is needed for creating a new authorisation  or cancellation sub-resource.   This applies in the following scenarios:    * The ASPSP has indicated with an 'startAuthorisation' hyperlink in the preceding Payment      Initiation Response that an explicit start of the authorisation process is needed by the TPP.      The 'startAuthorisation' hyperlink can transport more information about data which needs to be      uploaded by using the extended forms.     * 'startAuthorisationWithPsuIdentfication',      * 'startAuthorisationWithPsuAuthentication'     * 'startAuthorisationWithAuthentciationMethodSelection'    * The related payment initiation cannot yet be executed since a multilevel SCA is mandated.   * The ASPSP has indicated with an 'startAuthorisation' hyperlink in the preceding      Payment Cancellation Response that an explicit start of the authorisation process is needed by the TPP.      The 'startAuthorisation' hyperlink can transport more information about data which needs to be uploaded      by using the extended forms as indicated above.   * The related payment cancellation request cannot be applied yet since a multilevel SCA is mandate for      executing the cancellation.   * The signing basket needs to be authorised yet. "
													},
													"response": []
												},
												{
													"name": "4. Update PSU Data for consent",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "ce1a9d8b-272c-4f54-8fb0-9bf58e811d0f",
																"exec": [
																	"pm.test('Status code is 200', () => {",
																	"   pm.response.to.have.status(200);",
																	"});",
																	"",
																	"const jsonData = pm.response.json();",
																	"",
																	"pm.test('Sca status is psuAuthenticated', () => {",
																	"   pm.expect(jsonData.scaStatus).to.eql('psuAuthenticated');",
																	"});",
																	"",
																	"pm.test(\"SelectAuthenticationMethod method link exists\", () => {",
																	"    pm.expect(jsonData).to.have.property('_links');",
																	"    const _links = jsonData._links;",
																	"    pm.expect(_links).to.have.property('selectAuthenticationMethod');",
																	"});",
																	"",
																	"pm.test(\"scaMethods exist\", () => {",
																	"    pm.expect(jsonData).to.have.property('scaMethods');",
																	"    const scaMethods = jsonData.scaMethods;",
																	"    ",
																	"    pm.expect(scaMethods.length).to.be.above(1);",
																	"    ",
																	"    pm.expect(scaMethods[0]).to.have.property('authenticationType');",
																	"    pm.expect(scaMethods[0].authenticationType) !== undefined;",
																	"    ",
																	"    pm.expect(scaMethods[0]).to.have.property('authenticationMethodId');",
																	"    pm.expect(scaMethods[0].authenticationMethodId) !== undefined;",
																	"",
																	"    pm.expect(scaMethods[0]).to.have.property('authenticationType');",
																	"    pm.expect(scaMethods[0].authenticationType) !== undefined;",
																	"    ",
																	"    pm.expect(scaMethods[0]).to.have.property('authenticationMethodId');",
																	"    pm.expect(scaMethods[0].authenticationMethodId) !== undefined;",
																	"    ",
																	"    pm.globals.set(\"authenticationMethodId\", scaMethods[0].authenticationMethodId);",
																	"});",
																	"",
																	""
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "PUT",
														"header": [
															{
																"key": "Accept",
																"value": "application/json"
															},
															{
																"key": "Content-Type",
																"value": "application/json"
															},
															{
																"key": "PSU-ID",
																"value": "{{psu_id_multiple}}"
															},
															{
																"key": "X-Request-ID",
																"value": "{{x_request_id}}"
															}
														],
														"body": {
															"mode": "raw",
															"raw": "{\n\t\"psuData\": {\n\t\t\"password\": \"{{psu_id_password}}\"\n\t}\n}"
														},
														"url": {
															"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds/{{piis_consent_id}}/authorisations/{{piis_authorisation_id}}",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_xs2a}}"
															],
															"path": [
																"v2",
																"consents",
																"confirmation-of-funds",
																"{{piis_consent_id}}",
																"authorisations",
																"{{piis_authorisation_id}}"
															]
														},
														"description": "This method update PSU data on the consents  resource if needed.  It may authorise a consent within the Embedded SCA Approach where needed.  Independently from the SCA Approach it supports e.g. the selection of  the authentication method and a non-SCA PSU authentication.  This methods updates PSU data on the cancellation authorisation resource if needed.   There are several possible Update PSU Data requests in the context of a consent request if needed,  which depends on the SCA approach:  * Redirect SCA Approach:   A specific Update PSU Data Request is applicable for      * the selection of authentication methods, before choosing the actual SCA approach. * Decoupled SCA Approach:   A specific Update PSU Data Request is only applicable for   * adding the PSU Identification, if not provided yet in the Payment Initiation Request or the Account Information Consent Request, or if no OAuth2 access token is used, or   * the selection of authentication methods. * Embedded SCA Approach:    The Update PSU Data Request might be used    * to add credentials as a first factor authentication data of the PSU and   * to select the authentication method and   * transaction authorisation.  The SCA Approach might depend on the chosen SCA method.  For that reason, the following possible Update PSU Data request can apply to all SCA approaches:  * Select an SCA method in case of several SCA methods are available for the customer.  There are the following request types on this access path:   * Update PSU Identification   * Update PSU Authentication   * Select PSU Autorization Method      WARNING: This method need a reduced header,      therefore many optional elements are not present.      Maybe in a later version the access path will change.   * Transaction Authorisation     WARNING: This method need a reduced header,      therefore many optional elements are not present.      Maybe in a later version the access path will change. "
													},
													"response": []
												},
												{
													"name": "5. Update PSU Data for consent choose SCA method",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "603a9c14-ed6c-4fe3-a915-41cce911fe2f",
																"exec": [
																	"pm.test('Status code is 200', () => {",
																	"   pm.response.to.have.status(200);",
																	"});",
																	"",
																	"const jsonData = pm.response.json();",
																	"",
																	"pm.test('Sca status is scaMethodSelected', () => {",
																	"   pm.expect(jsonData.scaStatus).to.eql('scaMethodSelected');",
																	"});",
																	"",
																	"pm.test(\"Select authoriseTransaction method link exists\", () => {",
																	"    pm.expect(jsonData).to.have.property('_links');",
																	"    const _links = jsonData._links;",
																	"    pm.expect(_links).to.have.property('authoriseTransaction');",
																	"});",
																	"",
																	"pm.test(\"Select chosenScaMethod exist\", () => {",
																	"    pm.expect(jsonData).to.have.property('chosenScaMethod');",
																	"    const chosenScaMethod = jsonData.chosenScaMethod;",
																	"    ",
																	"    pm.expect(chosenScaMethod).to.have.property('authenticationType');",
																	"    pm.expect(chosenScaMethod.authenticationType) !== undefined;",
																	"    ",
																	"    pm.expect(chosenScaMethod).to.have.property('authenticationMethodId');",
																	"    pm.expect(chosenScaMethod.authenticationMethodId) !== undefined;",
																	"});",
																	"",
																	"pm.test(\"Challenge data exist\", () => {",
																	"    pm.expect(jsonData).to.have.property('challengeData');",
																	"});",
																	""
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "PUT",
														"header": [
															{
																"key": "Accept",
																"value": "application/json"
															},
															{
																"key": "Content-Type",
																"value": "application/json"
															},
															{
																"key": "PSU-ID",
																"value": "{{psu_id_multiple}}"
															},
															{
																"key": "X-Request-ID",
																"value": "{{x_request_id}}"
															}
														],
														"body": {
															"mode": "raw",
															"raw": "{\n    \"authenticationMethodId\": \"{{authenticationMethodId}}\"        \n}"
														},
														"url": {
															"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds/{{piis_consent_id}}/authorisations/{{piis_authorisation_id}}",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_xs2a}}"
															],
															"path": [
																"v2",
																"consents",
																"confirmation-of-funds",
																"{{piis_consent_id}}",
																"authorisations",
																"{{piis_authorisation_id}}"
															]
														},
														"description": "This method update PSU data on the consents  resource if needed.  It may authorise a consent within the Embedded SCA Approach where needed.  Independently from the SCA Approach it supports e.g. the selection of  the authentication method and a non-SCA PSU authentication.  This methods updates PSU data on the cancellation authorisation resource if needed.   There are several possible Update PSU Data requests in the context of a consent request if needed,  which depends on the SCA approach:  * Redirect SCA Approach:   A specific Update PSU Data Request is applicable for      * the selection of authentication methods, before choosing the actual SCA approach. * Decoupled SCA Approach:   A specific Update PSU Data Request is only applicable for   * adding the PSU Identification, if not provided yet in the Payment Initiation Request or the Account Information Consent Request, or if no OAuth2 access token is used, or   * the selection of authentication methods. * Embedded SCA Approach:    The Update PSU Data Request might be used    * to add credentials as a first factor authentication data of the PSU and   * to select the authentication method and   * transaction authorisation.  The SCA Approach might depend on the chosen SCA method.  For that reason, the following possible Update PSU Data request can apply to all SCA approaches:  * Select an SCA method in case of several SCA methods are available for the customer.  There are the following request types on this access path:   * Update PSU Identification   * Update PSU Authentication   * Select PSU Autorization Method      WARNING: This method need a reduced header,      therefore many optional elements are not present.      Maybe in a later version the access path will change.   * Transaction Authorisation     WARNING: This method need a reduced header,      therefore many optional elements are not present.      Maybe in a later version the access path will change. "
													},
													"response": []
												},
												{
													"name": "6. Update PSU Data for consents finalization",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "6d022bfe-4c44-4d2e-832d-43b2351cf0ea",
																"exec": [
																	"pm.test('Status code is 200', () => {",
																	"   pm.response.to.have.status(200);",
																	"});",
																	"",
																	"const jsonData = pm.response.json();",
																	"",
																	"pm.test('Sca status is finalised', () => {",
																	"   pm.expect(jsonData.scaStatus).to.eql('finalised');",
																	"});",
																	"",
																	"pm.test(\"Select scaStatus link exists\", () => {",
																	"    pm.expect(jsonData).to.have.property('_links');",
																	"    const _links = jsonData._links;",
																	"    pm.expect(_links).to.have.property('scaStatus');",
																	"});"
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "PUT",
														"header": [
															{
																"key": "Accept",
																"value": "application/json"
															},
															{
																"key": "Content-Type",
																"value": "application/json"
															},
															{
																"key": "PSU-ID",
																"value": "{{psu_id_multiple}}"
															},
															{
																"key": "X-Request-ID",
																"value": "{{x_request_id}}"
															}
														],
														"body": {
															"mode": "raw",
															"raw": "{\n\t\"scaAuthenticationData\": \"{{tanNumber}}\"\n}"
														},
														"url": {
															"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds/{{piis_consent_id}}/authorisations/{{piis_authorisation_id}}",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_xs2a}}"
															],
															"path": [
																"v2",
																"consents",
																"confirmation-of-funds",
																"{{piis_consent_id}}",
																"authorisations",
																"{{piis_authorisation_id}}"
															]
														},
														"description": "This method update PSU data on the consents  resource if needed.  It may authorise a consent within the Embedded SCA Approach where needed.  Independently from the SCA Approach it supports e.g. the selection of  the authentication method and a non-SCA PSU authentication.  This methods updates PSU data on the cancellation authorisation resource if needed.   There are several possible Update PSU Data requests in the context of a consent request if needed,  which depends on the SCA approach:  * Redirect SCA Approach:   A specific Update PSU Data Request is applicable for      * the selection of authentication methods, before choosing the actual SCA approach. * Decoupled SCA Approach:   A specific Update PSU Data Request is only applicable for   * adding the PSU Identification, if not provided yet in the Payment Initiation Request or the Account Information Consent Request, or if no OAuth2 access token is used, or   * the selection of authentication methods. * Embedded SCA Approach:    The Update PSU Data Request might be used    * to add credentials as a first factor authentication data of the PSU and   * to select the authentication method and   * transaction authorisation.  The SCA Approach might depend on the chosen SCA method.  For that reason, the following possible Update PSU Data request can apply to all SCA approaches:  * Select an SCA method in case of several SCA methods are available for the customer.  There are the following request types on this access path:   * Update PSU Identification   * Update PSU Authentication   * Select PSU Autorization Method      WARNING: This method need a reduced header,      therefore many optional elements are not present.      Maybe in a later version the access path will change.   * Transaction Authorisation     WARNING: This method need a reduced header,      therefore many optional elements are not present.      Maybe in a later version the access path will change. "
													},
													"response": []
												},
												{
													"name": "7. Get PIIS consent status in XS2A valid",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "92fd836d-f628-45bd-8f74-702eed4521e4",
																"exec": [
																	"pm.test(\"Status code is 200\", () => {",
																	"    pm.response.to.have.status(200);",
																	"});",
																	"",
																	"const jsonData = pm.response.json();",
																	"",
																	"pm.test(\"ConsentStatus is present\", () => {",
																	"   pm.expect(jsonData).to.have.property('consentStatus');",
																	"});",
																	"",
																	"pm.test(\"ConsentStatus is valid\", () => {",
																	"   pm.expect(jsonData.consentStatus).to.be.equal('valid');",
																	"});"
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"auth": {
															"type": "bearer",
															"bearer": [
																{
																	"key": "token",
																	"value": "{{ledgersBearerToken}}",
																	"type": "string"
																}
															]
														},
														"method": "GET",
														"header": [
															{
																"key": "X-Request-ID",
																"type": "text",
																"value": "{{x_request_id}}"
															}
														],
														"url": {
															"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds/{{piis_consent_id}}/status",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_xs2a}}"
															],
															"path": [
																"v2",
																"consents",
																"confirmation-of-funds",
																"{{piis_consent_id}}",
																"status"
															]
														}
													},
													"response": []
												}
											],
											"protocolProfileBehavior": {},
											"_postman_isSubFolder": true
										},
										{
											"name": "Explicit multiple sca psu id mandated",
											"item": [
												{
													"name": "1. Set embedded SCA approach",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "50554560-0dc5-4a0e-aa83-86cb1f0136a1",
																"exec": [
																	"pm.test(\"Status code is 200\", () => {",
																	"    pm.response.to.have.status(200);",
																	"});",
																	""
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "PUT",
														"header": [
															{
																"key": "Content-Type",
																"name": "Content-Type",
																"type": "text",
																"value": "application/json"
															}
														],
														"body": {
															"mode": "raw",
															"raw": "[\n  \"EMBEDDED\",\n  \"REDIRECT\",\n  \"DECOUPLED\"\n]"
														},
														"url": {
															"raw": "{{protocol}}://{{url_aspsp_profile}}/api/v1/aspsp-profile/for-debug/sca-approaches",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_aspsp_profile}}"
															],
															"path": [
																"api",
																"v1",
																"aspsp-profile",
																"for-debug",
																"sca-approaches"
															]
														}
													},
													"response": []
												},
												{
													"name": "2. Enable PIIS consent support in ASPSP profile",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "1608a067-6e7b-4f8e-af34-7ea1e26b4c4e",
																"exec": [
																	"pm.test(\"Status code is 200\", () => {",
																	"    pm.response.to.have.status(200);",
																	"});",
																	""
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "PUT",
														"header": [
															{
																"key": "Content-Type",
																"name": "Content-Type",
																"type": "text",
																"value": "application/json"
															}
														],
														"body": {
															"mode": "raw",
															"raw": "{\n    \"ais\": {\n        \"consentTypes\": {\n            \"bankOfferedConsentSupported\": false,\n            \"globalConsentSupported\": false,\n            \"availableAccountsConsentSupported\": true,\n            \"accountAccessFrequencyPerDay\": 4,\n            \"notConfirmedConsentExpirationTimeMs\": 86400000,\n            \"maxConsentValidityDays\": 0\n        },\n        \"redirectLinkToOnlineBanking\": {\n            \"aisRedirectUrlToAspsp\": \"http://localhost:4200/ais/{redirect-id}/{encrypted-consent-id}\"\n        },\n        \"transactionParameters\": {\n            \"availableBookingStatuses\": [\n                \"BOOKED\",\n                \"PENDING\"\n            ],\n            \"transactionsWithoutBalancesSupported\": false,\n            \"supportedTransactionApplicationTypes\": [\n            \t\"application/json\"\n            ]\n        },\n        \"deltaReportSettings\": {\n            \"entryReferenceFromSupported\": false,\n            \"deltaListSupported\": false\n        },\n        \"scaRequirementsForOneTimeConsents\": {\n            \"scaByOneTimeAvailableAccountsConsentRequired\": true,\n            \"scaByOneTimeGlobalConsentRequired\": true\n        }\n    },\n    \"pis\": {\n        \"supportedPaymentTypeAndProductMatrix\": {\n            \"payments\": [\n                \"sepa-credit-transfers\",\n                \"instant-sepa-credit-transfers\"\n            ]\n        },\n        \"maxTransactionValidityDays\": 0,\n        \"notConfirmedPaymentExpirationTimeMs\": 86400000,\n        \"paymentCancellationAuthorisationMandated\": false,\n        \"redirectLinkToOnlineBanking\": {\n            \"pisRedirectUrlToAspsp\": \"http://localhost:4200/pis/{redirect-id}/{encrypted-payment-id}\",\n            \"pisPaymentCancellationRedirectUrlToAspsp\": \"http://localhost:4200/pis/cancellation/{redirect-id}/{encrypted-payment-id}\",\n            \"paymentCancellationRedirectUrlExpirationTimeMs\": 600000\n        }\n    },\n    \"piis\": {\n        \"piisConsentSupported\": \"TPP_CONSENT_SUPPORTED\",\n                \"redirectLinkToOnlineBanking\": {\n            \"piisRedirectUrlToAspsp\": \"http://localhost:4200/piis/{redirect-id}/{encrypted-consent-id}\"\n        }\n    },\n    \"common\": {\n        \"scaRedirectFlow\": \"REDIRECT\",\n        \"startAuthorisationMode\": \"implicit\",\n        \"tppSignatureRequired\": false,\n        \"psuInInitialRequestMandated\": true,\n        \"redirectUrlExpirationTimeMs\": 600000,\n        \"authorisationExpirationTimeMs\": 86400000,\n        \"forceXs2aBaseLinksUrl\": false,\n        \"xs2aBaseLinksUrl\": \"http://myhost.com/\",\n        \"supportedAccountReferenceFields\": [\n            \"IBAN\"\n        ],\n        \"multicurrencyAccountLevelSupported\": \"SUBACCOUNT\",\n        \"aisPisSessionsSupported\": false,\n        \"signingBasketSupported\": true,\n        \"aspspNotificationsSupported\": [\n        \t\"NONE\"\t\n        ]\n    }\n}",
															"options": {
																"raw": {
																	"language": "json"
																}
															}
														},
														"url": {
															"raw": "{{protocol}}://{{url_aspsp_profile}}/api/v1/aspsp-profile/for-debug/aspsp-settings",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_aspsp_profile}}"
															],
															"path": [
																"api",
																"v1",
																"aspsp-profile",
																"for-debug",
																"aspsp-settings"
															]
														}
													},
													"response": []
												},
												{
													"name": "3. Create PIIS consent in XS2A with psu id",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "c15cc7c4-a53a-4242-8012-d0dac4ecc5f5",
																"exec": [
																	"pm.test(\"Status code is 201\", () => {",
																	"    pm.response.to.have.status(201);",
																	"});",
																	"",
																	"const jsonData = pm.response.json();",
																	"",
																	"pm.test(\"PIIS consent ID exists\", () => {",
																	"   pm.expect(jsonData).to.have.property('consentId');",
																	"});",
																	"",
																	"pm.test(\"PIIS consent links exists\", () => {",
																	"   pm.expect(jsonData._links).to.have.property('updatePsuAuthentication');",
																	"   pm.expect(jsonData._links).to.have.property('status');",
																	"   pm.expect(jsonData._links).to.have.property('scaStatus');",
																	"});",
																	"",
																	"pm.globals.set(\"piis_consent_id\", jsonData.consentId);",
																	"",
																	"pm.test(\"Update PSU authentication link exists\", () => {",
																	"    pm.expect(jsonData).to.have.property('_links');",
																	"    const _links = jsonData._links;",
																	"    ",
																	"    var updatePsuAuthentication = _links.updatePsuAuthentication.href;",
																	"",
																	"    if (updatePsuAuthentication === undefined) {",
																	"       pm.expect().fail();",
																	"    }",
																	"});",
																	"",
																	"pm.globals.set(\"updatePsuAuthentication\", jsonData._links.updatePsuAuthentication);",
																	"",
																	"const authorisationId = jsonData._links.updatePsuAuthentication.href.split('/').pop();",
																	"pm.globals.set(\"piis_authorisation_id\", authorisationId);"
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "POST",
														"header": [
															{
																"key": "PSU-ID",
																"value": "{{psu_id_multiple}}"
															},
															{
																"key": "Content-Type",
																"name": "Content-Type",
																"type": "text",
																"value": "application/json"
															},
															{
																"key": "X-Request-ID",
																"value": "{{x_request_id}}",
																"type": "text"
															},
															{
																"key": "TPP-Explicit-Authorisation-Preferred",
																"value": "true",
																"type": "text"
															}
														],
														"body": {
															"mode": "raw",
															"raw": "{\n  \"account\": {\n    \"iban\": \"{{iban_multiple}}\",\n    \"currency\": \"EUR\"\n  },\n  \"cardNumber\": \"cardNumber\",\n  \"cardExpiryDate\": \"2030-10-10\",\n  \"cardInformation\": \"cardInformation\",\n  \"registrationInformation\": \"registrationInformation\"\n\n}",
															"options": {
																"raw": {}
															}
														},
														"url": {
															"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_xs2a}}"
															],
															"path": [
																"v2",
																"consents",
																"confirmation-of-funds"
															]
														}
													},
													"response": []
												},
												{
													"name": "4. Start the authorisation process for a consent",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "9453f451-f026-4f63-8838-ff0004fead0f",
																"exec": [
																	"pm.test(\"Status code is 201\", () => {",
																	"    pm.response.to.have.status(201);",
																	"});",
																	"",
																	"const jsonData = pm.response.json();",
																	"",
																	"pm.test(\"Sca status is psuIdentified\", () => {",
																	"    pm.expect(jsonData.scaStatus).to.eql('psuIdentified');",
																	"});",
																	"",
																	"pm.test(\"updatePsuAuthentication link exists\", () => {",
																	"    pm.expect(jsonData).to.have.property('_links');",
																	"    const _links = jsonData._links;",
																	"    ",
																	"    pm.expect(_links).to.have.property('updatePsuAuthentication');",
																	"});",
																	"",
																	"pm.globals.set(\"piis_authorisation_id\", jsonData.authorisationId);",
																	""
																],
																"type": "text/javascript"
															}
														},
														{
															"listen": "prerequest",
															"script": {
																"id": "e9a549f9-9028-46c7-b3ad-ce3095e56535",
																"exec": [
																	""
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "POST",
														"header": [
															{
																"key": "Accept",
																"value": "application/json"
															},
															{
																"key": "Content-Type",
																"value": "application/json"
															},
															{
																"key": "PSU-ID",
																"value": "{{psu_id_multiple}}"
															},
															{
																"key": "X-Request-ID",
																"value": "{{x_request_id}}"
															}
														],
														"body": {
															"mode": "raw",
															"raw": ""
														},
														"url": {
															"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds/{{piis_consent_id}}/authorisations",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_xs2a}}"
															],
															"path": [
																"v2",
																"consents",
																"confirmation-of-funds",
																"{{piis_consent_id}}",
																"authorisations"
															]
														},
														"description": "Create an authorisation sub-resource and start the authorisation process of a consent.  The message might in addition transmit authentication and authorisation related data.  his method is iterated n times for a n times SCA authorisation in a  corporate context, each creating an own authorisation sub-endpoint for  the corresponding PSU authorising the consent.  The ASPSP might make the usage of this access method unnecessary,  since the related authorisation resource will be automatically created by  the ASPSP after the submission of the consent data with the first POST consents call.  The start authorisation process is a process which is needed for creating a new authorisation  or cancellation sub-resource.   This applies in the following scenarios:    * The ASPSP has indicated with an 'startAuthorisation' hyperlink in the preceding Payment      Initiation Response that an explicit start of the authorisation process is needed by the TPP.      The 'startAuthorisation' hyperlink can transport more information about data which needs to be      uploaded by using the extended forms.     * 'startAuthorisationWithPsuIdentfication',      * 'startAuthorisationWithPsuAuthentication'     * 'startAuthorisationWithAuthentciationMethodSelection'    * The related payment initiation cannot yet be executed since a multilevel SCA is mandated.   * The ASPSP has indicated with an 'startAuthorisation' hyperlink in the preceding      Payment Cancellation Response that an explicit start of the authorisation process is needed by the TPP.      The 'startAuthorisation' hyperlink can transport more information about data which needs to be uploaded      by using the extended forms as indicated above.   * The related payment cancellation request cannot be applied yet since a multilevel SCA is mandate for      executing the cancellation.   * The signing basket needs to be authorised yet. "
													},
													"response": []
												},
												{
													"name": "4. Update PSU Data for consent",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "b6aca047-bdc6-4c94-88ac-7b8ee7b41d78",
																"exec": [
																	"pm.test('Status code is 200', () => {",
																	"   pm.response.to.have.status(200);",
																	"});",
																	"",
																	"const jsonData = pm.response.json();",
																	"",
																	"pm.test('Sca status is psuAuthenticated', () => {",
																	"   pm.expect(jsonData.scaStatus).to.eql('psuAuthenticated');",
																	"});",
																	"",
																	"pm.test(\"SelectAuthenticationMethod method link exists\", () => {",
																	"    pm.expect(jsonData).to.have.property('_links');",
																	"    const _links = jsonData._links;",
																	"    pm.expect(_links).to.have.property('selectAuthenticationMethod');",
																	"});",
																	"",
																	"pm.test(\"scaMethods exist\", () => {",
																	"    pm.expect(jsonData).to.have.property('scaMethods');",
																	"    const scaMethods = jsonData.scaMethods;",
																	"    ",
																	"    pm.expect(scaMethods.length).to.be.above(1);",
																	"    ",
																	"    pm.expect(scaMethods[0]).to.have.property('authenticationType');",
																	"    pm.expect(scaMethods[0].authenticationType) !== undefined;",
																	"    ",
																	"    pm.expect(scaMethods[0]).to.have.property('authenticationMethodId');",
																	"    pm.expect(scaMethods[0].authenticationMethodId) !== undefined;",
																	"",
																	"    pm.expect(scaMethods[0]).to.have.property('authenticationType');",
																	"    pm.expect(scaMethods[0].authenticationType) !== undefined;",
																	"    ",
																	"    pm.expect(scaMethods[0]).to.have.property('authenticationMethodId');",
																	"    pm.expect(scaMethods[0].authenticationMethodId) !== undefined;",
																	"    ",
																	"    pm.globals.set(\"authenticationMethodId\", scaMethods[0].authenticationMethodId);",
																	"});",
																	"",
																	""
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "PUT",
														"header": [
															{
																"key": "Accept",
																"value": "application/json"
															},
															{
																"key": "Content-Type",
																"value": "application/json"
															},
															{
																"key": "PSU-ID",
																"value": "{{psu_id_multiple}}"
															},
															{
																"key": "X-Request-ID",
																"value": "{{x_request_id}}"
															}
														],
														"body": {
															"mode": "raw",
															"raw": "{\n\t\"psuData\": {\n\t\t\"password\": \"{{psu_id_password}}\"\n\t}\n}"
														},
														"url": {
															"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds/{{piis_consent_id}}/authorisations/{{piis_authorisation_id}}",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_xs2a}}"
															],
															"path": [
																"v2",
																"consents",
																"confirmation-of-funds",
																"{{piis_consent_id}}",
																"authorisations",
																"{{piis_authorisation_id}}"
															]
														},
														"description": "This method update PSU data on the consents  resource if needed.  It may authorise a consent within the Embedded SCA Approach where needed.  Independently from the SCA Approach it supports e.g. the selection of  the authentication method and a non-SCA PSU authentication.  This methods updates PSU data on the cancellation authorisation resource if needed.   There are several possible Update PSU Data requests in the context of a consent request if needed,  which depends on the SCA approach:  * Redirect SCA Approach:   A specific Update PSU Data Request is applicable for      * the selection of authentication methods, before choosing the actual SCA approach. * Decoupled SCA Approach:   A specific Update PSU Data Request is only applicable for   * adding the PSU Identification, if not provided yet in the Payment Initiation Request or the Account Information Consent Request, or if no OAuth2 access token is used, or   * the selection of authentication methods. * Embedded SCA Approach:    The Update PSU Data Request might be used    * to add credentials as a first factor authentication data of the PSU and   * to select the authentication method and   * transaction authorisation.  The SCA Approach might depend on the chosen SCA method.  For that reason, the following possible Update PSU Data request can apply to all SCA approaches:  * Select an SCA method in case of several SCA methods are available for the customer.  There are the following request types on this access path:   * Update PSU Identification   * Update PSU Authentication   * Select PSU Autorization Method      WARNING: This method need a reduced header,      therefore many optional elements are not present.      Maybe in a later version the access path will change.   * Transaction Authorisation     WARNING: This method need a reduced header,      therefore many optional elements are not present.      Maybe in a later version the access path will change. "
													},
													"response": []
												},
												{
													"name": "5. Update PSU Data for consent choose SCA method",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "287250a8-9a10-4ff2-bd31-e7e1c2e1b917",
																"exec": [
																	"pm.test('Status code is 200', () => {",
																	"   pm.response.to.have.status(200);",
																	"});",
																	"",
																	"const jsonData = pm.response.json();",
																	"",
																	"pm.test('Sca status is scaMethodSelected', () => {",
																	"   pm.expect(jsonData.scaStatus).to.eql('scaMethodSelected');",
																	"});",
																	"",
																	"pm.test(\"Select authoriseTransaction method link exists\", () => {",
																	"    pm.expect(jsonData).to.have.property('_links');",
																	"    const _links = jsonData._links;",
																	"    pm.expect(_links).to.have.property('authoriseTransaction');",
																	"});",
																	"",
																	"pm.test(\"Select chosenScaMethod exist\", () => {",
																	"    pm.expect(jsonData).to.have.property('chosenScaMethod');",
																	"    const chosenScaMethod = jsonData.chosenScaMethod;",
																	"    ",
																	"    pm.expect(chosenScaMethod).to.have.property('authenticationType');",
																	"    pm.expect(chosenScaMethod.authenticationType) !== undefined;",
																	"    ",
																	"    pm.expect(chosenScaMethod).to.have.property('authenticationMethodId');",
																	"    pm.expect(chosenScaMethod.authenticationMethodId) !== undefined;",
																	"});",
																	"",
																	"pm.test(\"Challenge data exist\", () => {",
																	"    pm.expect(jsonData).to.have.property('challengeData');",
																	"});",
																	""
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "PUT",
														"header": [
															{
																"key": "Accept",
																"value": "application/json"
															},
															{
																"key": "Content-Type",
																"value": "application/json"
															},
															{
																"key": "PSU-ID",
																"value": "{{psu_id_multiple}}"
															},
															{
																"key": "X-Request-ID",
																"value": "{{x_request_id}}"
															}
														],
														"body": {
															"mode": "raw",
															"raw": "{\n    \"authenticationMethodId\": \"{{authenticationMethodId}}\"        \n}"
														},
														"url": {
															"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds/{{piis_consent_id}}/authorisations/{{piis_authorisation_id}}",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_xs2a}}"
															],
															"path": [
																"v2",
																"consents",
																"confirmation-of-funds",
																"{{piis_consent_id}}",
																"authorisations",
																"{{piis_authorisation_id}}"
															]
														},
														"description": "This method update PSU data on the consents  resource if needed.  It may authorise a consent within the Embedded SCA Approach where needed.  Independently from the SCA Approach it supports e.g. the selection of  the authentication method and a non-SCA PSU authentication.  This methods updates PSU data on the cancellation authorisation resource if needed.   There are several possible Update PSU Data requests in the context of a consent request if needed,  which depends on the SCA approach:  * Redirect SCA Approach:   A specific Update PSU Data Request is applicable for      * the selection of authentication methods, before choosing the actual SCA approach. * Decoupled SCA Approach:   A specific Update PSU Data Request is only applicable for   * adding the PSU Identification, if not provided yet in the Payment Initiation Request or the Account Information Consent Request, or if no OAuth2 access token is used, or   * the selection of authentication methods. * Embedded SCA Approach:    The Update PSU Data Request might be used    * to add credentials as a first factor authentication data of the PSU and   * to select the authentication method and   * transaction authorisation.  The SCA Approach might depend on the chosen SCA method.  For that reason, the following possible Update PSU Data request can apply to all SCA approaches:  * Select an SCA method in case of several SCA methods are available for the customer.  There are the following request types on this access path:   * Update PSU Identification   * Update PSU Authentication   * Select PSU Autorization Method      WARNING: This method need a reduced header,      therefore many optional elements are not present.      Maybe in a later version the access path will change.   * Transaction Authorisation     WARNING: This method need a reduced header,      therefore many optional elements are not present.      Maybe in a later version the access path will change. "
													},
													"response": []
												},
												{
													"name": "6. Update PSU Data for consents finalization",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "0b05d305-bbfb-4e94-b9ea-2ce88cfa88e7",
																"exec": [
																	"pm.test('Status code is 200', () => {",
																	"   pm.response.to.have.status(200);",
																	"});",
																	"",
																	"const jsonData = pm.response.json();",
																	"",
																	"pm.test('Sca status is finalised', () => {",
																	"   pm.expect(jsonData.scaStatus).to.eql('finalised');",
																	"});",
																	"",
																	"pm.test(\"Select scaStatus link exists\", () => {",
																	"    pm.expect(jsonData).to.have.property('_links');",
																	"    const _links = jsonData._links;",
																	"    pm.expect(_links).to.have.property('scaStatus');",
																	"});"
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "PUT",
														"header": [
															{
																"key": "Accept",
																"value": "application/json"
															},
															{
																"key": "Content-Type",
																"value": "application/json"
															},
															{
																"key": "PSU-ID",
																"value": "{{psu_id_multiple}}"
															},
															{
																"key": "X-Request-ID",
																"value": "{{x_request_id}}"
															}
														],
														"body": {
															"mode": "raw",
															"raw": "{\n\t\"scaAuthenticationData\": \"{{tanNumber}}\"\n}"
														},
														"url": {
															"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds/{{piis_consent_id}}/authorisations/{{piis_authorisation_id}}",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_xs2a}}"
															],
															"path": [
																"v2",
																"consents",
																"confirmation-of-funds",
																"{{piis_consent_id}}",
																"authorisations",
																"{{piis_authorisation_id}}"
															]
														},
														"description": "This method update PSU data on the consents  resource if needed.  It may authorise a consent within the Embedded SCA Approach where needed.  Independently from the SCA Approach it supports e.g. the selection of  the authentication method and a non-SCA PSU authentication.  This methods updates PSU data on the cancellation authorisation resource if needed.   There are several possible Update PSU Data requests in the context of a consent request if needed,  which depends on the SCA approach:  * Redirect SCA Approach:   A specific Update PSU Data Request is applicable for      * the selection of authentication methods, before choosing the actual SCA approach. * Decoupled SCA Approach:   A specific Update PSU Data Request is only applicable for   * adding the PSU Identification, if not provided yet in the Payment Initiation Request or the Account Information Consent Request, or if no OAuth2 access token is used, or   * the selection of authentication methods. * Embedded SCA Approach:    The Update PSU Data Request might be used    * to add credentials as a first factor authentication data of the PSU and   * to select the authentication method and   * transaction authorisation.  The SCA Approach might depend on the chosen SCA method.  For that reason, the following possible Update PSU Data request can apply to all SCA approaches:  * Select an SCA method in case of several SCA methods are available for the customer.  There are the following request types on this access path:   * Update PSU Identification   * Update PSU Authentication   * Select PSU Autorization Method      WARNING: This method need a reduced header,      therefore many optional elements are not present.      Maybe in a later version the access path will change.   * Transaction Authorisation     WARNING: This method need a reduced header,      therefore many optional elements are not present.      Maybe in a later version the access path will change. "
													},
													"response": []
												},
												{
													"name": "7. Get PIIS consent status in XS2A valid",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "5a965b0d-a3ce-46b0-ad11-98bfc544226a",
																"exec": [
																	"pm.test(\"Status code is 200\", () => {",
																	"    pm.response.to.have.status(200);",
																	"});",
																	"",
																	"const jsonData = pm.response.json();",
																	"",
																	"pm.test(\"ConsentStatus is present\", () => {",
																	"   pm.expect(jsonData).to.have.property('consentStatus');",
																	"});",
																	"",
																	"pm.test(\"ConsentStatus is valid\", () => {",
																	"   pm.expect(jsonData.consentStatus).to.be.equal('valid');",
																	"});"
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"auth": {
															"type": "bearer",
															"bearer": [
																{
																	"key": "token",
																	"value": "{{ledgersBearerToken}}",
																	"type": "string"
																}
															]
														},
														"method": "GET",
														"header": [
															{
																"key": "X-Request-ID",
																"type": "text",
																"value": "{{x_request_id}}"
															}
														],
														"url": {
															"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds/{{piis_consent_id}}/status",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_xs2a}}"
															],
															"path": [
																"v2",
																"consents",
																"confirmation-of-funds",
																"{{piis_consent_id}}",
																"status"
															]
														}
													},
													"response": []
												}
											],
											"protocolProfileBehavior": {},
											"_postman_isSubFolder": true
										},
										{
											"name": "Explicit single sca",
											"item": [
												{
													"name": "1. Set embedded SCA approach",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "c9a2cd97-20d5-48cb-9f80-0453f629d691",
																"exec": [
																	"pm.test(\"Status code is 200\", () => {",
																	"    pm.response.to.have.status(200);",
																	"});",
																	""
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "PUT",
														"header": [
															{
																"key": "Content-Type",
																"name": "Content-Type",
																"type": "text",
																"value": "application/json"
															}
														],
														"body": {
															"mode": "raw",
															"raw": "[\n  \"EMBEDDED\",\n  \"REDIRECT\",\n  \"DECOUPLED\"\n]"
														},
														"url": {
															"raw": "{{protocol}}://{{url_aspsp_profile}}/api/v1/aspsp-profile/for-debug/sca-approaches",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_aspsp_profile}}"
															],
															"path": [
																"api",
																"v1",
																"aspsp-profile",
																"for-debug",
																"sca-approaches"
															]
														}
													},
													"response": []
												},
												{
													"name": "2. Enable PIIS consent support in ASPSP profile",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "bc7cb265-3624-40b7-9e22-17edb85905de",
																"exec": [
																	"pm.test(\"Status code is 200\", () => {",
																	"    pm.response.to.have.status(200);",
																	"});",
																	""
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "PUT",
														"header": [
															{
																"key": "Content-Type",
																"name": "Content-Type",
																"type": "text",
																"value": "application/json"
															}
														],
														"body": {
															"mode": "raw",
															"raw": "{\n    \"ais\": {\n        \"consentTypes\": {\n            \"bankOfferedConsentSupported\": false,\n            \"globalConsentSupported\": false,\n            \"availableAccountsConsentSupported\": true,\n            \"accountAccessFrequencyPerDay\": 4,\n            \"notConfirmedConsentExpirationTimeMs\": 86400000,\n            \"maxConsentValidityDays\": 0\n        },\n        \"redirectLinkToOnlineBanking\": {\n            \"aisRedirectUrlToAspsp\": \"http://localhost:4200/ais/{redirect-id}/{encrypted-consent-id}\"\n        },\n        \"transactionParameters\": {\n            \"availableBookingStatuses\": [\n                \"BOOKED\",\n                \"PENDING\"\n            ],\n            \"transactionsWithoutBalancesSupported\": false,\n            \"supportedTransactionApplicationTypes\": [\n            \t\"application/json\"\n            ]\n        },\n        \"deltaReportSettings\": {\n            \"entryReferenceFromSupported\": false,\n            \"deltaListSupported\": false\n        },\n        \"scaRequirementsForOneTimeConsents\": {\n            \"scaByOneTimeAvailableAccountsConsentRequired\": true,\n            \"scaByOneTimeGlobalConsentRequired\": true\n        }\n    },\n    \"pis\": {\n        \"supportedPaymentTypeAndProductMatrix\": {\n            \"payments\": [\n                \"sepa-credit-transfers\",\n                \"instant-sepa-credit-transfers\"\n            ]\n        },\n        \"maxTransactionValidityDays\": 0,\n        \"notConfirmedPaymentExpirationTimeMs\": 86400000,\n        \"paymentCancellationAuthorisationMandated\": false,\n        \"redirectLinkToOnlineBanking\": {\n            \"pisRedirectUrlToAspsp\": \"http://localhost:4200/pis/{redirect-id}/{encrypted-payment-id}\",\n            \"pisPaymentCancellationRedirectUrlToAspsp\": \"http://localhost:4200/pis/cancellation/{redirect-id}/{encrypted-payment-id}\",\n            \"paymentCancellationRedirectUrlExpirationTimeMs\": 600000\n        }\n    },\n    \"piis\": {\n        \"piisConsentSupported\": \"TPP_CONSENT_SUPPORTED\",\n                \"redirectLinkToOnlineBanking\": {\n            \"piisRedirectUrlToAspsp\": \"http://localhost:4200/piis/{redirect-id}/{encrypted-consent-id}\"\n        }\n    },\n    \"common\": {\n        \"scaRedirectFlow\": \"REDIRECT\",\n        \"startAuthorisationMode\": \"implicit\",\n        \"tppSignatureRequired\": false,\n        \"psuInInitialRequestMandated\": false,\n        \"redirectUrlExpirationTimeMs\": 600000,\n        \"authorisationExpirationTimeMs\": 86400000,\n        \"forceXs2aBaseLinksUrl\": false,\n        \"xs2aBaseLinksUrl\": \"http://myhost.com/\",\n        \"supportedAccountReferenceFields\": [\n            \"IBAN\"\n        ],\n        \"multicurrencyAccountLevelSupported\": \"SUBACCOUNT\",\n        \"aisPisSessionsSupported\": false,\n        \"signingBasketSupported\": true,\n        \"aspspNotificationsSupported\": [\n        \t\"NONE\"\t\n        ]\n    }\n}",
															"options": {
																"raw": {
																	"language": "json"
																}
															}
														},
														"url": {
															"raw": "{{protocol}}://{{url_aspsp_profile}}/api/v1/aspsp-profile/for-debug/aspsp-settings",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_aspsp_profile}}"
															],
															"path": [
																"api",
																"v1",
																"aspsp-profile",
																"for-debug",
																"aspsp-settings"
															]
														}
													},
													"response": []
												},
												{
													"name": "3. Create PIIS consent in XS2A with psu id",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "96680a6c-f5da-4eba-8e18-fbf31772d1e3",
																"exec": [
																	"pm.test(\"Status code is 201\", () => {",
																	"    pm.response.to.have.status(201);",
																	"});",
																	"",
																	"const jsonData = pm.response.json();",
																	"",
																	"pm.test(\"PIIS consent ID exists\", () => {",
																	"   pm.expect(jsonData).to.have.property('consentId');",
																	"});",
																	"",
																	"pm.test(\"PIIS consent links exists\", () => {",
																	"   pm.expect(jsonData._links).to.have.property('updatePsuAuthentication');",
																	"   pm.expect(jsonData._links).to.have.property('status');",
																	"   pm.expect(jsonData._links).to.have.property('scaStatus');",
																	"});",
																	"",
																	"pm.globals.set(\"piis_consent_id\", jsonData.consentId);",
																	"",
																	"pm.test(\"Update PSU authentication link exists\", () => {",
																	"    pm.expect(jsonData).to.have.property('_links');",
																	"    const _links = jsonData._links;",
																	"    ",
																	"    var updatePsuAuthentication = _links.updatePsuAuthentication.href;",
																	"",
																	"    if (updatePsuAuthentication === undefined) {",
																	"       pm.expect().fail();",
																	"    }",
																	"});",
																	"",
																	"pm.globals.set(\"updatePsuAuthentication\", jsonData._links.updatePsuAuthentication);",
																	"",
																	"const authorisationId = jsonData._links.updatePsuAuthentication.href.split('/').pop();",
																	"pm.globals.set(\"piis_authorisation_id\", authorisationId);"
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "POST",
														"header": [
															{
																"key": "PSU-ID",
																"value": "{{psu_id_single}}"
															},
															{
																"key": "Content-Type",
																"name": "Content-Type",
																"type": "text",
																"value": "application/json"
															},
															{
																"key": "X-Request-ID",
																"value": "{{x_request_id}}",
																"type": "text"
															},
															{
																"key": "TPP-Explicit-Authorisation-Preferred",
																"value": "true",
																"type": "text"
															}
														],
														"body": {
															"mode": "raw",
															"raw": "{\n  \"account\": {\n    \"iban\": \"{{iban_single}}\",\n    \"currency\": \"EUR\"\n  },\n  \"cardNumber\": \"cardNumber\",\n  \"cardExpiryDate\": \"2030-10-10\",\n  \"cardInformation\": \"cardInformation\",\n  \"registrationInformation\": \"registrationInformation\"\n\n}",
															"options": {
																"raw": {}
															}
														},
														"url": {
															"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_xs2a}}"
															],
															"path": [
																"v2",
																"consents",
																"confirmation-of-funds"
															]
														}
													},
													"response": []
												},
												{
													"name": "4. Start the authorisation process for a consent",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "461ca36b-ac2f-4989-9cfb-c67aa1a57b10",
																"exec": [
																	"pm.test(\"Status code is 201\", () => {",
																	"    pm.response.to.have.status(201);",
																	"});",
																	"",
																	"const jsonData = pm.response.json();",
																	"",
																	"pm.test(\"Sca status is psuIdentified\", () => {",
																	"    pm.expect(jsonData.scaStatus).to.eql('psuIdentified');",
																	"});",
																	"",
																	"pm.test(\"updatePsuAuthentication link exists\", () => {",
																	"    pm.expect(jsonData).to.have.property('_links');",
																	"    const _links = jsonData._links;",
																	"    ",
																	"    pm.expect(_links).to.have.property('updatePsuAuthentication');",
																	"});",
																	"",
																	"pm.globals.set(\"piis_authorisation_id\", jsonData.authorisationId);",
																	""
																],
																"type": "text/javascript"
															}
														},
														{
															"listen": "prerequest",
															"script": {
																"id": "bdd57ef3-22ce-4562-9c86-2190a52292da",
																"exec": [
																	""
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "POST",
														"header": [
															{
																"key": "Accept",
																"value": "application/json"
															},
															{
																"key": "Content-Type",
																"value": "application/json"
															},
															{
																"key": "PSU-ID",
																"value": "{{psu_id_single}}"
															},
															{
																"key": "X-Request-ID",
																"value": "{{x_request_id}}"
															}
														],
														"body": {
															"mode": "raw",
															"raw": ""
														},
														"url": {
															"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds/{{piis_consent_id}}/authorisations",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_xs2a}}"
															],
															"path": [
																"v2",
																"consents",
																"confirmation-of-funds",
																"{{piis_consent_id}}",
																"authorisations"
															]
														},
														"description": "Create an authorisation sub-resource and start the authorisation process of a consent.  The message might in addition transmit authentication and authorisation related data.  his method is iterated n times for a n times SCA authorisation in a  corporate context, each creating an own authorisation sub-endpoint for  the corresponding PSU authorising the consent.  The ASPSP might make the usage of this access method unnecessary,  since the related authorisation resource will be automatically created by  the ASPSP after the submission of the consent data with the first POST consents call.  The start authorisation process is a process which is needed for creating a new authorisation  or cancellation sub-resource.   This applies in the following scenarios:    * The ASPSP has indicated with an 'startAuthorisation' hyperlink in the preceding Payment      Initiation Response that an explicit start of the authorisation process is needed by the TPP.      The 'startAuthorisation' hyperlink can transport more information about data which needs to be      uploaded by using the extended forms.     * 'startAuthorisationWithPsuIdentfication',      * 'startAuthorisationWithPsuAuthentication'     * 'startAuthorisationWithAuthentciationMethodSelection'    * The related payment initiation cannot yet be executed since a multilevel SCA is mandated.   * The ASPSP has indicated with an 'startAuthorisation' hyperlink in the preceding      Payment Cancellation Response that an explicit start of the authorisation process is needed by the TPP.      The 'startAuthorisation' hyperlink can transport more information about data which needs to be uploaded      by using the extended forms as indicated above.   * The related payment cancellation request cannot be applied yet since a multilevel SCA is mandate for      executing the cancellation.   * The signing basket needs to be authorised yet. "
													},
													"response": []
												},
												{
													"name": "4. Update PSU Data for consent",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "174fb38d-3ea4-4414-a241-f4dd5ba0889d",
																"exec": [
																	"pm.test('Status code is 200', () => {",
																	"   pm.response.to.have.status(200);",
																	"});",
																	"",
																	"const jsonData = pm.response.json();",
																	"",
																	"pm.test('Sca status is scaMethodSelected', () => {",
																	"   pm.expect(jsonData.scaStatus).to.eql('scaMethodSelected');",
																	"});",
																	"",
																	"pm.test(\"authoriseTransaction method link exists\", () => {",
																	"    pm.expect(jsonData).to.have.property('_links');",
																	"    const _links = jsonData._links;",
																	"    pm.expect(_links).to.have.property('authoriseTransaction');",
																	"});",
																	"",
																	"",
																	""
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "PUT",
														"header": [
															{
																"key": "Accept",
																"value": "application/json"
															},
															{
																"key": "Content-Type",
																"value": "application/json"
															},
															{
																"key": "PSU-ID",
																"value": "{{psu_id_single}}"
															},
															{
																"key": "X-Request-ID",
																"value": "{{x_request_id}}"
															}
														],
														"body": {
															"mode": "raw",
															"raw": "{\n\t\"psuData\": {\n\t\t\"password\": \"{{psu_id_password}}\"\n\t}\n}"
														},
														"url": {
															"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds/{{piis_consent_id}}/authorisations/{{piis_authorisation_id}}",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_xs2a}}"
															],
															"path": [
																"v2",
																"consents",
																"confirmation-of-funds",
																"{{piis_consent_id}}",
																"authorisations",
																"{{piis_authorisation_id}}"
															]
														},
														"description": "This method update PSU data on the consents  resource if needed.  It may authorise a consent within the Embedded SCA Approach where needed.  Independently from the SCA Approach it supports e.g. the selection of  the authentication method and a non-SCA PSU authentication.  This methods updates PSU data on the cancellation authorisation resource if needed.   There are several possible Update PSU Data requests in the context of a consent request if needed,  which depends on the SCA approach:  * Redirect SCA Approach:   A specific Update PSU Data Request is applicable for      * the selection of authentication methods, before choosing the actual SCA approach. * Decoupled SCA Approach:   A specific Update PSU Data Request is only applicable for   * adding the PSU Identification, if not provided yet in the Payment Initiation Request or the Account Information Consent Request, or if no OAuth2 access token is used, or   * the selection of authentication methods. * Embedded SCA Approach:    The Update PSU Data Request might be used    * to add credentials as a first factor authentication data of the PSU and   * to select the authentication method and   * transaction authorisation.  The SCA Approach might depend on the chosen SCA method.  For that reason, the following possible Update PSU Data request can apply to all SCA approaches:  * Select an SCA method in case of several SCA methods are available for the customer.  There are the following request types on this access path:   * Update PSU Identification   * Update PSU Authentication   * Select PSU Autorization Method      WARNING: This method need a reduced header,      therefore many optional elements are not present.      Maybe in a later version the access path will change.   * Transaction Authorisation     WARNING: This method need a reduced header,      therefore many optional elements are not present.      Maybe in a later version the access path will change. "
													},
													"response": []
												},
												{
													"name": "5. Update PSU Data for consents finalization",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "b5b8646a-ccd8-434d-b9c0-c88a24195d7c",
																"exec": [
																	"pm.test('Status code is 200', () => {",
																	"   pm.response.to.have.status(200);",
																	"});",
																	"",
																	"const jsonData = pm.response.json();",
																	"",
																	"pm.test('Sca status is finalised', () => {",
																	"   pm.expect(jsonData.scaStatus).to.eql('finalised');",
																	"});",
																	"",
																	"pm.test(\"Select scaStatus link exists\", () => {",
																	"    pm.expect(jsonData).to.have.property('_links');",
																	"    const _links = jsonData._links;",
																	"    pm.expect(_links).to.have.property('scaStatus');",
																	"});"
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "PUT",
														"header": [
															{
																"key": "Accept",
																"value": "application/json"
															},
															{
																"key": "Content-Type",
																"value": "application/json"
															},
															{
																"key": "PSU-ID",
																"value": "{{psu_id_single}}"
															},
															{
																"key": "X-Request-ID",
																"value": "{{x_request_id}}"
															}
														],
														"body": {
															"mode": "raw",
															"raw": "{\n\t\"scaAuthenticationData\": \"{{tanNumber}}\"\n}"
														},
														"url": {
															"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds/{{piis_consent_id}}/authorisations/{{piis_authorisation_id}}",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_xs2a}}"
															],
															"path": [
																"v2",
																"consents",
																"confirmation-of-funds",
																"{{piis_consent_id}}",
																"authorisations",
																"{{piis_authorisation_id}}"
															]
														},
														"description": "This method update PSU data on the consents  resource if needed.  It may authorise a consent within the Embedded SCA Approach where needed.  Independently from the SCA Approach it supports e.g. the selection of  the authentication method and a non-SCA PSU authentication.  This methods updates PSU data on the cancellation authorisation resource if needed.   There are several possible Update PSU Data requests in the context of a consent request if needed,  which depends on the SCA approach:  * Redirect SCA Approach:   A specific Update PSU Data Request is applicable for      * the selection of authentication methods, before choosing the actual SCA approach. * Decoupled SCA Approach:   A specific Update PSU Data Request is only applicable for   * adding the PSU Identification, if not provided yet in the Payment Initiation Request or the Account Information Consent Request, or if no OAuth2 access token is used, or   * the selection of authentication methods. * Embedded SCA Approach:    The Update PSU Data Request might be used    * to add credentials as a first factor authentication data of the PSU and   * to select the authentication method and   * transaction authorisation.  The SCA Approach might depend on the chosen SCA method.  For that reason, the following possible Update PSU Data request can apply to all SCA approaches:  * Select an SCA method in case of several SCA methods are available for the customer.  There are the following request types on this access path:   * Update PSU Identification   * Update PSU Authentication   * Select PSU Autorization Method      WARNING: This method need a reduced header,      therefore many optional elements are not present.      Maybe in a later version the access path will change.   * Transaction Authorisation     WARNING: This method need a reduced header,      therefore many optional elements are not present.      Maybe in a later version the access path will change. "
													},
													"response": []
												},
												{
													"name": "7. Get PIIS consent status in XS2A valid",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "ca2bc99c-9b13-43d2-906b-aef813016885",
																"exec": [
																	"pm.test(\"Status code is 200\", () => {",
																	"    pm.response.to.have.status(200);",
																	"});",
																	"",
																	"const jsonData = pm.response.json();",
																	"",
																	"pm.test(\"ConsentStatus is present\", () => {",
																	"   pm.expect(jsonData).to.have.property('consentStatus');",
																	"});",
																	"",
																	"pm.test(\"ConsentStatus is valid\", () => {",
																	"   pm.expect(jsonData.consentStatus).to.be.equal('valid');",
																	"});"
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"auth": {
															"type": "bearer",
															"bearer": [
																{
																	"key": "token",
																	"value": "{{ledgersBearerToken}}",
																	"type": "string"
																}
															]
														},
														"method": "GET",
														"header": [
															{
																"key": "X-Request-ID",
																"type": "text",
																"value": "{{x_request_id}}"
															}
														],
														"url": {
															"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds/{{piis_consent_id}}/status",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_xs2a}}"
															],
															"path": [
																"v2",
																"consents",
																"confirmation-of-funds",
																"{{piis_consent_id}}",
																"status"
															]
														}
													},
													"response": []
												}
											],
											"protocolProfileBehavior": {},
											"_postman_isSubFolder": true
										},
										{
											"name": "Multilevel",
											"item": [
												{
													"name": "1. Set embedded SCA approach",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "631d7e3b-a6f8-4bd7-b73d-556326fb6223",
																"exec": [
																	"pm.test(\"Status code is 200\", () => {",
																	"    pm.response.to.have.status(200);",
																	"});",
																	""
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "PUT",
														"header": [
															{
																"key": "Content-Type",
																"name": "Content-Type",
																"type": "text",
																"value": "application/json"
															}
														],
														"body": {
															"mode": "raw",
															"raw": "[\n  \"EMBEDDED\",\n  \"REDIRECT\",\n  \"DECOUPLED\"\n]"
														},
														"url": {
															"raw": "{{protocol}}://{{url_aspsp_profile}}/api/v1/aspsp-profile/for-debug/sca-approaches",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_aspsp_profile}}"
															],
															"path": [
																"api",
																"v1",
																"aspsp-profile",
																"for-debug",
																"sca-approaches"
															]
														}
													},
													"response": []
												},
												{
													"name": "2. Enable PIIS consent support in ASPSP profile",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "5d4c94a5-6404-4571-ac1c-2d8803b98233",
																"exec": [
																	"pm.test(\"Status code is 200\", () => {",
																	"    pm.response.to.have.status(200);",
																	"});",
																	""
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "PUT",
														"header": [
															{
																"key": "Content-Type",
																"name": "Content-Type",
																"type": "text",
																"value": "application/json"
															}
														],
														"body": {
															"mode": "raw",
															"raw": "{\n    \"ais\": {\n        \"consentTypes\": {\n            \"bankOfferedConsentSupported\": false,\n            \"globalConsentSupported\": false,\n            \"availableAccountsConsentSupported\": true,\n            \"accountAccessFrequencyPerDay\": 4,\n            \"notConfirmedConsentExpirationTimeMs\": 86400000,\n            \"maxConsentValidityDays\": 0\n        },\n        \"redirectLinkToOnlineBanking\": {\n            \"aisRedirectUrlToAspsp\": \"http://localhost:4200/ais/{redirect-id}/{encrypted-consent-id}\"\n        },\n        \"transactionParameters\": {\n            \"availableBookingStatuses\": [\n                \"BOOKED\",\n                \"PENDING\"\n            ],\n            \"transactionsWithoutBalancesSupported\": false,\n            \"supportedTransactionApplicationTypes\": [\n            \t\"application/json\"\n            ]\n        },\n        \"deltaReportSettings\": {\n            \"entryReferenceFromSupported\": false,\n            \"deltaListSupported\": false\n        },\n        \"scaRequirementsForOneTimeConsents\": {\n            \"scaByOneTimeAvailableAccountsConsentRequired\": true,\n            \"scaByOneTimeGlobalConsentRequired\": true\n        }\n    },\n    \"pis\": {\n        \"supportedPaymentTypeAndProductMatrix\": {\n            \"payments\": [\n                \"sepa-credit-transfers\",\n                \"instant-sepa-credit-transfers\"\n            ]\n        },\n        \"maxTransactionValidityDays\": 0,\n        \"notConfirmedPaymentExpirationTimeMs\": 86400000,\n        \"paymentCancellationAuthorisationMandated\": false,\n        \"redirectLinkToOnlineBanking\": {\n            \"pisRedirectUrlToAspsp\": \"http://localhost:4200/pis/{redirect-id}/{encrypted-payment-id}\",\n            \"pisPaymentCancellationRedirectUrlToAspsp\": \"http://localhost:4200/pis/cancellation/{redirect-id}/{encrypted-payment-id}\",\n            \"paymentCancellationRedirectUrlExpirationTimeMs\": 600000\n        }\n    },\n    \"piis\": {\n        \"piisConsentSupported\": \"TPP_CONSENT_SUPPORTED\",\n                \"redirectLinkToOnlineBanking\": {\n            \"piisRedirectUrlToAspsp\": \"http://localhost:4200/piis/{redirect-id}/{encrypted-consent-id}\"\n        }\n    },\n    \"common\": {\n        \"scaRedirectFlow\": \"REDIRECT\",\n        \"startAuthorisationMode\": \"auto\",\n        \"tppSignatureRequired\": false,\n        \"psuInInitialRequestMandated\": false,\n        \"redirectUrlExpirationTimeMs\": 600000,\n        \"authorisationExpirationTimeMs\": 86400000,\n        \"forceXs2aBaseLinksUrl\": false,\n        \"xs2aBaseLinksUrl\": \"http://myhost.com/\",\n        \"supportedAccountReferenceFields\": [\n            \"IBAN\"\n        ],\n        \"multicurrencyAccountLevelSupported\": \"SUBACCOUNT\",\n        \"aisPisSessionsSupported\": false,\n        \"signingBasketSupported\": true,\n        \"aspspNotificationsSupported\": [\n        \t\"NONE\"\t\n        ]\n    }\n}",
															"options": {
																"raw": {
																	"language": "json"
																}
															}
														},
														"url": {
															"raw": "{{protocol}}://{{url_aspsp_profile}}/api/v1/aspsp-profile/for-debug/aspsp-settings",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_aspsp_profile}}"
															],
															"path": [
																"api",
																"v1",
																"aspsp-profile",
																"for-debug",
																"aspsp-settings"
															]
														}
													},
													"response": []
												},
												{
													"name": "3. Create PIIS consent in XS2A with psu id",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "950de09e-4715-4b16-86d5-3d2c7f76eafa",
																"exec": [
																	"pm.test(\"Status code is 201\", () => {",
																	"    pm.response.to.have.status(201);",
																	"});",
																	"",
																	"const jsonData = pm.response.json();",
																	"",
																	"pm.test(\"PIIS consent ID exists\", () => {",
																	"   pm.expect(jsonData).to.have.property('consentId');",
																	"});",
																	"",
																	"pm.test(\"PIIS consent links exists\", () => {",
																	"   pm.expect(jsonData._links).to.have.property('startAuthorisation');",
																	"   pm.expect(jsonData._links).to.have.property('status');",
																	"});",
																	"",
																	"pm.globals.set(\"piis_consent_id\", jsonData.consentId);",
																	"",
																	"pm.test(\"Update PSU authentication link exists\", () => {",
																	"    pm.expect(jsonData).to.have.property('_links');",
																	"    const _links = jsonData._links;",
																	"    ",
																	"    var updatePsuAuthentication = _links.startAuthorisation.href;",
																	"",
																	"    if (updatePsuAuthentication === undefined) {",
																	"       pm.expect().fail();",
																	"    }",
																	"});",
																	"",
																	"pm.globals.set(\"updatePsuAuthentication\", jsonData._links.updatePsuAuthentication);",
																	"",
																	"const authorisationId = jsonData._links.startAuthorisation.href.split('/').pop();",
																	"pm.globals.set(\"piis_authorisation_id\", authorisationId);"
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "POST",
														"header": [
															{
																"key": "PSU-ID",
																"value": "{{psu_id_multilevel_1}}"
															},
															{
																"key": "Content-Type",
																"name": "Content-Type",
																"type": "text",
																"value": "application/json"
															},
															{
																"key": "X-Request-ID",
																"value": "{{x_request_id}}",
																"type": "text"
															},
															{
																"key": "TPP-Explicit-Authorisation-Preferred",
																"value": "true",
																"type": "text"
															}
														],
														"body": {
															"mode": "raw",
															"raw": "{\n  \"account\": {\n    \"iban\": \"{{iban_multilevel}}\",\n    \"currency\": \"EUR\"\n  },\n  \"cardNumber\": \"cardNumber\",\n  \"cardExpiryDate\": \"2030-10-10\",\n  \"cardInformation\": \"cardInformation\",\n  \"registrationInformation\": \"registrationInformation\"\n\n}",
															"options": {
																"raw": {}
															}
														},
														"url": {
															"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_xs2a}}"
															],
															"path": [
																"v2",
																"consents",
																"confirmation-of-funds"
															]
														}
													},
													"response": []
												},
												{
													"name": "4. Start the authorisation process for a consent first user",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "d3e45ec8-6819-44d9-a12a-a0c294d793b1",
																"exec": [
																	"pm.test(\"Status code is 201\", () => {",
																	"    pm.response.to.have.status(201);",
																	"});",
																	"",
																	"const jsonData = pm.response.json();",
																	"",
																	"pm.test(\"Sca status is psuIdentified\", () => {",
																	"    pm.expect(jsonData.scaStatus).to.eql('psuIdentified');",
																	"});",
																	"",
																	"pm.test(\"updatePsuAuthentication link exists\", () => {",
																	"    pm.expect(jsonData).to.have.property('_links');",
																	"    const _links = jsonData._links;",
																	"    ",
																	"    pm.expect(_links).to.have.property('updatePsuAuthentication');",
																	"});",
																	"",
																	"pm.globals.set(\"piis_authorisation_id\", jsonData.authorisationId);",
																	""
																],
																"type": "text/javascript"
															}
														},
														{
															"listen": "prerequest",
															"script": {
																"id": "770bb8ad-f0e8-4ab9-a990-b11db2804838",
																"exec": [
																	""
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "POST",
														"header": [
															{
																"key": "Accept",
																"value": "application/json"
															},
															{
																"key": "Content-Type",
																"value": "application/json"
															},
															{
																"key": "PSU-ID",
																"value": "{{psu_id_multilevel_1}}"
															},
															{
																"key": "X-Request-ID",
																"value": "{{x_request_id}}"
															}
														],
														"body": {
															"mode": "raw",
															"raw": ""
														},
														"url": {
															"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds/{{piis_consent_id}}/authorisations",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_xs2a}}"
															],
															"path": [
																"v2",
																"consents",
																"confirmation-of-funds",
																"{{piis_consent_id}}",
																"authorisations"
															]
														},
														"description": "Create an authorisation sub-resource and start the authorisation process of a consent.  The message might in addition transmit authentication and authorisation related data.  his method is iterated n times for a n times SCA authorisation in a  corporate context, each creating an own authorisation sub-endpoint for  the corresponding PSU authorising the consent.  The ASPSP might make the usage of this access method unnecessary,  since the related authorisation resource will be automatically created by  the ASPSP after the submission of the consent data with the first POST consents call.  The start authorisation process is a process which is needed for creating a new authorisation  or cancellation sub-resource.   This applies in the following scenarios:    * The ASPSP has indicated with an 'startAuthorisation' hyperlink in the preceding Payment      Initiation Response that an explicit start of the authorisation process is needed by the TPP.      The 'startAuthorisation' hyperlink can transport more information about data which needs to be      uploaded by using the extended forms.     * 'startAuthorisationWithPsuIdentfication',      * 'startAuthorisationWithPsuAuthentication'     * 'startAuthorisationWithAuthentciationMethodSelection'    * The related payment initiation cannot yet be executed since a multilevel SCA is mandated.   * The ASPSP has indicated with an 'startAuthorisation' hyperlink in the preceding      Payment Cancellation Response that an explicit start of the authorisation process is needed by the TPP.      The 'startAuthorisation' hyperlink can transport more information about data which needs to be uploaded      by using the extended forms as indicated above.   * The related payment cancellation request cannot be applied yet since a multilevel SCA is mandate for      executing the cancellation.   * The signing basket needs to be authorised yet. "
													},
													"response": []
												},
												{
													"name": "5. Update PSU Data for consent first user",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "f83d6500-6639-4fc0-88bf-3558cd9c92f3",
																"exec": [
																	"pm.test('Status code is 200', () => {",
																	"   pm.response.to.have.status(200);",
																	"});",
																	"",
																	"const jsonData = pm.response.json();",
																	"",
																	"pm.test('Sca status is scaMethodSelected', () => {",
																	"   pm.expect(jsonData.scaStatus).to.eql('scaMethodSelected');",
																	"});",
																	"",
																	"pm.test(\"authoriseTransaction method link exists\", () => {",
																	"    pm.expect(jsonData).to.have.property('_links');",
																	"    const _links = jsonData._links;",
																	"    pm.expect(_links).to.have.property('authoriseTransaction');",
																	"});",
																	"",
																	"",
																	""
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "PUT",
														"header": [
															{
																"key": "Accept",
																"value": "application/json"
															},
															{
																"key": "Content-Type",
																"value": "application/json"
															},
															{
																"key": "PSU-ID",
																"value": "{{psu_id_multilevel_1}}"
															},
															{
																"key": "X-Request-ID",
																"value": "{{x_request_id}}"
															}
														],
														"body": {
															"mode": "raw",
															"raw": "{\n\t\"psuData\": {\n\t\t\"password\": \"{{psu_id_password}}\"\n\t}\n}"
														},
														"url": {
															"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds/{{piis_consent_id}}/authorisations/{{piis_authorisation_id}}",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_xs2a}}"
															],
															"path": [
																"v2",
																"consents",
																"confirmation-of-funds",
																"{{piis_consent_id}}",
																"authorisations",
																"{{piis_authorisation_id}}"
															]
														},
														"description": "This method update PSU data on the consents  resource if needed.  It may authorise a consent within the Embedded SCA Approach where needed.  Independently from the SCA Approach it supports e.g. the selection of  the authentication method and a non-SCA PSU authentication.  This methods updates PSU data on the cancellation authorisation resource if needed.   There are several possible Update PSU Data requests in the context of a consent request if needed,  which depends on the SCA approach:  * Redirect SCA Approach:   A specific Update PSU Data Request is applicable for      * the selection of authentication methods, before choosing the actual SCA approach. * Decoupled SCA Approach:   A specific Update PSU Data Request is only applicable for   * adding the PSU Identification, if not provided yet in the Payment Initiation Request or the Account Information Consent Request, or if no OAuth2 access token is used, or   * the selection of authentication methods. * Embedded SCA Approach:    The Update PSU Data Request might be used    * to add credentials as a first factor authentication data of the PSU and   * to select the authentication method and   * transaction authorisation.  The SCA Approach might depend on the chosen SCA method.  For that reason, the following possible Update PSU Data request can apply to all SCA approaches:  * Select an SCA method in case of several SCA methods are available for the customer.  There are the following request types on this access path:   * Update PSU Identification   * Update PSU Authentication   * Select PSU Autorization Method      WARNING: This method need a reduced header,      therefore many optional elements are not present.      Maybe in a later version the access path will change.   * Transaction Authorisation     WARNING: This method need a reduced header,      therefore many optional elements are not present.      Maybe in a later version the access path will change. "
													},
													"response": []
												},
												{
													"name": "6. Update PSU Data for consents finalization first user",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "8a4b7543-1408-4bea-9182-3ab197c2afdb",
																"exec": [
																	"pm.test('Status code is 200', () => {",
																	"   pm.response.to.have.status(200);",
																	"});",
																	"",
																	"const jsonData = pm.response.json();",
																	"",
																	"pm.test('Sca status is finalised', () => {",
																	"   pm.expect(jsonData.scaStatus).to.eql('finalised');",
																	"});",
																	"",
																	"pm.test(\"Select scaStatus link exists\", () => {",
																	"    pm.expect(jsonData).to.have.property('_links');",
																	"    const _links = jsonData._links;",
																	"    pm.expect(_links).to.have.property('scaStatus');",
																	"});"
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "PUT",
														"header": [
															{
																"key": "Accept",
																"value": "application/json"
															},
															{
																"key": "Content-Type",
																"value": "application/json"
															},
															{
																"key": "PSU-ID",
																"value": "{{psu_id_multilevel_1}}"
															},
															{
																"key": "X-Request-ID",
																"value": "{{x_request_id}}"
															}
														],
														"body": {
															"mode": "raw",
															"raw": "{\n\t\"scaAuthenticationData\": \"{{tanNumber}}\"\n}"
														},
														"url": {
															"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds/{{piis_consent_id}}/authorisations/{{piis_authorisation_id}}",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_xs2a}}"
															],
															"path": [
																"v2",
																"consents",
																"confirmation-of-funds",
																"{{piis_consent_id}}",
																"authorisations",
																"{{piis_authorisation_id}}"
															]
														},
														"description": "This method update PSU data on the consents  resource if needed.  It may authorise a consent within the Embedded SCA Approach where needed.  Independently from the SCA Approach it supports e.g. the selection of  the authentication method and a non-SCA PSU authentication.  This methods updates PSU data on the cancellation authorisation resource if needed.   There are several possible Update PSU Data requests in the context of a consent request if needed,  which depends on the SCA approach:  * Redirect SCA Approach:   A specific Update PSU Data Request is applicable for      * the selection of authentication methods, before choosing the actual SCA approach. * Decoupled SCA Approach:   A specific Update PSU Data Request is only applicable for   * adding the PSU Identification, if not provided yet in the Payment Initiation Request or the Account Information Consent Request, or if no OAuth2 access token is used, or   * the selection of authentication methods. * Embedded SCA Approach:    The Update PSU Data Request might be used    * to add credentials as a first factor authentication data of the PSU and   * to select the authentication method and   * transaction authorisation.  The SCA Approach might depend on the chosen SCA method.  For that reason, the following possible Update PSU Data request can apply to all SCA approaches:  * Select an SCA method in case of several SCA methods are available for the customer.  There are the following request types on this access path:   * Update PSU Identification   * Update PSU Authentication   * Select PSU Autorization Method      WARNING: This method need a reduced header,      therefore many optional elements are not present.      Maybe in a later version the access path will change.   * Transaction Authorisation     WARNING: This method need a reduced header,      therefore many optional elements are not present.      Maybe in a later version the access path will change. "
													},
													"response": []
												},
												{
													"name": "7. Get PIIS consent status in XS2A partiallyAuthorised",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "590a677e-5f3c-49b5-ad16-d6710334c4a9",
																"exec": [
																	"pm.test(\"Status code is 200\", () => {",
																	"    pm.response.to.have.status(200);",
																	"});",
																	"",
																	"const jsonData = pm.response.json();",
																	"",
																	"pm.test(\"ConsentStatus is present\", () => {",
																	"   pm.expect(jsonData).to.have.property('consentStatus');",
																	"});",
																	"",
																	"pm.test(\"ConsentStatus is partiallyAuthorised\", () => {",
																	"   pm.expect(jsonData.consentStatus).to.be.equal('partiallyAuthorised');",
																	"});"
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"auth": {
															"type": "bearer",
															"bearer": [
																{
																	"key": "token",
																	"value": "{{ledgersBearerToken}}",
																	"type": "string"
																}
															]
														},
														"method": "GET",
														"header": [
															{
																"key": "X-Request-ID",
																"type": "text",
																"value": "{{x_request_id}}"
															}
														],
														"url": {
															"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds/{{piis_consent_id}}/status",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_xs2a}}"
															],
															"path": [
																"v2",
																"consents",
																"confirmation-of-funds",
																"{{piis_consent_id}}",
																"status"
															]
														}
													},
													"response": []
												},
												{
													"name": "8. Start the authorisation process for a consent second user",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "59d8d1d0-18ec-4e9b-97f0-c803397fdffb",
																"exec": [
																	"pm.test(\"Status code is 201\", () => {",
																	"    pm.response.to.have.status(201);",
																	"});",
																	"",
																	"const jsonData = pm.response.json();",
																	"",
																	"pm.test(\"Sca status is psuIdentified\", () => {",
																	"    pm.expect(jsonData.scaStatus).to.eql('psuIdentified');",
																	"});",
																	"",
																	"pm.test(\"updatePsuAuthentication link exists\", () => {",
																	"    pm.expect(jsonData).to.have.property('_links');",
																	"    const _links = jsonData._links;",
																	"    ",
																	"    pm.expect(_links).to.have.property('updatePsuAuthentication');",
																	"});",
																	"",
																	"pm.globals.set(\"piis_authorisation_id\", jsonData.authorisationId);",
																	""
																],
																"type": "text/javascript"
															}
														},
														{
															"listen": "prerequest",
															"script": {
																"id": "3ca64bda-adc5-431e-a557-073f5327b49a",
																"exec": [
																	""
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "POST",
														"header": [
															{
																"key": "Accept",
																"value": "application/json"
															},
															{
																"key": "Content-Type",
																"value": "application/json"
															},
															{
																"key": "PSU-ID",
																"value": "{{psu_id_multilevel_2}}"
															},
															{
																"key": "X-Request-ID",
																"value": "{{x_request_id}}"
															}
														],
														"body": {
															"mode": "raw",
															"raw": ""
														},
														"url": {
															"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds/{{piis_consent_id}}/authorisations",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_xs2a}}"
															],
															"path": [
																"v2",
																"consents",
																"confirmation-of-funds",
																"{{piis_consent_id}}",
																"authorisations"
															]
														},
														"description": "Create an authorisation sub-resource and start the authorisation process of a consent.  The message might in addition transmit authentication and authorisation related data.  his method is iterated n times for a n times SCA authorisation in a  corporate context, each creating an own authorisation sub-endpoint for  the corresponding PSU authorising the consent.  The ASPSP might make the usage of this access method unnecessary,  since the related authorisation resource will be automatically created by  the ASPSP after the submission of the consent data with the first POST consents call.  The start authorisation process is a process which is needed for creating a new authorisation  or cancellation sub-resource.   This applies in the following scenarios:    * The ASPSP has indicated with an 'startAuthorisation' hyperlink in the preceding Payment      Initiation Response that an explicit start of the authorisation process is needed by the TPP.      The 'startAuthorisation' hyperlink can transport more information about data which needs to be      uploaded by using the extended forms.     * 'startAuthorisationWithPsuIdentfication',      * 'startAuthorisationWithPsuAuthentication'     * 'startAuthorisationWithAuthentciationMethodSelection'    * The related payment initiation cannot yet be executed since a multilevel SCA is mandated.   * The ASPSP has indicated with an 'startAuthorisation' hyperlink in the preceding      Payment Cancellation Response that an explicit start of the authorisation process is needed by the TPP.      The 'startAuthorisation' hyperlink can transport more information about data which needs to be uploaded      by using the extended forms as indicated above.   * The related payment cancellation request cannot be applied yet since a multilevel SCA is mandate for      executing the cancellation.   * The signing basket needs to be authorised yet. "
													},
													"response": []
												},
												{
													"name": "9. Update PSU Data for consent second user",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "c64f2979-44f4-42fb-b143-d958157a6bb4",
																"exec": [
																	"pm.test('Status code is 200', () => {",
																	"   pm.response.to.have.status(200);",
																	"});",
																	"",
																	"const jsonData = pm.response.json();",
																	"",
																	"pm.test('Sca status is scaMethodSelected', () => {",
																	"   pm.expect(jsonData.scaStatus).to.eql('scaMethodSelected');",
																	"});",
																	"",
																	"pm.test(\"authoriseTransaction method link exists\", () => {",
																	"    pm.expect(jsonData).to.have.property('_links');",
																	"    const _links = jsonData._links;",
																	"    pm.expect(_links).to.have.property('authoriseTransaction');",
																	"});",
																	"",
																	"",
																	""
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "PUT",
														"header": [
															{
																"key": "Accept",
																"value": "application/json"
															},
															{
																"key": "Content-Type",
																"value": "application/json"
															},
															{
																"key": "PSU-ID",
																"value": "{{psu_id_multilevel_2}}"
															},
															{
																"key": "X-Request-ID",
																"value": "{{x_request_id}}"
															}
														],
														"body": {
															"mode": "raw",
															"raw": "{\n\t\"psuData\": {\n\t\t\"password\": \"{{psu_id_password}}\"\n\t}\n}"
														},
														"url": {
															"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds/{{piis_consent_id}}/authorisations/{{piis_authorisation_id}}",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_xs2a}}"
															],
															"path": [
																"v2",
																"consents",
																"confirmation-of-funds",
																"{{piis_consent_id}}",
																"authorisations",
																"{{piis_authorisation_id}}"
															]
														},
														"description": "This method update PSU data on the consents  resource if needed.  It may authorise a consent within the Embedded SCA Approach where needed.  Independently from the SCA Approach it supports e.g. the selection of  the authentication method and a non-SCA PSU authentication.  This methods updates PSU data on the cancellation authorisation resource if needed.   There are several possible Update PSU Data requests in the context of a consent request if needed,  which depends on the SCA approach:  * Redirect SCA Approach:   A specific Update PSU Data Request is applicable for      * the selection of authentication methods, before choosing the actual SCA approach. * Decoupled SCA Approach:   A specific Update PSU Data Request is only applicable for   * adding the PSU Identification, if not provided yet in the Payment Initiation Request or the Account Information Consent Request, or if no OAuth2 access token is used, or   * the selection of authentication methods. * Embedded SCA Approach:    The Update PSU Data Request might be used    * to add credentials as a first factor authentication data of the PSU and   * to select the authentication method and   * transaction authorisation.  The SCA Approach might depend on the chosen SCA method.  For that reason, the following possible Update PSU Data request can apply to all SCA approaches:  * Select an SCA method in case of several SCA methods are available for the customer.  There are the following request types on this access path:   * Update PSU Identification   * Update PSU Authentication   * Select PSU Autorization Method      WARNING: This method need a reduced header,      therefore many optional elements are not present.      Maybe in a later version the access path will change.   * Transaction Authorisation     WARNING: This method need a reduced header,      therefore many optional elements are not present.      Maybe in a later version the access path will change. "
													},
													"response": []
												},
												{
													"name": "10. Update PSU Data for consents finalization second user",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "56f4f209-0f9a-454f-b060-f917fe27c389",
																"exec": [
																	"pm.test('Status code is 200', () => {",
																	"   pm.response.to.have.status(200);",
																	"});",
																	"",
																	"const jsonData = pm.response.json();",
																	"",
																	"pm.test('Sca status is finalised', () => {",
																	"   pm.expect(jsonData.scaStatus).to.eql('finalised');",
																	"});",
																	"",
																	"pm.test(\"Select scaStatus link exists\", () => {",
																	"    pm.expect(jsonData).to.have.property('_links');",
																	"    const _links = jsonData._links;",
																	"    pm.expect(_links).to.have.property('scaStatus');",
																	"});"
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"method": "PUT",
														"header": [
															{
																"key": "Accept",
																"value": "application/json"
															},
															{
																"key": "Content-Type",
																"value": "application/json"
															},
															{
																"key": "PSU-ID",
																"value": "{{psu_id_multilevel_2}}"
															},
															{
																"key": "X-Request-ID",
																"value": "{{x_request_id}}"
															}
														],
														"body": {
															"mode": "raw",
															"raw": "{\n\t\"scaAuthenticationData\": \"{{tanNumber}}\"\n}"
														},
														"url": {
															"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds/{{piis_consent_id}}/authorisations/{{piis_authorisation_id}}",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_xs2a}}"
															],
															"path": [
																"v2",
																"consents",
																"confirmation-of-funds",
																"{{piis_consent_id}}",
																"authorisations",
																"{{piis_authorisation_id}}"
															]
														},
														"description": "This method update PSU data on the consents  resource if needed.  It may authorise a consent within the Embedded SCA Approach where needed.  Independently from the SCA Approach it supports e.g. the selection of  the authentication method and a non-SCA PSU authentication.  This methods updates PSU data on the cancellation authorisation resource if needed.   There are several possible Update PSU Data requests in the context of a consent request if needed,  which depends on the SCA approach:  * Redirect SCA Approach:   A specific Update PSU Data Request is applicable for      * the selection of authentication methods, before choosing the actual SCA approach. * Decoupled SCA Approach:   A specific Update PSU Data Request is only applicable for   * adding the PSU Identification, if not provided yet in the Payment Initiation Request or the Account Information Consent Request, or if no OAuth2 access token is used, or   * the selection of authentication methods. * Embedded SCA Approach:    The Update PSU Data Request might be used    * to add credentials as a first factor authentication data of the PSU and   * to select the authentication method and   * transaction authorisation.  The SCA Approach might depend on the chosen SCA method.  For that reason, the following possible Update PSU Data request can apply to all SCA approaches:  * Select an SCA method in case of several SCA methods are available for the customer.  There are the following request types on this access path:   * Update PSU Identification   * Update PSU Authentication   * Select PSU Autorization Method      WARNING: This method need a reduced header,      therefore many optional elements are not present.      Maybe in a later version the access path will change.   * Transaction Authorisation     WARNING: This method need a reduced header,      therefore many optional elements are not present.      Maybe in a later version the access path will change. "
													},
													"response": []
												},
												{
													"name": "11. Get PIIS consent status in XS2A valid",
													"event": [
														{
															"listen": "test",
															"script": {
																"id": "ab1c8703-ab83-4a23-8cd3-48cfbcb4f0d4",
																"exec": [
																	"pm.test(\"Status code is 200\", () => {",
																	"    pm.response.to.have.status(200);",
																	"});",
																	"",
																	"const jsonData = pm.response.json();",
																	"",
																	"pm.test(\"ConsentStatus is present\", () => {",
																	"   pm.expect(jsonData).to.have.property('consentStatus');",
																	"});",
																	"",
																	"pm.test(\"ConsentStatus is valid\", () => {",
																	"   pm.expect(jsonData.consentStatus).to.be.equal('valid');",
																	"});"
																],
																"type": "text/javascript"
															}
														}
													],
													"request": {
														"auth": {
															"type": "bearer",
															"bearer": [
																{
																	"key": "token",
																	"value": "{{ledgersBearerToken}}",
																	"type": "string"
																}
															]
														},
														"method": "GET",
														"header": [
															{
																"key": "X-Request-ID",
																"type": "text",
																"value": "{{x_request_id}}"
															}
														],
														"url": {
															"raw": "{{protocol}}://{{url_xs2a}}/v2/consents/confirmation-of-funds/{{piis_consent_id}}/status",
															"protocol": "{{protocol}}",
															"host": [
																"{{url_xs2a}}"
															],
															"path": [
																"v2",
																"consents",
																"confirmation-of-funds",
																"{{piis_consent_id}}",
																"status"
															]
														}
													},
													"response": []
												}
											],
											"protocolProfileBehavior": {},
											"_postman_isSubFolder": true
										}
									],
									"protocolProfileBehavior": {},
									"_postman_isSubFolder": true
								}
							],
							"protocolProfileBehavior": {},
							"_postman_isSubFolder": true
						}
					],
					"protocolProfileBehavior": {},
					"_postman_isSubFolder": true
				}
			],
			"protocolProfileBehavior": {}
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"id": "7259e510-f71a-4e22-b396-cc3179e13b2d",
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"id": "8db94e83-9a56-49b8-96d2-ba491a52b517",
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		}
	],
	"protocolProfileBehavior": {}
}